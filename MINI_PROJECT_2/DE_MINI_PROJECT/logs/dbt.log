[0m10:40:38.051119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E3D69F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E6F6A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E721C860>]}


============================== 10:40:38.057084 | 78a55125-d674-4d6a-a559-cd09075bf362 ==============================
[0m10:40:38.057084 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:40:38.058089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:38.088500 [info ] [MainThread]: dbt version: 1.9.2
[0m10:40:38.089461 [info ] [MainThread]: python version: 3.12.9
[0m10:40:38.090461 [info ] [MainThread]: python path: C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\python.exe
[0m10:40:38.091463 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:40:39.317345 [info ] [MainThread]: Using profiles dir at C:\Users\BurelaSuryaPrathap\.dbt
[0m10:40:39.319352 [info ] [MainThread]: Using profiles.yml file at C:\Users\BurelaSuryaPrathap\.dbt\profiles.yml
[0m10:40:39.319352 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\dbt_project.yml
[0m10:40:39.321358 [info ] [MainThread]: adapter type: snowflake
[0m10:40:39.321358 [info ] [MainThread]: adapter version: 1.9.1
[0m10:40:39.459227 [info ] [MainThread]: Configuration:
[0m10:40:39.459227 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:40:39.459227 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:40:39.459227 [info ] [MainThread]: Required dependencies:
[0m10:40:39.459227 [debug] [MainThread]: Executing "git --help"
[0m10:40:39.529332 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:40:39.529332 [debug] [MainThread]: STDERR: "b''"
[0m10:40:39.532730 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:40:39.532730 [info ] [MainThread]: Connection:
[0m10:40:39.532730 [info ] [MainThread]:   account: CDTPLUA-IY88330
[0m10:40:39.532730 [info ] [MainThread]:   user: BURELASURYAPRATHAP
[0m10:40:39.532730 [info ] [MainThread]:   database: DE_MINI_PROJECT
[0m10:40:39.532730 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:40:39.536524 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:40:39.536524 [info ] [MainThread]:   schema: RAW
[0m10:40:39.536524 [info ] [MainThread]:   authenticator: None
[0m10:40:39.540353 [info ] [MainThread]:   oauth_client_id: None
[0m10:40:39.540353 [info ] [MainThread]:   query_tag: None
[0m10:40:39.541350 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:40:39.542351 [info ] [MainThread]:   host: None
[0m10:40:39.543351 [info ] [MainThread]:   port: None
[0m10:40:39.543865 [info ] [MainThread]:   proxy_host: None
[0m10:40:39.543865 [info ] [MainThread]:   proxy_port: None
[0m10:40:39.545884 [info ] [MainThread]:   protocol: None
[0m10:40:39.546874 [info ] [MainThread]:   connect_retries: 1
[0m10:40:39.546874 [info ] [MainThread]:   connect_timeout: None
[0m10:40:39.547875 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:40:39.548872 [info ] [MainThread]:   retry_all: False
[0m10:40:39.548872 [info ] [MainThread]:   insecure_mode: False
[0m10:40:39.549874 [info ] [MainThread]:   reuse_connections: True
[0m10:40:39.550872 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:40:40.161084 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:40:40.300896 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:40:40.300896 [debug] [MainThread]: On debug: select 1 as id
[0m10:40:40.300896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:42.369778 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.080 seconds
[0m10:40:42.369778 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:40:42.369778 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:40:42.385505 [debug] [MainThread]: Command `dbt debug` succeeded at 10:40:42.369778 after 4.54 seconds
[0m10:40:42.385505 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:40:42.385505 [debug] [MainThread]: On debug: Close
[0m10:40:42.709208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3E41F0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F3B9E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3F3897F80>]}
[0m10:40:42.709208 [debug] [MainThread]: Flushing usage events
[0m10:40:43.599217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:05.759299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35B7104D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35CB2F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35B760DD0>]}


============================== 10:49:05.924265 | 528d08b7-9e6d-4760-a2bd-235781ff76a4 ==============================
[0m10:49:05.924265 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:49:06.001757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m10:49:15.955370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B83D9A0>]}
[0m10:49:16.042130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36B8EED80>]}
[0m10:49:16.044139 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:49:16.726415 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:49:16.726415 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:49:16.726415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EDA5A60>]}
[0m10:49:22.283274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36BA5EE10>]}
[0m10:49:22.368553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:49:22.406408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:49:23.211609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36CFE1EB0>]}
[0m10:49:23.212611 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:49:23.214390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36BD2C470>]}
[0m10:49:23.253193 [info ] [MainThread]: 
[0m10:49:23.253193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:23.253193 [info ] [MainThread]: 
[0m10:49:23.260043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:23.275603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m10:49:24.425574 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m10:49:24.425574 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m10:49:24.425574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:29.719804 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafedf-3201-7e56-000c-3d5a000230c6
[0m10:49:29.751708 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:49:29.751708 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:49:29.753721 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:49:29.753721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '528d08b7-9e6d-4760-a2bd-235781ff76a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36CFE38F0>]}
[0m10:49:29.849476 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m10:49:29.849476 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m10:49:29.859524 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m10:49:29.871322 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:49:29.897112 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m10:49:29.906630 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m10:49:29.906630 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m10:49:29.906630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m10:49:29.908639 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m10:49:29.910648 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m10:49:29.912656 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m10:49:29.914928 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m10:49:29.914928 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m10:49:29.914928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m10:49:29.914928 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m10:49:29.918945 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:49:29.975891 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m10:49:29.977653 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m10:49:29.979670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:29.979670 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m10:49:29.979670 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m10:49:30.318432 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was properly closed.
[0m10:49:30.322430 [debug] [MainThread]: Command end result
[0m10:49:30.357861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:49:30.360873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:49:30.368906 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m10:49:30.370906 [debug] [MainThread]: Command `dbt compile` succeeded at 10:49:30.369871 after 24.94 seconds
[0m10:49:30.370906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36BDDFBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EC90D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E35EC91490>]}
[0m10:49:30.371906 [debug] [MainThread]: Flushing usage events
[0m10:49:31.820195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:05.349451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C986CB830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9894F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C97F1FFE0>]}


============================== 10:50:05.397252 | 50457ad1-93a7-4e14-940e-53506e5812ea ==============================
[0m10:50:05.397252 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:50:05.398462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:50:19.103435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9865F140>]}
[0m10:50:19.166869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9894E9F0>]}
[0m10:50:19.183667 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:50:20.741616 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:50:25.742966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:50:25.742966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:50:25.778232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA590B710>]}
[0m10:50:25.878506 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:50:25.968453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:50:27.126123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA5C670B0>]}
[0m10:50:27.126123 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:50:27.131676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA590BF80>]}
[0m10:50:27.135641 [info ] [MainThread]: 
[0m10:50:27.135641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:50:27.135641 [info ] [MainThread]: 
[0m10:50:27.138138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:50:27.143971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m10:50:27.280677 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m10:50:27.280677 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m10:50:27.280677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:33.147858 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 5.869 seconds
[0m10:50:33.163901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT, now create_DE_MINI_PROJECT_staging)
[0m10:50:33.244543 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT"
schema: "staging"
"
[0m10:50:33.260376 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_staging"
[0m10:50:33.292553 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_staging"} */
create schema if not exists DE_MINI_PROJECT.staging
[0m10:50:33.485355 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.199 seconds
[0m10:50:33.503030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m10:50:33.516527 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m10:50:33.540487 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m10:50:33.540487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:34.513550 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.973 seconds
[0m10:50:34.519116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA5787B00>]}
[0m10:50:34.635471 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m10:50:34.635471 [info ] [Thread-1 (]: 1 of 3 START sql table model staging.stg_customers ............................. [RUN]
[0m10:50:34.675420 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m10:50:34.675420 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m10:50:34.704512 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:50:34.704512 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m10:50:34.771463 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:50:34.771463 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m10:50:34.819511 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH cutomers_cleaning AS (
    
SELECT 
    DISTINCT
    *
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMER_NAME IS NOT NULL
)
SELECT * FROM cutomers_cleaning
        );
[0m10:50:34.819511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:50:36.932166 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee0-3201-7e56-000c-3d5a000230ce
[0m10:50:36.933540 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 8
invalid identifier 'CUSTOMER_NAME'
[0m10:50:37.013779 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql
[0m10:50:37.016786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA5856BD0>]}
[0m10:50:37.051818 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model staging.stg_customers .................... [[31mERROR[0m in 2.34s]
[0m10:50:37.054018 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m10:50:37.071565 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m10:50:37.073041 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql.
[0m10:50:37.091889 [info ] [Thread-1 (]: 2 of 3 START sql table model staging.stg_products .............................. [RUN]
[0m10:50:37.131471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m10:50:37.131471 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m10:50:37.156971 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m10:50:37.158969 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m10:50:37.180815 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m10:50:37.181815 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m10:50:37.207603 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT *
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m10:50:38.317496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.107 seconds
[0m10:50:38.344626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA73F06E0>]}
[0m10:50:38.388020 [info ] [Thread-1 (]: 2 of 3 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 1.21s]
[0m10:50:38.388970 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m10:50:38.390102 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m10:50:38.390610 [info ] [Thread-1 (]: 3 of 3 START sql table model staging.stg_transactions .......................... [RUN]
[0m10:50:38.391160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m10:50:38.417342 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m10:50:38.421349 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:50:38.443859 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m10:50:38.458270 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:50:38.490610 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m10:50:38.492303 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT *
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_month IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m10:50:39.670709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.149 seconds
[0m10:50:39.675340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50457ad1-93a7-4e14-940e-53506e5812ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA7225EE0>]}
[0m10:50:39.709037 [info ] [Thread-1 (]: 3 of 3 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 1.28s]
[0m10:50:39.709037 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m10:50:39.778782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:39.779781 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_staging' was left open.
[0m10:50:39.780780 [debug] [MainThread]: On create_DE_MINI_PROJECT_staging: Close
[0m10:50:40.116796 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m10:50:40.116796 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m10:50:40.443614 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m10:50:40.443614 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m10:50:40.818798 [info ] [MainThread]: 
[0m10:50:40.818798 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.67 seconds (13.67s).
[0m10:50:40.844749 [debug] [MainThread]: Command end result
[0m10:50:41.164514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:50:41.169118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:50:41.229226 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m10:50:41.229226 [info ] [MainThread]: 
[0m10:50:41.233706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:50:41.258514 [info ] [MainThread]: 
[0m10:50:41.260078 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql
[0m10:50:41.262089 [info ] [MainThread]: 
[0m10:50:41.286720 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m10:50:41.291952 [debug] [MainThread]: Command `dbt run` failed at 10:50:41.291952 after 37.02 seconds
[0m10:50:41.409428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C986CB830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C98847EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9894F7D0>]}
[0m10:50:41.409428 [debug] [MainThread]: Flushing usage events
[0m10:50:43.846719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:24.845486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD73182F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD5DAEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD5DAE270>]}


============================== 10:51:24.861612 | 126a29b8-9efd-4370-866e-c1efca50e4ef ==============================
[0m10:51:24.861612 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:51:24.861612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m10:51:26.107918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '126a29b8-9efd-4370-866e-c1efca50e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE567ACC0>]}
[0m10:51:26.177364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '126a29b8-9efd-4370-866e-c1efca50e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE4DE7200>]}
[0m10:51:26.177364 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:51:26.775011 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:51:26.985386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:51:26.985386 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m10:51:27.323887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '126a29b8-9efd-4370-866e-c1efca50e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE67E4620>]}
[0m10:51:27.411279 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:51:27.415295 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:51:27.451187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '126a29b8-9efd-4370-866e-c1efca50e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE67C6DB0>]}
[0m10:51:27.451187 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:51:27.451187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '126a29b8-9efd-4370-866e-c1efca50e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AE6542F30>]}
[0m10:51:27.451187 [info ] [MainThread]: 
[0m10:51:27.451187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:27.451187 [info ] [MainThread]: 
[0m10:51:27.451187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:51:27.451187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m10:51:27.599890 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m10:51:27.599890 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m10:51:27.599890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:29.008906 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.415 seconds
[0m10:51:29.008906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '126a29b8-9efd-4370-866e-c1efca50e4ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD69A0FE0>]}
[0m10:51:29.020774 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m10:51:29.020774 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m10:51:29.020774 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m10:51:29.020774 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:51:29.035974 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m10:51:29.035974 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m10:51:29.035974 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m10:51:29.035974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m10:51:29.035974 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m10:51:29.035974 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m10:51:29.035974 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m10:51:29.035974 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m10:51:29.045228 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:29.045752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m10:51:29.045752 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:29.050052 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:51:29.051030 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:29.052014 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:29.053267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:29.054301 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m10:51:29.054301 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m10:51:29.387254 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was properly closed.
[0m10:51:29.387254 [debug] [MainThread]: Command end result
[0m10:51:29.409340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:51:29.409340 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:51:29.425792 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m10:51:29.425792 [debug] [MainThread]: Command `dbt compile` succeeded at 10:51:29.425792 after 4.78 seconds
[0m10:51:29.425792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD8A35FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD8B8BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD892F9E0>]}
[0m10:51:29.425792 [debug] [MainThread]: Flushing usage events
[0m10:51:30.309692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:39.765441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A087174A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07FDBD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07FDB770>]}


============================== 10:51:39.781146 | 3fdbdce3-59a4-47a6-9eeb-acc3768273d9 ==============================
[0m10:51:39.781146 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:51:39.781146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:51:41.029842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A151B8080>]}
[0m10:51:41.111172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A081A3860>]}
[0m10:51:41.112921 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:51:41.696349 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:51:41.887230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:41.887230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:41.935096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A154C3110>]}
[0m10:51:42.030647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:51:42.031079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:51:42.070040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A15827080>]}
[0m10:51:42.070040 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:51:42.070040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1542F170>]}
[0m10:51:42.070040 [info ] [MainThread]: 
[0m10:51:42.070040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:42.070040 [info ] [MainThread]: 
[0m10:51:42.070040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:51:42.087353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m10:51:42.202784 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m10:51:42.218462 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m10:51:42.218462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:43.764544 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.547 seconds
[0m10:51:43.764544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m10:51:43.780292 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m10:51:43.780292 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m10:51:43.780292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:44.737145 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.968 seconds
[0m10:51:44.752879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A1540DFD0>]}
[0m10:51:44.756731 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m10:51:44.756731 [info ] [Thread-1 (]: 1 of 3 START sql table model staging.stg_customers ............................. [RUN]
[0m10:51:44.756731 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m10:51:44.756731 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m10:51:44.770115 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:51:44.771522 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m10:51:44.813029 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:51:44.814029 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m10:51:44.815029 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    *
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMER_NAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m10:51:44.816029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:45.716792 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee1-3201-7db6-000c-3d5a00020302
[0m10:51:45.716792 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 8
invalid identifier 'CUSTOMER_NAME'
[0m10:51:45.716792 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql
[0m10:51:45.732713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A07BBD160>]}
[0m10:51:45.733595 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model staging.stg_customers .................... [[31mERROR[0m in 0.96s]
[0m10:51:45.733595 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m10:51:45.733595 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m10:51:45.733595 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql.
[0m10:51:45.733595 [info ] [Thread-1 (]: 2 of 3 START sql table model staging.stg_products .............................. [RUN]
[0m10:51:45.733595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m10:51:45.733595 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m10:51:45.742146 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m10:51:45.744151 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m10:51:45.747176 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m10:51:45.749030 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m10:51:45.749030 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT *
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m10:51:46.386913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m10:51:46.434160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A16E7B9E0>]}
[0m10:51:46.434160 [info ] [Thread-1 (]: 2 of 3 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 0.70s]
[0m10:51:46.434160 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m10:51:46.434160 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:46.438570 [info ] [Thread-1 (]: 3 of 3 START sql table model staging.stg_transactions .......................... [RUN]
[0m10:51:46.438570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m10:51:46.438570 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:46.443328 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:51:46.445335 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:46.447343 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:51:46.451922 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m10:51:46.452919 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT *
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_month IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m10:51:47.302009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m10:51:47.302009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fdbdce3-59a4-47a6-9eeb-acc3768273d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A16E7BFB0>]}
[0m10:51:47.317945 [info ] [Thread-1 (]: 3 of 3 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m10:51:47.317945 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m10:51:47.317945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:47.317945 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m10:51:47.317945 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m10:51:47.660942 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m10:51:47.660942 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m10:51:47.987812 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m10:51:47.987812 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m10:51:48.308590 [info ] [MainThread]: 
[0m10:51:48.321190 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m10:51:48.321190 [debug] [MainThread]: Command end result
[0m10:51:48.349315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:51:48.351322 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:51:48.360225 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m10:51:48.362234 [info ] [MainThread]: 
[0m10:51:48.363236 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:51:48.363236 [info ] [MainThread]: 
[0m10:51:48.364867 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql
[0m10:51:48.364867 [info ] [MainThread]: 
[0m10:51:48.364867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m10:51:48.364867 [debug] [MainThread]: Command `dbt run` failed at 10:51:48.364867 after 8.80 seconds
[0m10:51:48.364867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A080269F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A064DC380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A064DC350>]}
[0m10:51:48.364867 [debug] [MainThread]: Flushing usage events
[0m10:51:49.261813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:35.475943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D420635B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4206351F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D420635820>]}


============================== 10:52:35.491783 | ca381eb2-4929-479c-8974-4ab0f4ddda32 ==============================
[0m10:52:35.491783 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:52:35.491783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:36.791672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D42C571460>]}
[0m10:52:36.858743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D41FA68470>]}
[0m10:52:36.858743 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:52:37.477267 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:52:37.694546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:52:37.694546 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m10:52:38.046799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D42D844230>]}
[0m10:52:38.128079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:52:38.146735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:52:38.178432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D42D54C2F0>]}
[0m10:52:38.178432 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:52:38.178432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D42D377230>]}
[0m10:52:38.194184 [info ] [MainThread]: 
[0m10:52:38.195216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:38.196181 [info ] [MainThread]: 
[0m10:52:38.197180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:38.203769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m10:52:38.337618 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m10:52:38.338619 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m10:52:38.338619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:39.673619 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.349 seconds
[0m10:52:39.689431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m10:52:39.695336 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m10:52:39.705578 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m10:52:39.705578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:40.619646 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.919 seconds
[0m10:52:40.619646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D41DA810A0>]}
[0m10:52:40.619646 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m10:52:40.619646 [info ] [Thread-1 (]: 1 of 3 START sql table model staging.stg_customers ............................. [RUN]
[0m10:52:40.619646 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m10:52:40.619646 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m10:52:40.635595 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:52:40.635595 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m10:52:40.679556 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m10:52:40.679556 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m10:52:40.679556 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    *
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m10:52:40.679556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:42.365937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.691 seconds
[0m10:52:42.397628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D41D9D7200>]}
[0m10:52:42.397628 [info ] [Thread-1 (]: 1 of 3 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.78s]
[0m10:52:42.397628 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m10:52:42.397628 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m10:52:42.397628 [info ] [Thread-1 (]: 2 of 3 START sql table model staging.stg_products .............................. [RUN]
[0m10:52:42.397628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m10:52:42.397628 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m10:52:42.415499 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m10:52:42.417507 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m10:52:42.419516 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m10:52:42.421524 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m10:52:42.421524 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT *
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m10:52:43.151823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m10:52:43.151823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D42EE57C80>]}
[0m10:52:43.151823 [info ] [Thread-1 (]: 2 of 3 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 0.75s]
[0m10:52:43.151823 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m10:52:43.151823 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m10:52:43.151823 [info ] [Thread-1 (]: 3 of 3 START sql table model staging.stg_transactions .......................... [RUN]
[0m10:52:43.151823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m10:52:43.151823 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m10:52:43.166681 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:52:43.167834 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m10:52:43.170837 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m10:52:43.171836 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m10:52:43.171836 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT *
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_month IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m10:52:44.016180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m10:52:44.016180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca381eb2-4929-479c-8974-4ab0f4ddda32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D42EE56E10>]}
[0m10:52:44.016180 [info ] [Thread-1 (]: 3 of 3 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m10:52:44.016180 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m10:52:44.016180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:44.016180 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m10:52:44.016180 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m10:52:44.340354 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m10:52:44.340354 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m10:52:44.669002 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m10:52:44.669002 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m10:52:44.984278 [info ] [MainThread]: 
[0m10:52:44.984278 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m10:52:44.999538 [debug] [MainThread]: Command end result
[0m10:52:45.027417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m10:52:45.028420 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m10:52:45.037296 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m10:52:45.037296 [info ] [MainThread]: 
[0m10:52:45.037296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:45.043362 [info ] [MainThread]: 
[0m10:52:45.043362 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:52:45.045370 [debug] [MainThread]: Command `dbt run` succeeded at 10:52:45.045370 after 9.76 seconds
[0m10:52:45.045370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D41E3F8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D41FA0E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D41FA0D1F0>]}
[0m10:52:45.045370 [debug] [MainThread]: Flushing usage events
[0m10:52:45.935917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:25.585524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE951B6A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE951B75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE951B7EF0>]}


============================== 11:01:25.593725 | 366955f2-ad54-46fe-b45a-a3b885b1869b ==============================
[0m11:01:25.593725 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:01:25.593725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m11:01:26.963692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA12093A0>]}
[0m11:01:27.034891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9F918500>]}
[0m11:01:27.050898 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:01:27.676335 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:01:27.886155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:27.886155 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:01:28.233853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA23BC560>]}
[0m11:01:28.332394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:01:28.338416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:01:28.370062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA20CCD10>]}
[0m11:01:28.370062 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:01:28.370062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA23A9850>]}
[0m11:01:28.385905 [info ] [MainThread]: 
[0m11:01:28.385905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:28.385905 [info ] [MainThread]: 
[0m11:01:28.385905 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:01:28.385905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:01:28.537255 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:01:28.537255 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:01:28.537255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:29.913786 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.366 seconds
[0m11:01:29.921150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:01:29.926086 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:01:29.926086 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:01:29.926086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:30.908180 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.972 seconds
[0m11:01:30.912182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE92601250>]}
[0m11:01:30.915264 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:01:30.916266 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:01:30.917265 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:01:30.917265 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:01:30.927913 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:01:30.928925 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:01:30.967121 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:01:30.976519 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:01:30.976519 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    *
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
    AND REGEXP_LIKE(CUSTOMERNAME, '^[A-Za-z\s]+$') -- Ensures only alphabets and spaces in CUSTOMERNAME
)
SELECT * FROM customers_cleaning
        );
[0m11:01:30.977518 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:01:32.454993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m11:01:32.486732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366955f2-ad54-46fe-b45a-a3b885b1869b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE94669220>]}
[0m11:01:32.487741 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.57s]
[0m11:01:32.488178 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:01:32.490197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:32.491228 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:01:32.491228 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:01:32.920930 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:01:32.928526 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:01:33.276211 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:01:33.276211 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:01:33.660104 [info ] [MainThread]: 
[0m11:01:33.661378 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m11:01:33.662376 [debug] [MainThread]: Command end result
[0m11:01:33.689495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:01:33.703032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:01:33.713587 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:01:33.714586 [info ] [MainThread]: 
[0m11:01:33.725587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:01:33.728588 [info ] [MainThread]: 
[0m11:01:33.729587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:01:33.731588 [debug] [MainThread]: Command `dbt run` succeeded at 11:01:33.731588 after 8.41 seconds
[0m11:01:33.732586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE950A9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE929478F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE92946330>]}
[0m11:01:33.733586 [debug] [MainThread]: Flushing usage events
[0m11:01:34.705790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:43.432011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C84926AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C849255B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C84926000>]}


============================== 11:06:43.446042 | 83f3207b-bdeb-4500-ae1c-da2378784aeb ==============================
[0m11:06:43.446042 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:06:43.446042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_transactions', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:06:48.834443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C8448DC10>]}
[0m11:06:48.914827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C906EAF00>]}
[0m11:06:48.914827 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:06:49.775768 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:06:51.676528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:06:51.676528 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_transactions.sql
[0m11:06:52.010316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C91B40200>]}
[0m11:06:52.097683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:06:52.127589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:06:52.176070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9184CC50>]}
[0m11:06:52.177046 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:06:52.178043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C916770B0>]}
[0m11:06:52.180075 [info ] [MainThread]: 
[0m11:06:52.180741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:52.181750 [info ] [MainThread]: 
[0m11:06:52.181750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:52.183554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:06:57.782399 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:06:57.782399 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:06:57.782399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:59.235147 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.441 seconds
[0m11:06:59.235147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:06:59.252143 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:06:59.252143 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:06:59.252143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:00.218846 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.970 seconds
[0m11:07:00.234635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C91B28A40>]}
[0m11:07:00.235152 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:00.235152 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_transactions .......................... [RUN]
[0m11:07:00.235152 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_transactions'
[0m11:07:00.235152 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:00.249433 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:07:00.251358 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:00.289992 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:07:00.297429 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m11:07:00.297429 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    compaines
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_month IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m11:07:00.297429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:01.602037 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef1-3201-7e57-000c-3d5a0001f646
[0m11:07:01.602037 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'COMPAINES'
[0m11:07:01.639028 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'COMPAINES'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_transactions.sql
[0m11:07:01.639028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f3207b-bdeb-4500-ae1c-da2378784aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C83DD1A00>]}
[0m11:07:01.639028 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_transactions ................. [[31mERROR[0m in 1.40s]
[0m11:07:01.639028 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:01.639028 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'COMPAINES'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_transactions.sql.
[0m11:07:01.655730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:01.655730 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:07:01.655730 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:07:01.987278 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:07:01.987803 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:07:02.304020 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m11:07:02.304020 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m11:07:02.639418 [info ] [MainThread]: 
[0m11:07:02.639418 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.46 seconds (10.46s).
[0m11:07:02.639418 [debug] [MainThread]: Command end result
[0m11:07:02.694089 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:07:02.694089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:07:02.706365 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:07:02.706365 [info ] [MainThread]: 
[0m11:07:02.706365 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:07:02.706365 [info ] [MainThread]: 
[0m11:07:02.706365 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'COMPAINES'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_transactions.sql
[0m11:07:02.706365 [info ] [MainThread]: 
[0m11:07:02.706365 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:07:02.706365 [debug] [MainThread]: Command `dbt run` failed at 11:07:02.706365 after 19.54 seconds
[0m11:07:02.706365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C84561100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C917EC9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C82591E80>]}
[0m11:07:02.706365 [debug] [MainThread]: Flushing usage events
[0m11:07:03.656500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:09.368695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E429D3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E428F0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E428F3830>]}


============================== 11:07:09.368695 | 5a9cf459-c5a0-473c-ad74-c6a504161f78 ==============================
[0m11:07:09.368695 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:07:09.368695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transactions', 'send_anonymous_usage_stats': 'True'}
[0m11:07:10.612830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E50F48650>]}
[0m11:07:10.695420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E524F2F00>]}
[0m11:07:10.695420 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:07:11.312915 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:07:11.546402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:11.546402 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_transactions.sql
[0m11:07:11.880103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E5289D760>]}
[0m11:07:11.979777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:07:11.984023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:07:12.026450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E528BBC80>]}
[0m11:07:12.027470 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:07:12.028437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E52437260>]}
[0m11:07:12.029474 [info ] [MainThread]: 
[0m11:07:12.029474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:12.029474 [info ] [MainThread]: 
[0m11:07:12.029474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:12.034029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:07:12.167265 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:07:12.167265 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:07:12.168230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:13.265529 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.112 seconds
[0m11:07:13.283661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:07:13.298536 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:07:13.298536 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:07:13.298536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:14.514684 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.211 seconds
[0m11:07:14.519535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E53E87200>]}
[0m11:07:14.522532 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:14.523533 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_transactions .......................... [RUN]
[0m11:07:14.524532 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_transactions'
[0m11:07:14.524532 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:14.535447 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:07:14.536409 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:14.577370 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:07:14.579369 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m11:07:14.580369 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity,
    companies
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_month IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m11:07:14.580369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:16.028939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.449 seconds
[0m11:07:16.075164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a9cf459-c5a0-473c-ad74-c6a504161f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E42AEB530>]}
[0m11:07:16.076163 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 1.55s]
[0m11:07:16.085080 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m11:07:16.087082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:16.088078 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:07:16.088078 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:07:16.407588 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:07:16.407588 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:07:16.730885 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m11:07:16.730885 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m11:07:17.048675 [info ] [MainThread]: 
[0m11:07:17.049649 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m11:07:17.050650 [debug] [MainThread]: Command end result
[0m11:07:17.077684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:07:17.080652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:07:17.091556 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:07:17.091556 [info ] [MainThread]: 
[0m11:07:17.092538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:17.093538 [info ] [MainThread]: 
[0m11:07:17.094538 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:07:17.096307 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:17.096307 after 7.93 seconds
[0m11:07:17.096307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E453E5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E450FD5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E451A3440>]}
[0m11:07:17.097426 [debug] [MainThread]: Flushing usage events
[0m11:07:17.994260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:09.747663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4FABFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE51D6AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE51D6B5C0>]}


============================== 11:10:09.760841 | aad6329e-5565-45a4-b465-eb426824eed8 ==============================
[0m11:10:09.760841 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:10:09.762808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:10:11.028917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5F38A930>]}
[0m11:10:11.105926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4F207D70>]}
[0m11:10:11.107935 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:10:11.707247 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:10:11.906150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:10:11.907900 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:10:12.239411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5F5A5760>]}
[0m11:10:12.326614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:10:12.326614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:10:12.365969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5FB488F0>]}
[0m11:10:12.365969 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:10:12.365969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5ED073B0>]}
[0m11:10:12.365969 [info ] [MainThread]: 
[0m11:10:12.365969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:12.365969 [info ] [MainThread]: 
[0m11:10:12.365969 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:12.365969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:10:12.492635 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:10:12.492635 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:10:12.492635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:13.858508 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.365 seconds
[0m11:10:13.882967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:10:13.890234 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:10:13.890234 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:10:13.890234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:14.877560 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.981 seconds
[0m11:10:14.877560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE60EE26C0>]}
[0m11:10:14.877560 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:10:14.877560 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:10:14.877560 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:10:14.877560 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:10:14.893312 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:10:14.893312 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:10:14.929092 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:10:14.929092 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:10:14.929092 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    *
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m11:10:14.945122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:16.334275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.397 seconds
[0m11:10:16.366024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6329e-5565-45a4-b465-eb426824eed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4FC572F0>]}
[0m11:10:16.366024 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.49s]
[0m11:10:16.366024 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:10:16.366024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:16.366024 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:10:16.366024 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:10:16.716211 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:10:16.716211 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:10:17.043785 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:10:17.043785 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:10:17.371969 [info ] [MainThread]: 
[0m11:10:17.371969 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m11:10:17.371969 [debug] [MainThread]: Command end result
[0m11:10:17.404721 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:10:17.405765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:10:17.416275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:10:17.416925 [info ] [MainThread]: 
[0m11:10:17.416925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:17.416925 [info ] [MainThread]: 
[0m11:10:17.419985 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:17.419985 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:17.419985 after 7.88 seconds
[0m11:10:17.419985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE522826F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE51E20050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE51E200E0>]}
[0m11:10:17.419985 [debug] [MainThread]: Flushing usage events
[0m11:10:18.316765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:52.507712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227573376E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022757336D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227573356A0>]}


============================== 11:11:52.519205 | 58ca88b2-3a07-4f82-9b01-5f687b0c9a6b ==============================
[0m11:11:52.519205 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:11:52.519205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m11:11:53.770909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002275681A0F0>]}
[0m11:11:53.849771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022763FA5E20>]}
[0m11:11:53.849771 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:11:54.430156 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:11:54.636663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:11:54.636663 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:11:54.974847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276460BCE0>]}
[0m11:11:55.059121 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:11:55.064403 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:11:55.106762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227642FEED0>]}
[0m11:11:55.106762 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:11:55.106762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227645F66F0>]}
[0m11:11:55.111339 [info ] [MainThread]: 
[0m11:11:55.111339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:55.111339 [info ] [MainThread]: 
[0m11:11:55.111339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:55.111339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:11:55.244753 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:11:55.244753 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:11:55.244753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:56.580240 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.338 seconds
[0m11:11:56.580240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:11:56.596380 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:11:56.596380 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:11:56.596380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:57.569760 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.963 seconds
[0m11:11:57.569760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276449D610>]}
[0m11:11:57.569760 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:11:57.569760 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:11:57.569760 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:11:57.569760 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:11:57.588444 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:11:57.590075 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:11:57.630038 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:11:57.632144 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:11:57.632144 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (-- WITH customers_cleaning AS (
    
-- SELECT 
--     DISTINCT
--     *
-- FROM de_mini_project.raw.customers
-- WHERE 
--     CUSTOMER_ID IS NOT NULL
--     AND COMPANY IS NOT NULL
--     AND CUSTOMERNAME IS NOT NULL
-- )
-- SELECT * FROM customers_cleaning


WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    CUSTOMER_ID,
    COMPANY,
    REGEXP_LIKE(CUSTOMERNAME, '^[A-Za-z\s]+$') AS CUSTOMERNAME
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m11:11:57.633112 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:11:58.934126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.300 seconds
[0m11:11:58.963937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ca88b2-3a07-4f82-9b01-5f687b0c9a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227567E9250>]}
[0m11:11:58.963937 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.38s]
[0m11:11:58.963937 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:11:58.963937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:58.963937 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:11:58.963937 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:11:59.289024 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:11:59.289024 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:11:59.609142 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:11:59.609142 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:11:59.938630 [info ] [MainThread]: 
[0m11:11:59.938630 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m11:11:59.938630 [debug] [MainThread]: Command end result
[0m11:11:59.967455 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:11:59.971119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:11:59.975155 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:11:59.975155 [info ] [MainThread]: 
[0m11:11:59.975155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:59.975155 [info ] [MainThread]: 
[0m11:11:59.975155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:59.983034 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:59.983034 after 7.68 seconds
[0m11:11:59.983034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227550F80E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227567AD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022753942CC0>]}
[0m11:11:59.984078 [debug] [MainThread]: Flushing usage events
[0m11:12:00.849651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:36.781168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F670515790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66CD6E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6705170B0>]}


============================== 11:13:36.796677 | 408d9ea6-6e89-4160-887b-fa0b22b1cee4 ==============================
[0m11:13:36.796677 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:13:36.798209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m11:13:38.134574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67C691250>]}
[0m11:13:38.211275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67CF4AF00>]}
[0m11:13:38.227034 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:13:38.833342 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:13:39.048697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:13:39.048697 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:13:39.399691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67D1763C0>]}
[0m11:13:39.482531 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:13:39.482531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:13:39.533137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67D720BC0>]}
[0m11:13:39.533137 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:13:39.533137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67D70DBE0>]}
[0m11:13:39.533137 [info ] [MainThread]: 
[0m11:13:39.533137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:39.533137 [info ] [MainThread]: 
[0m11:13:39.533137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:39.533137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:13:39.672403 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:13:39.672403 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:13:39.672403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:41.158691 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.485 seconds
[0m11:13:41.170130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:13:41.174813 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:13:41.184457 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:13:41.184457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:42.151483 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.970 seconds
[0m11:13:42.151483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67E972720>]}
[0m11:13:42.151483 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:13:42.166671 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:13:42.166671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:13:42.166671 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:13:42.166671 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:13:42.166671 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:13:42.218558 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:13:42.218558 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:13:42.218558 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (-- WITH customers_cleaning AS (
    
-- SELECT 
--     DISTINCT
--     *
-- FROM de_mini_project.raw.customers
-- WHERE 
--     CUSTOMER_ID IS NOT NULL
--     AND COMPANY IS NOT NULL
--     AND CUSTOMERNAME IS NOT NULL
-- )
-- SELECT * FROM customers_cleaning


WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    CUSTOMER_ID,
    COMPANY,
    REGEXP_REPLACE(CUSTOMERNAME, '^[A-Za-z\s]+$') AS CUSTOMERNAME
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m11:13:42.218558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:13:43.680379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.454 seconds
[0m11:13:43.712465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408d9ea6-6e89-4160-887b-fa0b22b1cee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66D8B72F0>]}
[0m11:13:43.713500 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.54s]
[0m11:13:43.714465 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:13:43.716464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:43.717462 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:13:43.717462 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:13:44.041575 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:13:44.041575 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:13:44.370302 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:13:44.370302 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:13:44.690556 [info ] [MainThread]: 
[0m11:13:44.704035 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m11:13:44.705818 [debug] [MainThread]: Command end result
[0m11:13:44.727548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:13:44.727548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:13:44.745440 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:13:44.745440 [info ] [MainThread]: 
[0m11:13:44.746453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:44.746453 [info ] [MainThread]: 
[0m11:13:44.746453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:44.746453 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:44.746453 after 8.20 seconds
[0m11:13:44.746453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66F5E20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67007F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6701E0470>]}
[0m11:13:44.746453 [debug] [MainThread]: Flushing usage events
[0m11:13:45.972356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:47.352846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D997C62A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D96A2BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D990D6E10>]}


============================== 11:15:47.359414 | a6507d18-72f1-4b66-893e-7ee82b450b64 ==============================
[0m11:15:47.359414 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:15:47.360415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:15:48.661595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA575E270>]}
[0m11:15:48.743115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA6442F00>]}
[0m11:15:48.743115 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:15:49.346679 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:15:49.586383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:15:49.586383 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:15:50.013422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA6556960>]}
[0m11:15:50.097268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:15:50.108582 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:15:50.146057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D974A4E60>]}
[0m11:15:50.146057 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:15:50.146057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA6917530>]}
[0m11:15:50.153108 [info ] [MainThread]: 
[0m11:15:50.153108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:50.153108 [info ] [MainThread]: 
[0m11:15:50.153108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:50.153108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:15:50.280784 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:15:50.280784 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:15:50.280784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:51.723140 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.430 seconds
[0m11:15:51.731507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:15:51.744458 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:15:51.744458 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:15:51.745454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:52.718768 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.974 seconds
[0m11:15:52.721080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA6A56B40>]}
[0m11:15:52.721080 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:15:52.721080 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:15:52.721080 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:15:52.721080 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:15:52.739768 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:15:52.740743 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:15:52.784579 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:15:52.784579 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:15:52.784579 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (-- WITH customers_cleaning AS (
    
-- SELECT 
--     DISTINCT
--     *
-- FROM de_mini_project.raw.customers
-- WHERE 
--     CUSTOMER_ID IS NOT NULL
--     AND COMPANY IS NOT NULL
--     AND CUSTOMERNAME IS NOT NULL
-- )
-- SELECT * FROM customers_cleaning


WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    CUSTOMER_ID,
    COMPANY,
    REGEXP_REPLACE(CUSTOMERNAME, '^[A-Za-z\s]','') AS CUSTOMERNAME
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m11:15:52.784579 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:15:54.087664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.303 seconds
[0m11:15:54.121528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6507d18-72f1-4b66-893e-7ee82b450b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D96B6B4D0>]}
[0m11:15:54.121528 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.40s]
[0m11:15:54.121528 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:15:54.121528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:54.121528 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:15:54.121528 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:15:54.450539 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:15:54.450539 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:15:54.773965 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:15:54.773965 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:15:55.101446 [info ] [MainThread]: 
[0m11:15:55.101446 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m11:15:55.101446 [debug] [MainThread]: Command end result
[0m11:15:55.145304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:15:55.146337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:15:55.154484 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:15:55.154484 [info ] [MainThread]: 
[0m11:15:55.154484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:55.154484 [info ] [MainThread]: 
[0m11:15:55.154484 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:55.154484 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:55.154484 after 8.03 seconds
[0m11:15:55.154484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D96A2BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9932F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D97588470>]}
[0m11:15:55.154484 [debug] [MainThread]: Flushing usage events
[0m11:15:56.404415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:09.143362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020637256510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020637256AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020637255A00>]}


============================== 11:31:09.155272 | 0e162c49-d3a2-414e-8506-d099a43f0b99 ==============================
[0m11:31:09.155272 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:31:09.157432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:31:13.638359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063729C590>]}
[0m11:31:13.708968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020643D1A7E0>]}
[0m11:31:13.708968 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:31:14.474447 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:31:16.099465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:16.100288 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:31:16.424552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206443E56A0>]}
[0m11:31:16.508179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:31:16.527446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:31:16.583219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206441FFC80>]}
[0m11:31:16.583219 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:31:16.583219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206441A13A0>]}
[0m11:31:16.583219 [info ] [MainThread]: 
[0m11:31:16.583219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:16.588458 [info ] [MainThread]: 
[0m11:31:16.589345 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:16.590862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:31:19.915299 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:31:19.916020 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:31:19.916020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:21.450083 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.537 seconds
[0m11:31:21.450083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:31:21.466127 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:31:21.466127 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:31:21.466127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:22.479807 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.007 seconds
[0m11:31:22.479807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206441FEC30>]}
[0m11:31:22.479807 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:31:22.479807 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:31:22.479807 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:31:22.479807 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:31:22.500469 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:31:22.502586 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:31:22.542495 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:31:22.544495 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:31:22.545494 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (-- WITH customers_cleaning AS (
    
-- SELECT 
--     DISTINCT
--     *
-- FROM de_mini_project.raw.customers
-- WHERE 
--     CUSTOMER_ID IS NOT NULL
--     AND COMPANY IS NOT NULL
--     AND CUSTOMERNAME IS NOT NULL
-- )
-- SELECT * FROM customers_cleaning


WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    CUSTOMER_ID,
    COMPANY,
    CUSTOMERNAME
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m11:31:22.545494 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:31:24.406615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.861 seconds
[0m11:31:24.439401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e162c49-d3a2-414e-8506-d099a43f0b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206345F71A0>]}
[0m11:31:24.439401 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.96s]
[0m11:31:24.440911 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:31:24.440911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:24.440911 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:31:24.440911 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:31:24.790006 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:31:24.791006 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:31:25.120739 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:31:25.120739 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:31:25.482234 [info ] [MainThread]: 
[0m11:31:25.484197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m11:31:25.486559 [debug] [MainThread]: Command end result
[0m11:31:25.511998 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:31:25.511998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:31:25.522602 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:31:25.522602 [info ] [MainThread]: 
[0m11:31:25.522602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:25.527866 [info ] [MainThread]: 
[0m11:31:25.527866 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:31:25.527866 [debug] [MainThread]: Command `dbt run` succeeded at 11:31:25.527866 after 16.66 seconds
[0m11:31:25.527866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020636EC7EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020636F24CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020636735AC0>]}
[0m11:31:25.531534 [debug] [MainThread]: Flushing usage events
[0m11:31:26.449094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:39.699996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C0657080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C0657440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C0656CC0>]}


============================== 11:38:39.715985 | 33407e7d-fb3d-4194-b52c-8dd74f6bc54b ==============================
[0m11:38:39.715985 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:38:39.715985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:44.046684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD2EE270>]}
[0m11:38:44.130472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD2EE9F0>]}
[0m11:38:44.130472 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:38:44.861312 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:38:46.453707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:46.453707 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m11:38:46.775794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD887EF0>]}
[0m11:38:46.853413 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:38:46.869216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:38:46.942141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD57C9B0>]}
[0m11:38:46.945564 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:38:46.946571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD5D1B80>]}
[0m11:38:46.948357 [info ] [MainThread]: 
[0m11:38:46.948357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:46.948357 [info ] [MainThread]: 
[0m11:38:46.948357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:46.952122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:38:50.225933 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:38:50.225933 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:38:50.225933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:51.760365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.535 seconds
[0m11:38:51.771533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:38:51.771533 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:38:51.771533 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:38:51.771533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:53.065563 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.287 seconds
[0m11:38:53.081694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD876360>]}
[0m11:38:53.081694 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:38:53.081694 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m11:38:53.081694 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m11:38:53.081694 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:38:53.107139 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:38:53.114560 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:38:53.153802 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:38:53.156610 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m11:38:53.157607 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (-- WITH customers_cleaning AS (
    
-- SELECT 
--     DISTINCT
--     *
-- FROM de_mini_project.raw.customers
-- WHERE 
--     CUSTOMER_ID IS NOT NULL
--     AND COMPANY IS NOT NULL
--     AND CUSTOMERNAME IS NOT NULL
-- )
-- SELECT * FROM customers_cleaning


WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    CUSTOMER_ID,
    COMPANY,
    CUSTOMERNAME AS CUSTOMER_NAME
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT * FROM customers_cleaning
        );
[0m11:38:53.157607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:54.810712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m11:38:54.842552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33407e7d-fb3d-4194-b52c-8dd74f6bc54b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286BFB00FB0>]}
[0m11:38:54.842552 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.76s]
[0m11:38:54.842552 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:38:54.842552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:54.842552 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:38:54.842552 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:38:55.170788 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:38:55.170788 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:38:55.490510 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m11:38:55.490510 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m11:38:55.826027 [info ] [MainThread]: 
[0m11:38:55.826027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m11:38:55.828035 [debug] [MainThread]: Command end result
[0m11:38:55.856952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:38:55.858951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:38:55.870178 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:38:55.870178 [info ] [MainThread]: 
[0m11:38:55.870178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:55.870178 [info ] [MainThread]: 
[0m11:38:55.870178 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:55.870178 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:55.870178 after 16.43 seconds
[0m11:38:55.870178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CCFF0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286CD51CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286C04EFEF0>]}
[0m11:38:55.870178 [debug] [MainThread]: Flushing usage events
[0m11:38:57.142503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:48.370485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD9FA5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD983EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD9FA50A0>]}


============================== 11:39:48.387468 | 81ab0d40-14e7-4244-89f6-351e71629f2b ==============================
[0m11:39:48.387468 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:39:48.387468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:39:49.635439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FE5F65580>]}
[0m11:39:49.706851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FE695AF00>]}
[0m11:39:49.706851 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:39:50.305528 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:39:50.522069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:50.522069 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_transactions.sql
[0m11:39:50.856156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FE7247F20>]}
[0m11:39:50.939612 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:39:50.939612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:39:50.990052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FE6F3D1C0>]}
[0m11:39:50.990052 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:39:50.990052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FE71272C0>]}
[0m11:39:50.995246 [info ] [MainThread]: 
[0m11:39:50.995246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:50.995246 [info ] [MainThread]: 
[0m11:39:50.995246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:50.999184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:39:51.127952 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:39:51.128952 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:39:51.128952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:52.625723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.504 seconds
[0m11:39:52.641540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:39:52.661245 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:39:52.661245 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:39:52.661245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:53.623772 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.970 seconds
[0m11:39:53.639741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FE6D4D610>]}
[0m11:39:53.639741 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m11:39:53.639741 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_transactions .......................... [RUN]
[0m11:39:53.639741 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_transactions'
[0m11:39:53.639741 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m11:39:53.667193 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:39:53.669155 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m11:39:53.710051 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:39:53.713050 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m11:39:53.713050 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month,
    revenue_type,
    revenue,
    quantity
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_month IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m11:39:53.714052 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:55.242298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.532 seconds
[0m11:39:55.277270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ab0d40-14e7-4244-89f6-351e71629f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD9459610>]}
[0m11:39:55.278279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 1.63s]
[0m11:39:55.278877 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m11:39:55.280885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:55.280885 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:39:55.281919 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:39:55.607507 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:39:55.608512 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:39:55.946518 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m11:39:55.946518 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m11:39:56.268583 [info ] [MainThread]: 
[0m11:39:56.268583 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m11:39:56.268583 [debug] [MainThread]: Command end result
[0m11:39:56.295589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:39:56.295589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:39:56.314549 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:39:56.315629 [info ] [MainThread]: 
[0m11:39:56.316626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:56.317622 [info ] [MainThread]: 
[0m11:39:56.317622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:56.317622 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:56.317622 after 8.15 seconds
[0m11:39:56.317622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD983EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD9C74CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FD940E570>]}
[0m11:39:56.317622 [debug] [MainThread]: Flushing usage events
[0m11:39:57.250486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:47.824948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020370222ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F2F3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020370223D70>]}


============================== 11:49:47.840648 | f3500beb-e995-4249-b10d-fa85f431b92c ==============================
[0m11:49:47.840648 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:49:47.840648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:49.568861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037CB62B40>]}
[0m11:49:49.648437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037BB7AED0>]}
[0m11:49:49.648437 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:49:50.246452 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:49:50.492320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m11:49:50.492320 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\int_customers.sql
[0m11:49:50.492320 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\staging\stg_country.sql
[0m11:49:50.492320 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://seeds\country_region.csv
[0m11:49:51.026642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037C021F40>]}
[0m11:49:51.129224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:49:51.129224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:49:51.184405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037D2C9EB0>]}
[0m11:49:51.184405 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 473 macros
[0m11:49:51.184405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037AB27770>]}
[0m11:49:51.184405 [info ] [MainThread]: 
[0m11:49:51.184405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:51.184405 [info ] [MainThread]: 
[0m11:49:51.184405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:51.184405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:49:51.353611 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:49:51.353611 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:49:51.354653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:52.795146 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.454 seconds
[0m11:49:52.815373 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m11:49:52.829170 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:49:52.829170 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:49:52.829170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:53.778586 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.960 seconds
[0m11:49:53.778586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m11:49:53.794441 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m11:49:53.794441 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m11:49:53.970721 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.184 seconds
[0m11:49:53.970721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037EAEA8D0>]}
[0m11:49:53.986537 [debug] [Thread-1 (]: Began running node seed.DE_MINI_PROJECT.country_region
[0m11:49:53.986537 [info ] [Thread-1 (]: 1 of 1 START seed file RAW.country_region ...................................... [RUN]
[0m11:49:53.986537 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.DE_MINI_PROJECT.country_region'
[0m11:49:53.986537 [debug] [Thread-1 (]: Began compiling node seed.DE_MINI_PROJECT.country_region
[0m11:49:53.986537 [debug] [Thread-1 (]: Began executing node seed.DE_MINI_PROJECT.country_region
[0m11:49:54.040022 [debug] [Thread-1 (]: Using snowflake connection "seed.DE_MINI_PROJECT.country_region"
[0m11:49:54.041022 [debug] [Thread-1 (]: On seed.DE_MINI_PROJECT.country_region: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "seed.DE_MINI_PROJECT.country_region"} */
create table DE_MINI_PROJECT.RAW.country_region (customer_id;
[0m11:49:54.041022 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:55.200928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1b-3201-7e56-000c-3d5a000231fa
[0m11:49:55.200928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 60 unexpected ';'.
[0m11:49:55.216706 [debug] [Thread-1 (]: Database Error in seed country_region (seeds\country_region.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 60 unexpected ';'.
[0m11:49:55.216706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3500beb-e995-4249-b10d-fa85f431b92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F801850>]}
[0m11:49:55.216706 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file RAW.country_region .............................. [[31mERROR[0m in 1.23s]
[0m11:49:55.216706 [debug] [Thread-1 (]: Finished running node seed.DE_MINI_PROJECT.country_region
[0m11:49:55.216706 [debug] [Thread-4 (]: Marking all children of 'seed.DE_MINI_PROJECT.country_region' to be skipped because of status 'error'.  Reason: Database Error in seed country_region (seeds\country_region.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 60 unexpected ';'..
[0m11:49:55.216706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:55.216706 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:49:55.232851 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:49:55.560794 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m11:49:55.560794 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m11:49:55.884685 [debug] [MainThread]: Connection 'seed.DE_MINI_PROJECT.country_region' was left open.
[0m11:49:55.884685 [debug] [MainThread]: On seed.DE_MINI_PROJECT.country_region: Close
[0m11:49:56.191600 [info ] [MainThread]: 
[0m11:49:56.191600 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m11:49:56.191600 [debug] [MainThread]: Command end result
[0m11:49:56.231185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:49:56.234200 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:49:56.241185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:49:56.242152 [info ] [MainThread]: 
[0m11:49:56.242588 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:49:56.242588 [info ] [MainThread]: 
[0m11:49:56.242588 [error] [MainThread]:   Database Error in seed country_region (seeds\country_region.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 60 unexpected ';'.
[0m11:49:56.242588 [info ] [MainThread]: 
[0m11:49:56.242588 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:49:56.248992 [debug] [MainThread]: Command `dbt seed` failed at 11:49:56.248992 after 8.63 seconds
[0m11:49:56.250036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F2F3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F7C2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002036F7C3CB0>]}
[0m11:49:56.250036 [debug] [MainThread]: Flushing usage events
[0m11:49:57.485718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:03.192762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905D15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905951100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905D17680>]}


============================== 11:56:03.199305 | e3b3b5e6-4fa4-4825-a012-efb537d05e4c ==============================
[0m11:56:03.199305 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:56:03.200428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:07.076649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905E9AB40>]}
[0m11:56:07.155583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B912753320>]}
[0m11:56:07.158441 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:56:07.874801 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:56:08.005053 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:56:08.006162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B912CF1D90>]}
[0m11:56:11.056239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B912EE9AC0>]}
[0m11:56:11.151173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:56:11.169973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:56:11.272327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B913FD2600>]}
[0m11:56:11.272327 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 473 macros
[0m11:56:11.273339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B90587F920>]}
[0m11:56:11.276338 [info ] [MainThread]: 
[0m11:56:11.276338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:11.277307 [info ] [MainThread]: 
[0m11:56:11.278703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:11.280794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m11:56:14.562415 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m11:56:14.563414 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m11:56:14.563414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:16.185219 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.634 seconds
[0m11:56:16.201013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m11:56:16.216653 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m11:56:16.216653 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m11:56:16.216653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:17.218076 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.011 seconds
[0m11:56:17.233797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m11:56:17.233797 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:56:17.233797 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:56:17.450950 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.216 seconds
[0m11:56:17.450950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9143801A0>]}
[0m11:56:17.467044 [debug] [Thread-1 (]: Began running node seed.DE_MINI_PROJECT.country_region
[0m11:56:17.467044 [info ] [Thread-1 (]: 1 of 1 START seed file RAW.country_region ...................................... [RUN]
[0m11:56:17.467044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.DE_MINI_PROJECT.country_region'
[0m11:56:17.467044 [debug] [Thread-1 (]: Began compiling node seed.DE_MINI_PROJECT.country_region
[0m11:56:17.467044 [debug] [Thread-1 (]: Began executing node seed.DE_MINI_PROJECT.country_region
[0m11:56:17.533452 [debug] [Thread-1 (]: Using snowflake connection "seed.DE_MINI_PROJECT.country_region"
[0m11:56:17.534453 [debug] [Thread-1 (]: On seed.DE_MINI_PROJECT.country_region: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "seed.DE_MINI_PROJECT.country_region"} */
create table DE_MINI_PROJECT.RAW.country_region (customer_id integer,country text,region text)
[0m11:56:17.534453 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:56:18.461867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m11:56:18.518957 [debug] [Thread-1 (]: Using snowflake connection "seed.DE_MINI_PROJECT.country_region"
[0m11:56:18.520076 [debug] [Thread-1 (]: On seed.DE_MINI_PROJECT.country_region: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "seed.DE_MINI_PROJECT.country_region"} */
BEGIN
[0m11:56:18.712274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m11:56:18.766959 [debug] [Thread-1 (]: Using snowflake connection "seed.DE_MINI_PROJECT.country_region"
[0m11:56:18.766959 [debug] [Thread-1 (]: On seed.DE_MINI_PROJECT.country_region: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "seed.DE_MINI_PROJECT.country_region"} */
insert into DE_MINI_PROJECT.RAW.country_region (customer_id, country, region) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m11:56:19.801887 [debug] [Thread-1 (]: SQL status: SUCCESS 1760 in 1.034 seconds
[0m11:56:19.801887 [debug] [Thread-1 (]: Using snowflake connection "seed.DE_MINI_PROJECT.country_region"
[0m11:56:19.802886 [debug] [Thread-1 (]: On seed.DE_MINI_PROJECT.country_region: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "seed.DE_MINI_PROJECT.country_region"} */
COMMIT
[0m11:56:20.082304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m11:56:20.087994 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.DE_MINI_PROJECT.country_region"
[0m11:56:20.123857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3b5e6-4fa4-4825-a012-efb537d05e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9030B70E0>]}
[0m11:56:20.125865 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file RAW.country_region .................................. [[32mINSERT 1760[0m in 2.65s]
[0m11:56:20.125865 [debug] [Thread-1 (]: Finished running node seed.DE_MINI_PROJECT.country_region
[0m11:56:20.125865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:20.125865 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m11:56:20.125865 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m11:56:20.454162 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:56:20.454162 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:56:20.788517 [debug] [MainThread]: Connection 'seed.DE_MINI_PROJECT.country_region' was left open.
[0m11:56:20.788517 [debug] [MainThread]: On seed.DE_MINI_PROJECT.country_region: Close
[0m11:56:21.117065 [info ] [MainThread]: 
[0m11:56:21.120004 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m11:56:21.123266 [debug] [MainThread]: Command end result
[0m11:56:21.143619 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:56:21.143619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:56:21.162569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:56:21.162569 [info ] [MainThread]: 
[0m11:56:21.164058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:21.165065 [info ] [MainThread]: 
[0m11:56:21.166101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:21.166101 [debug] [MainThread]: Command `dbt seed` succeeded at 11:56:21.166101 after 18.23 seconds
[0m11:56:21.166101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905D16330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905D16450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B905D171A0>]}
[0m11:56:21.166101 [debug] [MainThread]: Flushing usage events
[0m11:56:22.071135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:49.101320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002372D5E9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023730E49100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002372EE48050>]}


============================== 11:57:49.101320 | 548205e5-48e5-4cf0-bdcb-c032201e878f ==============================
[0m11:57:49.101320 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:57:49.101320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:57:50.309099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '548205e5-48e5-4cf0-bdcb-c032201e878f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237309E0FE0>]}
[0m11:57:50.387930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '548205e5-48e5-4cf0-bdcb-c032201e878f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373D941A90>]}
[0m11:57:50.387930 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:57:50.980440 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:57:51.218765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:57:51.218765 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\source.yml
[0m11:57:51.218765 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_country.sql
[0m11:57:51.688515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '548205e5-48e5-4cf0-bdcb-c032201e878f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373E23C830>]}
[0m11:57:51.783317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:57:51.787332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:57:51.815175 [error] [MainThread]: Encountered an error:
Found a cycle: model.DE_MINI_PROJECT.stg_country
[0m11:57:51.885738 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 341, in compile
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 572, in run
    self._runtime_initialize()
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.DE_MINI_PROJECT.stg_country

[0m11:57:51.888508 [debug] [MainThread]: Command `dbt compile` failed at 11:57:51.888508 after 2.99 seconds
[0m11:57:51.888508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237301502C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373E1EB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373DAC8CE0>]}
[0m11:57:51.889508 [debug] [MainThread]: Flushing usage events
[0m11:57:53.049246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:54.012758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A05603380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A05AD43B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A05EF3230>]}


============================== 11:58:54.018330 | 7213a00d-e2b9-45d7-af26-4c163bf23cda ==============================
[0m11:58:54.018330 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:58:54.019290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m11:58:55.253630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7213a00d-e2b9-45d7-af26-4c163bf23cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A14E7EFF0>]}
[0m11:58:55.331607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7213a00d-e2b9-45d7-af26-4c163bf23cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A12AD0590>]}
[0m11:58:55.333575 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:58:55.908904 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:58:56.127114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:56.127114 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\source.yml
[0m11:58:56.603891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7213a00d-e2b9-45d7-af26-4c163bf23cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A1546D280>]}
[0m11:58:56.699497 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:58:56.705520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:58:56.741417 [error] [MainThread]: Encountered an error:
Found a cycle: model.DE_MINI_PROJECT.stg_country
[0m11:58:56.745530 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 341, in compile
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 572, in run
    self._runtime_initialize()
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.DE_MINI_PROJECT.stg_country

[0m11:58:56.747693 [debug] [MainThread]: Command `dbt compile` failed at 11:58:56.747693 after 2.95 seconds
[0m11:58:56.748738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A05603380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A15350B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A150D0350>]}
[0m11:58:56.748738 [debug] [MainThread]: Flushing usage events
[0m11:58:57.658803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:31.148076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA50C9EDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5115E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4E9E0B00>]}


============================== 11:59:31.154505 | dd51b36b-5a91-462b-8900-eb429ffa575d ==============================
[0m11:59:31.154505 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:59:31.155504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:59:32.372609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd51b36b-5a91-462b-8900-eb429ffa575d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5135BC20>]}
[0m11:59:32.451863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd51b36b-5a91-462b-8900-eb429ffa575d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5D9CAF00>]}
[0m11:59:32.451863 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:59:33.048287 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:59:33.282243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:33.282243 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_country.sql
[0m11:59:33.614882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd51b36b-5a91-462b-8900-eb429ffa575d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5EAAAB40>]}
[0m11:59:33.709370 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:59:33.720413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:59:33.740741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd51b36b-5a91-462b-8900-eb429ffa575d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5E7FF530>]}
[0m11:59:33.740741 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 473 macros
[0m11:59:33.740741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd51b36b-5a91-462b-8900-eb429ffa575d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5E594530>]}
[0m11:59:33.756435 [info ] [MainThread]: 
[0m11:59:33.756435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:59:33.756435 [info ] [MainThread]: 
[0m11:59:33.756435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:59:33.756435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m11:59:33.882544 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m11:59:33.898225 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m11:59:33.898225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:35.392342 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.494 seconds
[0m11:59:35.395362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m11:59:35.398362 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m11:59:35.399360 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m11:59:35.641047 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.256 seconds
[0m11:59:35.656842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd51b36b-5a91-462b-8900-eb429ffa575d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA5E962450>]}
[0m11:59:35.656842 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.int_customers
[0m11:59:35.656842 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.int_customers'
[0m11:59:35.656842 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.int_customers
[0m11:59:35.672606 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.int_customers"
[0m11:59:35.672606 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.int_customers
[0m11:59:35.672606 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.int_customers
[0m11:59:35.672606 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m11:59:35.672606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.int_customers, now model.DE_MINI_PROJECT.stg_customers)
[0m11:59:35.672606 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m11:59:35.680567 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m11:59:35.682577 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m11:59:35.682577 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m11:59:35.682577 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m11:59:35.682577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m11:59:35.682577 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m11:59:35.688444 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m11:59:35.688444 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m11:59:35.688444 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m11:59:35.688444 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m11:59:35.688444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m11:59:35.688444 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m11:59:35.688444 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m11:59:35.688444 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m11:59:35.688444 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m11:59:35.688444 [debug] [Thread-1 (]: Began running node seed.DE_MINI_PROJECT.country_region
[0m11:59:35.688444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now seed.DE_MINI_PROJECT.country_region)
[0m11:59:35.688444 [debug] [Thread-1 (]: Began compiling node seed.DE_MINI_PROJECT.country_region
[0m11:59:35.688444 [debug] [Thread-1 (]: Began executing node seed.DE_MINI_PROJECT.country_region
[0m11:59:35.688444 [debug] [Thread-1 (]: Finished running node seed.DE_MINI_PROJECT.country_region
[0m11:59:35.688444 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_country
[0m11:59:35.688444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.DE_MINI_PROJECT.country_region, now model.DE_MINI_PROJECT.stg_country)
[0m11:59:35.704502 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_country
[0m11:59:35.704502 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_country"
[0m11:59:35.704502 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_country
[0m11:59:35.704502 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_country
[0m11:59:35.710119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:35.710119 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m11:59:35.710119 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m11:59:36.035165 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_country' was properly closed.
[0m11:59:36.046681 [debug] [MainThread]: Command end result
[0m11:59:36.062490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m11:59:36.062490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m11:59:36.078277 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m11:59:36.078277 [debug] [MainThread]: Command `dbt compile` succeeded at 11:59:36.078277 after 5.15 seconds
[0m11:59:36.078277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA515B4E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA51136E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA51135BB0>]}
[0m11:59:36.078277 [debug] [MainThread]: Flushing usage events
[0m11:59:36.969810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:32.333936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020646B574A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206460BC140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206460BC170>]}


============================== 12:00:32.349859 | b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37 ==============================
[0m12:00:32.349859 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:00:32.349859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_country', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:00:33.550767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020653499EB0>]}
[0m12:00:33.627527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206513F1A00>]}
[0m12:00:33.627527 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:00:34.213664 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:00:34.420678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:34.420678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:34.468580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020653883E60>]}
[0m12:00:34.579668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:00:34.579668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:00:34.611526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020653C358B0>]}
[0m12:00:34.611526 [info ] [MainThread]: Found 5 models, 1 seed, 3 sources, 473 macros
[0m12:00:34.627248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020653A205C0>]}
[0m12:00:34.627248 [info ] [MainThread]: 
[0m12:00:34.627248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:34.627248 [info ] [MainThread]: 
[0m12:00:34.627248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:00:34.627248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:00:34.760158 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:00:34.760158 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:00:34.760158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:36.752335 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.990 seconds
[0m12:00:36.752335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m12:00:36.768364 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:00:36.768364 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:00:36.768364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:37.801968 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.028 seconds
[0m12:00:37.808041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:00:37.821362 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:00:37.821362 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:00:38.033941 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.211 seconds
[0m12:00:38.033941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206536FDD30>]}
[0m12:00:38.033941 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_country
[0m12:00:38.033941 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_country ............................... [RUN]
[0m12:00:38.033941 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_country'
[0m12:00:38.033941 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_country
[0m12:00:38.045506 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_country"
[0m12:00:38.045506 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_country
[0m12:00:38.080659 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_country"
[0m12:00:38.080659 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_country"
[0m12:00:38.095820 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_country: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_country"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_country
         as
        (select * from DE_MINI_PROJECT.RAW.country_region
        );
[0m12:00:38.095820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:39.490415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.397 seconds
[0m12:00:39.506548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6aa88e3-2b20-4d7a-a45b-bd9ca6fe4d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020646001220>]}
[0m12:00:39.506548 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_country .......................... [[32mSUCCESS 1[0m in 1.47s]
[0m12:00:39.522713 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_country
[0m12:00:39.522713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:39.522713 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:00:39.522713 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:00:39.837487 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m12:00:39.837487 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m12:00:40.165686 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_country' was left open.
[0m12:00:40.165686 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_country: Close
[0m12:00:40.515172 [info ] [MainThread]: 
[0m12:00:40.516465 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m12:00:40.518191 [debug] [MainThread]: Command end result
[0m12:00:40.537700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:00:40.537700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:00:40.556394 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:00:40.557394 [info ] [MainThread]: 
[0m12:00:40.557394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:40.557394 [info ] [MainThread]: 
[0m12:00:40.557394 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:00:40.557394 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:40.557394 after 8.42 seconds
[0m12:00:40.557394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020646465EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206448DF3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020644914470>]}
[0m12:00:40.557394 [debug] [MainThread]: Flushing usage events
[0m12:00:41.484345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:48.943847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA6110530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA667EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA667EE40>]}


============================== 12:14:48.943847 | 729860c1-359d-4fcd-a070-9ae5b24b9819 ==============================
[0m12:14:48.943847 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:14:48.943847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m intermediate_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:14:52.838327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB349E1B0>]}
[0m12:14:52.916771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB1038560>]}
[0m12:14:52.916771 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:14:53.658847 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:14:53.779008 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:14:53.779008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA631D700>]}
[0m12:14:56.860038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB4ACD790>]}
[0m12:14:56.947959 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:14:56.963702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:14:57.011193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB4A7D5B0>]}
[0m12:14:57.011193 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:14:57.011193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA44C0590>]}
[0m12:14:57.011193 [info ] [MainThread]: 
[0m12:14:57.011193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:57.011193 [info ] [MainThread]: 
[0m12:14:57.011193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:57.011193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:15:00.370958 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:15:00.370958 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:15:00.370958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:01.818691 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.436 seconds
[0m12:15:01.825626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT, now create_DE_MINI_PROJECT_intermediate)
[0m12:15:01.829888 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT"
schema: "intermediate"
"
[0m12:15:01.839904 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_intermediate"
[0m12:15:01.839904 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_intermediate"} */
create schema if not exists DE_MINI_PROJECT.intermediate
[0m12:15:02.057916 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.216 seconds
[0m12:15:02.060440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m12:15:02.077065 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:15:02.077065 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:15:02.077065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:03.067017 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.988 seconds
[0m12:15:03.073014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m12:15:03.078010 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:15:03.078010 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:15:03.284119 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m12:15:03.291113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m12:15:03.297297 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:15:03.298301 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:15:03.470413 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.180 seconds
[0m12:15:03.470413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB4D6CE90>]}
[0m12:15:03.484824 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:03.484824 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:15:03.486084 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:15:03.487127 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:03.634946 [debug] [Thread-1 (]: Compilation Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:15:03.638053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '729860c1-359d-4fcd-a070-9ae5b24b9819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB4E062D0>]}
[0m12:15:03.638053 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.intermediate_customers ...... [[31mERROR[0m in 0.15s]
[0m12:15:03.640054 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:03.640054 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.intermediate_customers' to be skipped because of status 'error'.  Reason: Compilation Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:15:03.643439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:03.643439 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_intermediate' was left open.
[0m12:15:03.643439 [debug] [MainThread]: On create_DE_MINI_PROJECT_intermediate: Close
[0m12:15:03.963714 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m12:15:03.963714 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m12:15:04.286556 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was properly closed.
[0m12:15:04.286556 [info ] [MainThread]: 
[0m12:15:04.294748 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m12:15:04.298916 [debug] [MainThread]: Command end result
[0m12:15:04.335572 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:15:04.337607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:15:04.346472 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:15:04.346803 [info ] [MainThread]: 
[0m12:15:04.346803 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:15:04.346803 [info ] [MainThread]: 
[0m12:15:04.346803 [error] [MainThread]:   Compilation Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:15:04.346803 [info ] [MainThread]: 
[0m12:15:04.346803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:15:04.354288 [debug] [MainThread]: Command `dbt run` failed at 12:15:04.346803 after 15.66 seconds
[0m12:15:04.354288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB38B1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CB3866330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA664FEF0>]}
[0m12:15:04.355332 [debug] [MainThread]: Flushing usage events
[0m12:15:05.246197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:36.252594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1B5D60C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1B5D50D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1B5D6FC0>]}


============================== 12:15:36.259693 | 4e87fc69-b8cf-45cf-b464-635c7b7a34c5 ==============================
[0m12:15:36.259693 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:15:36.259693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m intermediate_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:37.448161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C279BA540>]}
[0m12:15:37.525191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2816DB50>]}
[0m12:15:37.525191 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:15:38.110857 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:15:38.324239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:38.324239 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\intermediate_customers.sql
[0m12:15:38.668288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C28827320>]}
[0m12:15:38.763368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:15:38.763368 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:15:38.795240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2851CD40>]}
[0m12:15:38.810969 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:15:38.810969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C28725F10>]}
[0m12:15:38.810969 [info ] [MainThread]: 
[0m12:15:38.810969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:38.810969 [info ] [MainThread]: 
[0m12:15:38.810969 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:15:38.810969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:15:38.927761 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:15:38.927761 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:15:38.927761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:40.272610 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.338 seconds
[0m12:15:40.288675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m12:15:40.299686 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:15:40.301694 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:15:40.301694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:41.274661 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.986 seconds
[0m12:15:41.290476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:15:41.306656 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:15:41.306656 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:15:41.517103 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m12:15:41.517103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m12:15:41.517103 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:15:41.517103 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:15:41.713320 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.203 seconds
[0m12:15:41.729454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2832D2B0>]}
[0m12:15:41.729454 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:41.745410 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:15:41.745410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:15:41.745410 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:41.769560 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:15:41.770560 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:41.797182 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:15:41.812432 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:15:41.813098 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMERNAME AS CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m12:15:41.813098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:42.953763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff35-3201-7e57-000c-3d5a0001f71a
[0m12:15:42.953763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'CUSTOMERNAME'
[0m12:15:42.953763 [debug] [Thread-1 (]: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:15:42.969616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e87fc69-b8cf-45cf-b464-635c7b7a34c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1AA89340>]}
[0m12:15:42.969616 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.intermediate_customers ...... [[31mERROR[0m in 1.21s]
[0m12:15:42.969616 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:15:42.969616 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.intermediate_customers' to be skipped because of status 'error'.  Reason: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql.
[0m12:15:42.969616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:42.969616 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:15:42.976671 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:15:43.295960 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m12:15:43.295960 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m12:15:43.635657 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was left open.
[0m12:15:43.637684 [debug] [MainThread]: On model.DE_MINI_PROJECT.intermediate_customers: Close
[0m12:15:43.959837 [info ] [MainThread]: 
[0m12:15:43.959837 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m12:15:43.959837 [debug] [MainThread]: Command end result
[0m12:15:43.992663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:15:43.996681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:15:44.005217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:15:44.005217 [info ] [MainThread]: 
[0m12:15:44.021723 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:15:44.021723 [info ] [MainThread]: 
[0m12:15:44.023731 [error] [MainThread]:   Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:15:44.036452 [info ] [MainThread]: 
[0m12:15:44.038460 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:15:44.038460 [debug] [MainThread]: Command `dbt run` failed at 12:15:44.038460 after 7.99 seconds
[0m12:15:44.038460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1B3965A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C179EF800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C1AB3C1A0>]}
[0m12:15:44.038460 [debug] [MainThread]: Flushing usage events
[0m12:15:45.315481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:15.463780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C305785C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C305787590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C305784290>]}


============================== 12:16:15.463780 | 03578815-cdaa-433a-8e74-e28f71f91a7a ==============================
[0m12:16:15.463780 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:16:15.479271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m intermediate_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:17.028438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C305784B00>]}
[0m12:16:17.107549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3123461E0>]}
[0m12:16:17.107549 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:16:17.716557 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:16:17.977830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:17.977830 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\intermediate_customers.sql
[0m12:16:18.317121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3129B73B0>]}
[0m12:16:18.417260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:16:18.417260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:16:18.468357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C312990BC0>]}
[0m12:16:18.469357 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:16:18.470033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3129ADEB0>]}
[0m12:16:18.472077 [info ] [MainThread]: 
[0m12:16:18.472771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:18.473780 [info ] [MainThread]: 
[0m12:16:18.474780 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:18.475766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:16:18.603661 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:16:18.603661 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:16:18.603661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:20.206750 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.607 seconds
[0m12:16:20.206750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:16:20.222477 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:16:20.222477 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:16:20.222477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:21.211285 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.980 seconds
[0m12:16:21.215639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m12:16:21.219654 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:16:21.219654 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:16:21.430973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.211 seconds
[0m12:16:21.435004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:16:21.437012 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:16:21.437012 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:16:22.104838 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.680 seconds
[0m12:16:22.121493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C31270B530>]}
[0m12:16:22.121493 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:22.121493 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:16:22.126556 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:16:22.126556 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:22.138681 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:16:22.139689 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:22.173698 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:16:22.173698 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:16:22.173698 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMERNAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMERNAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m12:16:22.173698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:23.169209 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff36-3201-7d7b-000c-3d5a000222fa
[0m12:16:23.170210 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'CUSTOMERNAME'
[0m12:16:23.177514 [debug] [Thread-1 (]: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:16:23.181515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03578815-cdaa-433a-8e74-e28f71f91a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C304C2D4F0>]}
[0m12:16:23.182551 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.intermediate_customers ...... [[31mERROR[0m in 1.05s]
[0m12:16:23.183512 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:23.184551 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.intermediate_customers' to be skipped because of status 'error'.  Reason: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql.
[0m12:16:23.186387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:23.187604 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:16:23.188295 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:16:23.518357 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m12:16:23.519355 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m12:16:23.836720 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was left open.
[0m12:16:23.836720 [debug] [MainThread]: On model.DE_MINI_PROJECT.intermediate_customers: Close
[0m12:16:24.184702 [info ] [MainThread]: 
[0m12:16:24.184702 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m12:16:24.187254 [debug] [MainThread]: Command end result
[0m12:16:24.210712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:16:24.210712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:16:24.224643 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:16:24.225652 [info ] [MainThread]: 
[0m12:16:24.226537 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:16:24.227446 [info ] [MainThread]: 
[0m12:16:24.228454 [error] [MainThread]:   Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:16:24.229457 [info ] [MainThread]: 
[0m12:16:24.229457 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:24.231840 [debug] [MainThread]: Command `dbt run` failed at 12:16:24.230487 after 8.97 seconds
[0m12:16:24.231840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3035484D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3035483B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3035483E0>]}
[0m12:16:24.232885 [debug] [MainThread]: Flushing usage events
[0m12:16:25.157770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:39.885318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB1156060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB11556D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB1157D10>]}


============================== 12:16:39.885318 | 9432cc1a-ed0d-4d0d-8bed-78a817b4704f ==============================
[0m12:16:39.885318 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:16:39.885318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m intermediate_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:41.084257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBDAA8710>]}
[0m12:16:41.159623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBDDC6C00>]}
[0m12:16:41.161630 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:16:41.744621 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:16:41.971473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:41.971473 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\intermediate_customers.sql
[0m12:16:42.298261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBE3A3170>]}
[0m12:16:42.393447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:16:42.409226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:16:42.445774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBE36CCB0>]}
[0m12:16:42.445774 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:16:42.445774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCBE32F2F0>]}
[0m12:16:42.449050 [info ] [MainThread]: 
[0m12:16:42.449050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:42.449050 [info ] [MainThread]: 
[0m12:16:42.449050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:42.449050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:16:42.574320 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:16:42.574320 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:16:42.574320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:44.121564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.549 seconds
[0m12:16:44.137697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m12:16:44.153609 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:16:44.153609 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:16:44.153609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:45.260576 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.104 seconds
[0m12:16:45.263155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m12:16:45.263155 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:16:45.263155 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:16:45.460445 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.194 seconds
[0m12:16:45.467539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m12:16:45.476347 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:16:45.476347 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:16:45.662039 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.186 seconds
[0m12:16:45.666632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAE5A1310>]}
[0m12:16:45.666632 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:45.666632 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:16:45.666632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:16:45.666632 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:45.682743 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:16:45.684667 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:45.723130 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:16:45.725129 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:16:45.725129 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMERNAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m12:16:45.726132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:46.685674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff36-3201-7d7b-000c-3d5a00022302
[0m12:16:46.701321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'C.CUSTOMERNAME'
[0m12:16:46.701321 [debug] [Thread-1 (]: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'C.CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:16:46.701321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9432cc1a-ed0d-4d0d-8bed-78a817b4704f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB05FD5E0>]}
[0m12:16:46.701321 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.intermediate_customers ...... [[31mERROR[0m in 1.03s]
[0m12:16:46.701321 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:16:46.701321 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.intermediate_customers' to be skipped because of status 'error'.  Reason: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'C.CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql.
[0m12:16:46.701321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:46.701321 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:16:46.701321 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:16:47.037365 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:16:47.037365 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:16:47.356661 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was left open.
[0m12:16:47.356661 [debug] [MainThread]: On model.DE_MINI_PROJECT.intermediate_customers: Close
[0m12:16:47.685886 [info ] [MainThread]: 
[0m12:16:47.685886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m12:16:47.685886 [debug] [MainThread]: Command end result
[0m12:16:47.719763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:16:47.719763 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:16:47.731590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:16:47.731590 [info ] [MainThread]: 
[0m12:16:47.731590 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:16:47.731590 [info ] [MainThread]: 
[0m12:16:47.731590 [error] [MainThread]:   Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'C.CUSTOMERNAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:16:47.731590 [info ] [MainThread]: 
[0m12:16:47.731590 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:16:47.731590 [debug] [MainThread]: Command `dbt run` failed at 12:16:47.731590 after 8.05 seconds
[0m12:16:47.731590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB0C62E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB0FEF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB06ECF80>]}
[0m12:16:47.741316 [debug] [MainThread]: Flushing usage events
[0m12:16:48.674382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:10.024325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175A6ACBCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175A4213530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175A6942E70>]}


============================== 12:17:10.024325 | 0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb ==============================
[0m12:17:10.024325 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:17:10.024325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m intermediate_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:11.215767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B3C2E270>]}
[0m12:17:11.294136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175A6C36D20>]}
[0m12:17:11.294136 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:17:11.892865 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:17:12.114068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:17:12.114068 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\intermediate_customers.sql
[0m12:17:12.455768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B41C73B0>]}
[0m12:17:12.556583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:17:12.560601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:17:12.597852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B3EBC3E0>]}
[0m12:17:12.597852 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:17:12.597852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B3F4DD60>]}
[0m12:17:12.601735 [info ] [MainThread]: 
[0m12:17:12.601735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:12.601735 [info ] [MainThread]: 
[0m12:17:12.601735 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:12.601735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:17:12.731872 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:17:12.731872 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:17:12.732872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:14.128299 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.398 seconds
[0m12:17:14.128299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:17:14.144104 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:17:14.144104 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:17:14.144104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:15.078443 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.929 seconds
[0m12:17:15.081956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m12:17:15.085972 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:17:15.085972 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:17:15.269667 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.186 seconds
[0m12:17:15.273493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m12:17:15.277509 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:17:15.277509 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:17:15.478863 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.202 seconds
[0m12:17:15.482900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B3F0EF00>]}
[0m12:17:15.486658 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:17:15.486658 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:17:15.486658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:17:15.486658 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:17:15.486658 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:17:15.486658 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m12:17:15.539136 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:17:15.541124 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:17:15.542161 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m12:17:15.542161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:17.423404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.895 seconds
[0m12:17:17.455309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1fe2ec-d807-4b4d-9449-8e799e4c9dcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175A64493D0>]}
[0m12:17:17.455309 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.intermediate_customers .......... [[32mSUCCESS 1[0m in 1.97s]
[0m12:17:17.455309 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:17:17.455309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:17.455309 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:17:17.470996 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:17:17.806196 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:17:17.808206 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:17:18.124449 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was left open.
[0m12:17:18.124449 [debug] [MainThread]: On model.DE_MINI_PROJECT.intermediate_customers: Close
[0m12:17:18.448268 [info ] [MainThread]: 
[0m12:17:18.448268 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m12:17:18.448268 [debug] [MainThread]: Command end result
[0m12:17:18.490043 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:17:18.494511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:17:18.500731 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:17:18.500731 [info ] [MainThread]: 
[0m12:17:18.500731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:18.500731 [info ] [MainThread]: 
[0m12:17:18.500731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:18.500731 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:18.500731 after 8.69 seconds
[0m12:17:18.500731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175A6C0A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B3C57FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B55DCBF0>]}
[0m12:17:18.507943 [debug] [MainThread]: Flushing usage events
[0m12:17:19.415862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:12.200266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B7064530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B70677A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B70657C0>]}


============================== 12:26:12.206301 | fc350982-d164-4970-a2a9-71657b65fa01 ==============================
[0m12:26:12.206301 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:26:12.207266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m intermediate_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:26:16.053683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115C3CEE1B0>]}
[0m12:26:16.132854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B4D15400>]}
[0m12:26:16.132854 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:26:16.865175 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:26:18.475286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:26:18.475286 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m12:26:18.475286 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\intermediate_customers.sql
[0m12:26:18.822995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115C4287860>]}
[0m12:26:18.922939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:26:18.941663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:26:18.979609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115C3F7EB40>]}
[0m12:26:18.982655 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:26:18.982655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115C3DA73B0>]}
[0m12:26:18.982655 [info ] [MainThread]: 
[0m12:26:18.982655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:18.982655 [info ] [MainThread]: 
[0m12:26:18.982655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:18.989068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:26:22.226611 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:26:22.226611 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:26:22.226611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:23.691600 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.468 seconds
[0m12:26:23.707481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:26:23.723586 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:26:23.723586 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:26:23.723586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:24.710566 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.981 seconds
[0m12:26:24.710566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m12:26:24.710566 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:26:24.710566 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:26:24.931219 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.211 seconds
[0m12:26:24.934178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m12:26:24.936781 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:26:24.936781 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:26:25.146253 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m12:26:25.156721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B44B11C0>]}
[0m12:26:25.161934 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:25.161934 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:26:25.161934 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:26:25.161934 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:25.161934 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:26:25.161934 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:25.212733 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:26:25.214745 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:26:25.215732 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME AS C
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m12:26:25.215732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:26.404631 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff40-3201-7e57-000c-3d5a0001f7d6
[0m12:26:26.404631 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'C.CUSTOMER_NAME'
[0m12:26:26.420351 [debug] [Thread-1 (]: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:26:26.420351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc350982-d164-4970-a2a9-71657b65fa01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B6519430>]}
[0m12:26:26.420351 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.intermediate_customers ...... [[31mERROR[0m in 1.26s]
[0m12:26:26.436462 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:26.436462 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.intermediate_customers' to be skipped because of status 'error'.  Reason: Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql.
[0m12:26:26.440479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:26.440479 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:26:26.440479 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:26:26.763203 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:26:26.763203 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:26:27.088540 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was left open.
[0m12:26:27.088540 [debug] [MainThread]: On model.DE_MINI_PROJECT.intermediate_customers: Close
[0m12:26:27.427837 [info ] [MainThread]: 
[0m12:26:27.427837 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m12:26:27.427837 [debug] [MainThread]: Command end result
[0m12:26:27.459495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:26:27.462483 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:26:27.463482 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:26:27.463482 [info ] [MainThread]: 
[0m12:26:27.463482 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:26:27.463482 [info ] [MainThread]: 
[0m12:26:27.472520 [error] [MainThread]:   Database Error in model intermediate_customers (models\intermediate\intermediate_customers.sql)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\intermediate_customers.sql
[0m12:26:27.473530 [info ] [MainThread]: 
[0m12:26:27.474530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:26:27.475331 [debug] [MainThread]: Command `dbt run` failed at 12:26:27.475331 after 15.53 seconds
[0m12:26:27.477185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B4E2C3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B4E2C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115B4E2C0E0>]}
[0m12:26:27.478231 [debug] [MainThread]: Flushing usage events
[0m12:26:28.753732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:48.775529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC5426D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC54255B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC54259D0>]}


============================== 12:26:48.791608 | 1e8032cb-c14f-46fc-bef0-12188b3cc440 ==============================
[0m12:26:48.791608 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:26:48.791608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m intermediate_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:49.984488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECFC294F0>]}
[0m12:26:50.061104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CED0CA0DA0>]}
[0m12:26:50.063111 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:26:50.700322 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:26:50.960470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:50.963160 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\intermediate_customers.sql
[0m12:26:51.348073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CED2667440>]}
[0m12:26:51.446510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:26:51.450614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:26:51.477277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CED235C980>]}
[0m12:26:51.477277 [info ] [MainThread]: Found 5 models, 1 seed, 4 sources, 473 macros
[0m12:26:51.477277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CED2520440>]}
[0m12:26:51.492022 [info ] [MainThread]: 
[0m12:26:51.493030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:51.493030 [info ] [MainThread]: 
[0m12:26:51.493030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:51.493030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:26:51.612900 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:26:51.612900 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:26:51.612900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:52.997068 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.375 seconds
[0m12:26:52.997068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m12:26:53.012999 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:26:53.012999 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:26:53.012999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:53.999659 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.981 seconds
[0m12:26:53.999659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:26:53.999659 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:26:53.999659 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:26:54.195637 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.195 seconds
[0m12:26:54.211764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m12:26:54.215311 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:26:54.215311 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:26:54.421029 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.198 seconds
[0m12:26:54.423041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CED2510EF0>]}
[0m12:26:54.423041 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:54.423041 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.intermediate_customers ............... [RUN]
[0m12:26:54.423041 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m12:26:54.423041 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:54.439641 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:26:54.440885 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:54.479147 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:26:54.481109 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m12:26:54.482145 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m12:26:54.482145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:55.891608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.410 seconds
[0m12:26:55.913222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e8032cb-c14f-46fc-bef0-12188b3cc440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC28073B0>]}
[0m12:26:55.928994 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.intermediate_customers .......... [[32mSUCCESS 1[0m in 1.49s]
[0m12:26:55.928994 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m12:26:55.928994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:55.928994 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:26:55.928994 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:26:56.265645 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m12:26:56.265645 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m12:26:56.588826 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.intermediate_customers' was left open.
[0m12:26:56.588826 [debug] [MainThread]: On model.DE_MINI_PROJECT.intermediate_customers: Close
[0m12:26:56.926992 [info ] [MainThread]: 
[0m12:26:56.926992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m12:26:56.926992 [debug] [MainThread]: Command end result
[0m12:26:56.956419 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:26:56.959463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:26:56.959463 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:26:56.959463 [info ] [MainThread]: 
[0m12:26:56.959463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:56.969059 [info ] [MainThread]: 
[0m12:26:56.970089 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:26:56.972594 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:56.972086 after 8.39 seconds
[0m12:26:56.972594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC4F8EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC4E0F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CEC50F20C0>]}
[0m12:26:56.972594 [debug] [MainThread]: Flushing usage events
[0m12:26:57.849774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:29.842193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261545976B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026154596EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026154595940>]}


============================== 12:29:29.854443 | 065e0685-cdfc-4fe0-b654-e8ef760529e5 ==============================
[0m12:29:29.854443 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:29:29.855506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi1', 'send_anonymous_usage_stats': 'True'}
[0m12:29:31.882389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261606EAF00>]}
[0m12:29:31.961964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261611A1340>]}
[0m12:29:31.963929 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:29:32.554691 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:29:32.824534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:29:32.824534 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m12:29:33.174701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261616C5760>]}
[0m12:29:33.276588 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:29:33.292681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:29:33.342589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026161790320>]}
[0m12:29:33.342589 [info ] [MainThread]: Found 6 models, 1 seed, 4 sources, 473 macros
[0m12:29:33.357535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026161580AA0>]}
[0m12:29:33.359725 [info ] [MainThread]: 
[0m12:29:33.359725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:33.359725 [info ] [MainThread]: 
[0m12:29:33.362879 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:33.363877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:29:33.510533 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:29:33.511439 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:29:33.511439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:35.190240 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.681 seconds
[0m12:29:35.190240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m12:29:35.212712 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:29:35.212712 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:29:35.212712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:36.264436 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.050 seconds
[0m12:29:36.266465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m12:29:36.269437 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:29:36.269437 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:29:36.471071 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m12:29:36.476040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m12:29:36.476040 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:29:36.476040 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:29:36.723906 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.243 seconds
[0m12:29:36.726930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026162C7AEA0>]}
[0m12:29:36.730423 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m12:29:36.731422 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m12:29:36.732426 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m12:29:36.732426 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m12:29:36.734184 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m12:29:36.745312 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m12:29:36.795230 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m12:29:36.834197 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m12:29:36.834197 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        MIN(payment_month) AS first_transaction_month,
        MAX(payment_month) AS last_transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
monthly_activity AS (
    SELECT 
        CUSTOMER_ID,
        payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, payment_month
),
new_customers AS (
    SELECT 
        payment_month,
        COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
    FROM monthly_activity ma
    JOIN customer_activity ca
        ON ma.CUSTOMER_ID = ca.CUSTOMER_ID
        AND ma.payment_month = ca.first_transaction_month
    GROUP BY payment_month
),
churned_customers AS (
    SELECT 
        ma.payment_month,
        COUNT(DISTINCT ma.CUSTOMER_ID) AS churned_customers_count
    FROM monthly_activity ma
    LEFT JOIN monthly_activity next_month_activity
        ON ma.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 1, ma.payment_month) = next_month_activity.payment_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ma.payment_month
)
SELECT 
    COALESCE(nc.payment_month, cc.payment_month) AS payment_month,
    COALESCE(new_customers_count, 0) AS new_customers,
    COALESCE(churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.payment_month = cc.payment_month
ORDER BY payment_month;
[0m12:29:36.834197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:29:37.814969 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff43-3201-7d7b-000c-3d5a000223ee
[0m12:29:37.814969 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 22 unexpected ';'.
[0m12:29:37.830767 [debug] [Thread-1 (]: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 22 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m12:29:37.830767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065e0685-cdfc-4fe0-b654-e8ef760529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026153A492B0>]}
[0m12:29:37.830767 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi1 ........................ [[31mERROR[0m in 1.10s]
[0m12:29:37.830767 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m12:29:37.830767 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi1' to be skipped because of status 'error'.  Reason: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 22 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql.
[0m12:29:37.830767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:37.830767 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:29:37.830767 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:29:38.167305 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m12:29:38.167305 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m12:29:38.481043 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m12:29:38.481043 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m12:29:38.815339 [info ] [MainThread]: 
[0m12:29:38.815339 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m12:29:38.815339 [debug] [MainThread]: Command end result
[0m12:29:38.853357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:29:38.857471 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:29:38.867148 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:29:38.867503 [info ] [MainThread]: 
[0m12:29:38.867503 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:29:38.867503 [info ] [MainThread]: 
[0m12:29:38.867503 [error] [MainThread]:   Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 22 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m12:29:38.867503 [info ] [MainThread]: 
[0m12:29:38.867503 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:29:38.875972 [debug] [MainThread]: Command `dbt run` failed at 12:29:38.875972 after 9.25 seconds
[0m12:29:38.875972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026153E2F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026153F7EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261606EB200>]}
[0m12:29:38.876971 [debug] [MainThread]: Flushing usage events
[0m12:29:40.322659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:58.599093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235EA3ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235EA3DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235EA3CFB0>]}


============================== 12:29:58.599093 | 7e5b7223-a7f9-43f0-8caa-920034f6dde6 ==============================
[0m12:29:58.599093 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:29:58.599093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi1', 'send_anonymous_usage_stats': 'True'}
[0m12:29:59.826134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236B12ACC0>]}
[0m12:29:59.898206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236B2BFF80>]}
[0m12:29:59.898206 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:30:00.511862 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:30:00.734184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:00.734184 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m12:30:01.077645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236C163890>]}
[0m12:30:01.173149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:30:01.173149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:30:01.220935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236BDEEB10>]}
[0m12:30:01.220935 [info ] [MainThread]: Found 6 models, 1 seed, 4 sources, 473 macros
[0m12:30:01.220935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236C035AF0>]}
[0m12:30:01.220935 [info ] [MainThread]: 
[0m12:30:01.220935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:01.220935 [info ] [MainThread]: 
[0m12:30:01.220935 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:01.220935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:30:01.356441 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:30:01.356441 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:30:01.356441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:02.796102 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.437 seconds
[0m12:30:02.810224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:30:02.810224 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:30:02.810224 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:30:02.810224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:03.830206 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.007 seconds
[0m12:30:03.830206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m12:30:03.830206 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:30:03.830206 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:30:04.041090 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m12:30:04.044517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:30:04.047179 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:30:04.047179 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:30:04.248684 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m12:30:04.252686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236D5AA900>]}
[0m12:30:04.256866 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m12:30:04.257914 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m12:30:04.259877 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m12:30:04.259877 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m12:30:04.274461 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m12:30:04.276360 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m12:30:04.317143 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m12:30:04.320143 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m12:30:04.321108 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        MIN(payment_month) AS first_transaction_month,
        MAX(payment_month) AS last_transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
monthly_activity AS (
    SELECT 
        CUSTOMER_ID,
        payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, payment_month
),
new_customers AS (
    SELECT 
        payment_month,
        COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
    FROM monthly_activity ma
    JOIN customer_activity ca
        ON ma.CUSTOMER_ID = ca.CUSTOMER_ID
        AND ma.payment_month = ca.first_transaction_month
    GROUP BY payment_month
),
churned_customers AS (
    SELECT 
        ma.payment_month,
        COUNT(DISTINCT ma.CUSTOMER_ID) AS churned_customers_count
    FROM monthly_activity ma
    LEFT JOIN monthly_activity next_month_activity
        ON ma.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 1, ma.payment_month) = next_month_activity.payment_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ma.payment_month
)
SELECT 
    COALESCE(nc.payment_month, cc.payment_month) AS payment_month,
    COALESCE(new_customers_count, 0) AS new_customers,
    COALESCE(churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.payment_month = cc.payment_month
ORDER BY payment_month
        );
[0m12:30:04.322023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:30:05.504563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff44-3201-7e57-000c-3d5a0001f7e6
[0m12:30:05.506571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_ID'
[0m12:30:05.510585 [debug] [Thread-1 (]: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m12:30:05.512093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5b7223-a7f9-43f0-8caa-920034f6dde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235E389880>]}
[0m12:30:05.512093 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi1 ........................ [[31mERROR[0m in 1.25s]
[0m12:30:05.512093 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m12:30:05.512093 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi1' to be skipped because of status 'error'.  Reason: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql.
[0m12:30:05.512093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:05.512093 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:30:05.512093 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:30:05.850581 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m12:30:05.852591 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m12:30:06.176963 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m12:30:06.176963 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m12:30:06.514821 [info ] [MainThread]: 
[0m12:30:06.514821 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m12:30:06.514821 [debug] [MainThread]: Command end result
[0m12:30:06.548348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:30:06.557310 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:30:06.560320 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:30:06.560320 [info ] [MainThread]: 
[0m12:30:06.560320 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:30:06.560320 [info ] [MainThread]: 
[0m12:30:06.560320 [error] [MainThread]:   Database Error in model kpi1 (models\intermediate\kpi1.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m12:30:06.560320 [info ] [MainThread]: 
[0m12:30:06.560320 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:30:06.572075 [debug] [MainThread]: Command `dbt run` failed at 12:30:06.560320 after 8.18 seconds
[0m12:30:06.572075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235E418740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235E41BF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001236BC73590>]}
[0m12:30:06.573118 [debug] [MainThread]: Flushing usage events
[0m12:30:07.526297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:33.733424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC1255820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC070AD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC1257800>]}


============================== 12:31:33.745335 | 634c06a6-20e9-44e5-9564-0774753dd2aa ==============================
[0m12:31:33.745335 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:31:33.745335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:34.939450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECDB89EE0>]}
[0m12:31:35.023038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC073DDF0>]}
[0m12:31:35.024035 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:31:35.592963 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:31:35.831273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:35.833283 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m12:31:36.167626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECE4835C0>]}
[0m12:31:36.259296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:31:36.273874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:31:36.306937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECE1BC2C0>]}
[0m12:31:36.306937 [info ] [MainThread]: Found 6 models, 1 seed, 4 sources, 473 macros
[0m12:31:36.306937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECE477DD0>]}
[0m12:31:36.317411 [info ] [MainThread]: 
[0m12:31:36.317411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:36.317411 [info ] [MainThread]: 
[0m12:31:36.317411 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:36.320813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:31:36.445905 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:31:36.445905 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:31:36.445905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:37.828852 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.391 seconds
[0m12:31:37.842859 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:31:37.858937 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:31:37.858937 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:31:37.858937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:38.883398 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.021 seconds
[0m12:31:38.891490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m12:31:38.898050 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:31:38.900067 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:31:39.105487 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.219 seconds
[0m12:31:39.121371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m12:31:39.121371 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:31:39.121371 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:31:39.331239 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m12:31:39.331239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECDF03020>]}
[0m12:31:39.331239 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m12:31:39.331239 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m12:31:39.331239 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m12:31:39.331239 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m12:31:39.350549 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m12:31:39.352414 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m12:31:39.390648 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m12:31:39.393651 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m12:31:39.394650 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        MIN(payment_month) AS first_transaction_month,
        MAX(payment_month) AS last_transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
monthly_activity AS (
    SELECT 
        CUSTOMER_ID,
        payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, payment_month
),
new_customers AS (
    SELECT 
        ma.payment_month,
        COUNT(DISTINCT ma.CUSTOMER_ID) AS new_customers_count
    FROM monthly_activity ma
    JOIN customer_activity ca
        ON ma.CUSTOMER_ID = ca.CUSTOMER_ID
        AND ma.payment_month = ca.first_transaction_month
    GROUP BY ma.payment_month
),
churned_customers AS (
    SELECT 
        ma.payment_month,
        COUNT(DISTINCT ma.CUSTOMER_ID) AS churned_customers_count
    FROM monthly_activity ma
    LEFT JOIN monthly_activity next_month_activity
        ON ma.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 1, ma.payment_month) = next_month_activity.payment_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ma.payment_month
)
SELECT 
    COALESCE(nc.payment_month, cc.payment_month) AS payment_month,
    COALESCE(nc.new_customers_count, 0) AS new_customers,
    COALESCE(cc.churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.payment_month = cc.payment_month
ORDER BY payment_month;
[0m12:31:39.394650 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:40.349615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff45-3201-7e56-000c-3d5a00023252
[0m12:31:40.349615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 22 unexpected ';'.
[0m12:31:40.349615 [debug] [Thread-1 (]: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 22 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m12:31:40.349615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634c06a6-20e9-44e5-9564-0774753dd2aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC0709100>]}
[0m12:31:40.349615 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi1 ........................ [[31mERROR[0m in 1.02s]
[0m12:31:40.349615 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m12:31:40.349615 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi1' to be skipped because of status 'error'.  Reason: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 22 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql.
[0m12:31:40.365304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:40.365304 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:31:40.365304 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:31:40.694717 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:31:40.694717 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:31:41.030788 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m12:31:41.030788 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m12:31:41.360205 [info ] [MainThread]: 
[0m12:31:41.361205 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m12:31:41.362994 [debug] [MainThread]: Command end result
[0m12:31:41.390825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:31:41.392825 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:31:41.401725 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:31:41.401725 [info ] [MainThread]: 
[0m12:31:41.403737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:41.404606 [info ] [MainThread]: 
[0m12:31:41.404606 [error] [MainThread]:   Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 22 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m12:31:41.404606 [info ] [MainThread]: 
[0m12:31:41.404606 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:41.409101 [debug] [MainThread]: Command `dbt run` failed at 12:31:41.404606 after 7.87 seconds
[0m12:31:41.409101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC1142FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EC122E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ECDEE34A0>]}
[0m12:31:41.410141 [debug] [MainThread]: Flushing usage events
[0m12:31:42.306629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:52.829100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D2F31F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D64D85F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D631C0B0>]}


============================== 12:31:52.829905 | e2ed0b7d-00f2-4f4c-8d90-814d6507561e ==============================
[0m12:31:52.829905 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:31:52.829905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi1', 'send_anonymous_usage_stats': 'True'}
[0m12:31:54.025139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D6777140>]}
[0m12:31:54.102658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D3EACA40>]}
[0m12:31:54.102658 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:31:54.683665 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:31:54.909105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:54.909105 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m12:31:55.233592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E39D3620>]}
[0m12:31:55.328656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:31:55.328656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:31:55.382063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E370E600>]}
[0m12:31:55.382063 [info ] [MainThread]: Found 6 models, 1 seed, 4 sources, 473 macros
[0m12:31:55.384070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D5713B90>]}
[0m12:31:55.386076 [info ] [MainThread]: 
[0m12:31:55.386076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:55.388082 [info ] [MainThread]: 
[0m12:31:55.388082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:55.390847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:31:55.518158 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:31:55.520170 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:31:55.520170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:56.904019 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.384 seconds
[0m12:31:56.904019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m12:31:56.920131 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:31:56.920131 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:31:56.920131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:57.892139 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.982 seconds
[0m12:31:57.908224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m12:31:57.924266 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:31:57.924266 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:31:58.119425 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.203 seconds
[0m12:31:58.136385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m12:31:58.141441 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:31:58.142442 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:31:58.346040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.207 seconds
[0m12:31:58.346040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220E4DF81A0>]}
[0m12:31:58.346040 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m12:31:58.346040 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m12:31:58.346040 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m12:31:58.346040 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m12:31:58.361747 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m12:31:58.361747 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m12:31:58.410045 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m12:31:58.414046 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m12:31:58.414046 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        MIN(payment_month) AS first_transaction_month,
        MAX(payment_month) AS last_transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
monthly_activity AS (
    SELECT 
        CUSTOMER_ID,
        payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, payment_month
),
new_customers AS (
    SELECT 
        ma.payment_month,
        COUNT(DISTINCT ma.CUSTOMER_ID) AS new_customers_count
    FROM monthly_activity ma
    JOIN customer_activity ca
        ON ma.CUSTOMER_ID = ca.CUSTOMER_ID
        AND ma.payment_month = ca.first_transaction_month
    GROUP BY ma.payment_month
),
churned_customers AS (
    SELECT 
        ma.payment_month,
        COUNT(DISTINCT ma.CUSTOMER_ID) AS churned_customers_count
    FROM monthly_activity ma
    LEFT JOIN monthly_activity next_month_activity
        ON ma.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 1, ma.payment_month) = next_month_activity.payment_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ma.payment_month
)
SELECT 
    COALESCE(nc.payment_month, cc.payment_month) AS payment_month,
    COALESCE(nc.new_customers_count, 0) AS new_customers,
    COALESCE(cc.churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.payment_month = cc.payment_month
ORDER BY payment_month
        );
[0m12:31:58.415046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:59.883755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.469 seconds
[0m12:31:59.913143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ed0b7d-00f2-4f4c-8d90-814d6507561e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D3B7B440>]}
[0m12:31:59.913143 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi1 ............................ [[32mSUCCESS 1[0m in 1.57s]
[0m12:31:59.928965 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m12:31:59.928965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:59.928965 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:31:59.928965 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:32:00.254692 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:32:00.254692 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:32:00.590542 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m12:32:00.590542 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m12:32:00.933244 [info ] [MainThread]: 
[0m12:32:00.933244 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m12:32:00.933244 [debug] [MainThread]: Command end result
[0m12:32:00.962031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:32:00.962031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:32:00.974232 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:32:00.974232 [info ] [MainThread]: 
[0m12:32:00.974232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:00.974232 [info ] [MainThread]: 
[0m12:32:00.990592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:00.992788 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:00.991754 after 8.37 seconds
[0m12:32:00.992788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D6367620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D56EE330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220D455C2C0>]}
[0m12:32:00.993788 [debug] [MainThread]: Flushing usage events
[0m12:32:01.865204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:18.416139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC49B06840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC49B06FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC49B06210>]}


============================== 12:36:18.416139 | bcbd2057-07ff-43e1-98d4-ee2acfafdd61 ==============================
[0m12:36:18.416139 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:36:18.416139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi7', 'send_anonymous_usage_stats': 'True'}
[0m12:36:19.654036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC5575AD80>]}
[0m12:36:19.729294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC558A9C70>]}
[0m12:36:19.731300 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:36:20.311772 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:36:20.533297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:36:20.533297 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m12:36:20.877054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC56C1DCD0>]}
[0m12:36:20.972679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:36:20.981031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:36:21.019922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC56A1C1D0>]}
[0m12:36:21.019922 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 473 macros
[0m12:36:21.019922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC495B02F0>]}
[0m12:36:21.019922 [info ] [MainThread]: 
[0m12:36:21.019922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:21.019922 [info ] [MainThread]: 
[0m12:36:21.019922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:21.027882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:36:21.146551 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:36:21.146551 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:36:21.146551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:22.683842 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.531 seconds
[0m12:36:22.691117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:36:22.707123 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:36:22.707123 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:36:22.707123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:23.724688 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.011 seconds
[0m12:36:23.724688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m12:36:23.724688 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:36:23.724688 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:36:24.002241 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.269 seconds
[0m12:36:24.005263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m12:36:24.007229 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:36:24.008263 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:36:24.198732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.191 seconds
[0m12:36:24.200738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC46FB13A0>]}
[0m12:36:24.200738 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m12:36:24.200738 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m12:36:24.200738 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m12:36:24.200738 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m12:36:24.210579 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m12:36:24.210579 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m12:36:24.258980 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m12:36:24.260946 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m12:36:24.261984 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT * 
FROM ranked_customers
ORDER BY revenue_rank;
[0m12:36:24.261984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:25.214997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4a-3201-7db6-000c-3d5a0002057e
[0m12:36:25.214997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 21 unexpected ';'.
[0m12:36:25.230829 [debug] [Thread-1 (]: Database Error in model kpi7 (models\intermediate\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi7.sql
[0m12:36:25.230829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcbd2057-07ff-43e1-98d4-ee2acfafdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC48FB14F0>]}
[0m12:36:25.230829 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi7 ........................ [[31mERROR[0m in 1.03s]
[0m12:36:25.230829 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m12:36:25.230829 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi7' to be skipped because of status 'error'.  Reason: Database Error in model kpi7 (models\intermediate\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi7.sql.
[0m12:36:25.230829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:25.230829 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:36:25.230829 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:36:25.560031 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:36:25.560031 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:36:25.890455 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m12:36:25.890455 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m12:36:26.206689 [info ] [MainThread]: 
[0m12:36:26.206689 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m12:36:26.206689 [debug] [MainThread]: Command end result
[0m12:36:26.242296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:36:26.242296 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:36:26.260667 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:36:26.260667 [info ] [MainThread]: 
[0m12:36:26.261665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:36:26.262699 [info ] [MainThread]: 
[0m12:36:26.263666 [error] [MainThread]:   Database Error in model kpi7 (models\intermediate\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 21 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi7.sql
[0m12:36:26.263666 [info ] [MainThread]: 
[0m12:36:26.263666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:36:26.263666 [debug] [MainThread]: Command `dbt run` failed at 12:36:26.263666 after 8.07 seconds
[0m12:36:26.263666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC49865F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC56C6C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AC4943EE10>]}
[0m12:36:26.263666 [debug] [MainThread]: Flushing usage events
[0m12:36:27.520441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:34.439494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE081AEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE083682F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE081AF1A0>]}


============================== 12:36:34.449960 | a26f039b-cb32-4c02-bce9-9eee3f87ae8e ==============================
[0m12:36:34.449960 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:36:34.449960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi7', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:36:35.692819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE15172A50>]}
[0m12:36:35.772251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE147165A0>]}
[0m12:36:35.772251 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:36:36.370409 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:36:36.611037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:36.611037 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m12:36:36.967036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE159FFA70>]}
[0m12:36:37.071534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:36:37.078564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:36:37.113244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE15740440>]}
[0m12:36:37.119977 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 473 macros
[0m12:36:37.119977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1578A990>]}
[0m12:36:37.119977 [info ] [MainThread]: 
[0m12:36:37.119977 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:37.119977 [info ] [MainThread]: 
[0m12:36:37.119977 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:37.119977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:36:37.257195 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:36:37.258197 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:36:37.258197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:38.666518 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.408 seconds
[0m12:36:38.667314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m12:36:38.682701 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:36:38.682701 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:36:38.682701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:39.701084 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.012 seconds
[0m12:36:39.704069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m12:36:39.707068 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:36:39.707068 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:36:39.912926 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m12:36:39.930816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:36:39.941415 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:36:39.943436 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:36:40.141784 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m12:36:40.152910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE16CF6E40>]}
[0m12:36:40.155992 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m12:36:40.157039 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m12:36:40.157974 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m12:36:40.159083 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m12:36:40.169861 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m12:36:40.170862 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m12:36:40.201160 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m12:36:40.201160 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m12:36:40.201160 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT * 
FROM ranked_customers
ORDER BY revenue_rank
        );
[0m12:36:40.201160 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:41.575614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m12:36:41.604668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a26f039b-cb32-4c02-bce9-9eee3f87ae8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE05BB7380>]}
[0m12:36:41.605678 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi7 ............................ [[32mSUCCESS 1[0m in 1.44s]
[0m12:36:41.606253 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m12:36:41.608483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:41.608483 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:36:41.609517 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:36:41.936005 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m12:36:41.936005 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m12:36:42.266721 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m12:36:42.273367 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m12:36:42.606145 [info ] [MainThread]: 
[0m12:36:42.606145 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m12:36:42.606145 [debug] [MainThread]: Command end result
[0m12:36:42.641569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:36:42.642536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:36:42.652610 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:36:42.653644 [info ] [MainThread]: 
[0m12:36:42.654498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:42.654498 [info ] [MainThread]: 
[0m12:36:42.654498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:42.654498 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:42.654498 after 8.44 seconds
[0m12:36:42.654498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE07ED8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE07834D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE082FBCE0>]}
[0m12:36:42.654498 [debug] [MainThread]: Flushing usage events
[0m12:36:43.570076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:06.494331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C817DB020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C817DAF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C817DAF90>]}


============================== 12:49:06.510420 | dac5bcdc-4143-4d22-bc83-8ee074d15023 ==============================
[0m12:49:06.510420 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:49:06.510420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:10.412692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E5F2990>]}
[0m12:49:10.476955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E411400>]}
[0m12:49:10.476955 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:49:11.215611 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:49:12.818625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:49:12.818625 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m12:49:13.144938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8EBEFE90>]}
[0m12:49:13.255662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:49:13.271389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:49:13.313180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E930B90>]}
[0m12:49:13.313180 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m12:49:13.313180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E882450>]}
[0m12:49:13.319037 [info ] [MainThread]: 
[0m12:49:13.319037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:13.319037 [info ] [MainThread]: 
[0m12:49:13.319037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:13.319037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:49:16.604644 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:49:16.604644 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:49:16.606653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:18.044096 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.437 seconds
[0m12:49:18.051362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m12:49:18.065405 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:49:18.065405 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:49:18.065405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:19.020375 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.961 seconds
[0m12:49:19.028394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m12:49:19.032409 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:49:19.032409 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:49:19.220646 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.192 seconds
[0m12:49:19.227008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m12:49:19.231024 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:49:19.231024 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:49:19.446433 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m12:49:19.448437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFEC91220>]}
[0m12:49:19.451949 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m12:49:19.453695 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m12:49:19.453695 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m12:49:19.453695 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m12:49:19.463733 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m12:49:19.465743 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m12:49:19.506053 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m12:49:19.508054 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m12:49:19.509054 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rp.PRODUCT_SUB_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank
        );
[0m12:49:19.510054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:20.984853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.490 seconds
[0m12:49:21.023233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac5bcdc-4143-4d22-bc83-8ee074d15023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8FF55EE0>]}
[0m12:49:21.023233 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.57s]
[0m12:49:21.023233 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m12:49:21.023233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:21.023233 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:49:21.023233 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:49:21.355120 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m12:49:21.355120 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m12:49:21.684160 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m12:49:21.684160 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m12:49:22.005375 [info ] [MainThread]: 
[0m12:49:22.005375 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m12:49:22.005375 [debug] [MainThread]: Command end result
[0m12:49:22.041887 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:49:22.045209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:49:22.048212 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:49:22.048212 [info ] [MainThread]: 
[0m12:49:22.048212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:22.048212 [info ] [MainThread]: 
[0m12:49:22.048212 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:22.057612 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:22.057612 after 15.79 seconds
[0m12:49:22.058620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E672F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E673020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8EAA3230>]}
[0m12:49:22.059666 [debug] [MainThread]: Flushing usage events
[0m12:49:23.269272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:34.595184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FFC5A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FFC59D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FFC5BC50>]}


============================== 12:51:34.595184 | 89c5bce5-efaa-42ed-a431-7b82cb70abbb ==============================
[0m12:51:34.595184 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:51:34.595184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi6', 'send_anonymous_usage_stats': 'True'}
[0m12:51:35.805926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168B5FDBB0>]}
[0m12:51:35.869253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168BEDBEF0>]}
[0m12:51:35.869253 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:51:36.468982 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:51:36.698856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:51:36.698856 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m12:51:37.032808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168CFEFBC0>]}
[0m12:51:37.134154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:51:37.139919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:51:37.169566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FEC0BA10>]}
[0m12:51:37.169566 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m12:51:37.169566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FFC58B90>]}
[0m12:51:37.169566 [info ] [MainThread]: 
[0m12:51:37.185330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:37.185330 [info ] [MainThread]: 
[0m12:51:37.185330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:51:37.185330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:51:37.309211 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:51:37.309211 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:51:37.309211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:38.795083 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.479 seconds
[0m12:51:38.795083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m12:51:38.805609 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:51:38.805609 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:51:38.805609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:39.775626 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.960 seconds
[0m12:51:39.775626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m12:51:39.791550 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:51:39.791550 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:51:40.015048 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.221 seconds
[0m12:51:40.020503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m12:51:40.024519 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:51:40.024519 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:51:40.229184 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m12:51:40.247616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168E417860>]}
[0m12:51:40.251008 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m12:51:40.251008 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m12:51:40.251008 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m12:51:40.251008 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m12:51:40.264926 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m12:51:40.266891 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m12:51:40.301256 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m12:51:40.301256 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m12:51:40.301256 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank
        );
[0m12:51:40.301256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:41.653179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m12:51:41.684885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c5bce5-efaa-42ed-a431-7b82cb70abbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168CE63890>]}
[0m12:51:41.684885 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.43s]
[0m12:51:41.700793 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m12:51:41.700793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:41.700793 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:51:41.700793 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:51:42.024004 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m12:51:42.024004 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m12:51:42.364346 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m12:51:42.364346 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m12:51:42.686100 [info ] [MainThread]: 
[0m12:51:42.686100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m12:51:42.686100 [debug] [MainThread]: Command end result
[0m12:51:42.721778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:51:42.721778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:51:42.733816 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:51:42.733816 [info ] [MainThread]: 
[0m12:51:42.733816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:42.733816 [info ] [MainThread]: 
[0m12:51:42.733816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:42.733816 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:42.733816 after 8.35 seconds
[0m12:51:42.733816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FF59DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FFB286E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216FD9EFFE0>]}
[0m12:51:42.733816 [debug] [MainThread]: Flushing usage events
[0m12:51:43.640498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:05.814566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0F357EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0F354230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0F3559A0>]}


============================== 12:59:05.814566 | 116f38e8-f981-4763-94f3-16cd83179d58 ==============================
[0m12:59:05.814566 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:59:05.814566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi6', 'send_anonymous_usage_stats': 'True'}
[0m12:59:09.690827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0F32E270>]}
[0m12:59:09.761269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0CA70AA0>]}
[0m12:59:09.769822 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m12:59:10.510591 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:59:12.150482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:59:12.150482 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m12:59:12.489894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1C0A76E0>]}
[0m12:59:12.585028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:59:12.597115 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:59:12.639054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1C545040>]}
[0m12:59:12.641972 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m12:59:12.641972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1C45B1A0>]}
[0m12:59:12.644486 [info ] [MainThread]: 
[0m12:59:12.644486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:12.644486 [info ] [MainThread]: 
[0m12:59:12.644486 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:12.648711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m12:59:15.894270 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m12:59:15.894270 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m12:59:15.894270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:17.372854 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.482 seconds
[0m12:59:17.406457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m12:59:17.426226 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m12:59:17.428234 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m12:59:17.428234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:18.341737 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.917 seconds
[0m12:59:18.341737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m12:59:18.341737 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m12:59:18.341737 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m12:59:18.550292 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m12:59:18.550292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m12:59:18.550292 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m12:59:18.550292 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m12:59:18.763528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.207 seconds
[0m12:59:18.763528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1C403590>]}
[0m12:59:18.763528 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m12:59:18.763528 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m12:59:18.763528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m12:59:18.763528 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m12:59:18.785717 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m12:59:18.785717 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m12:59:18.818913 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m12:59:18.818913 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m12:59:18.818913 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank
        );
[0m12:59:18.818913 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:20.201576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.386 seconds
[0m12:59:20.253124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '116f38e8-f981-4763-94f3-16cd83179d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0E8098E0>]}
[0m12:59:20.253124 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.49s]
[0m12:59:20.253124 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m12:59:20.253124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:20.253124 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m12:59:20.253124 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m12:59:20.591791 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m12:59:20.591791 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m12:59:20.904454 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m12:59:20.904454 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m12:59:21.221165 [info ] [MainThread]: 
[0m12:59:21.221165 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m12:59:21.221165 [debug] [MainThread]: Command end result
[0m12:59:21.260070 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m12:59:21.260070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m12:59:21.274832 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m12:59:21.274832 [info ] [MainThread]: 
[0m12:59:21.275833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:21.277339 [info ] [MainThread]: 
[0m12:59:21.278548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:59:21.281543 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:21.281543 after 15.72 seconds
[0m12:59:21.281543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0D0E3E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0D0E3D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0D0E3CB0>]}
[0m12:59:21.282542 [debug] [MainThread]: Flushing usage events
[0m12:59:22.406710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:01.267105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AF857890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AF855100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AF8569C0>]}


============================== 13:00:01.273140 | 56e8ac8a-1109-4820-a011-924952401905 ==============================
[0m13:00:01.273140 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:00:01.274106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi6', 'send_anonymous_usage_stats': 'True'}
[0m13:00:02.532560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1BC42ED50>]}
[0m13:00:02.610542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1BBC7B4A0>]}
[0m13:00:02.611960 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:00:03.196365 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:00:03.443947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:03.443947 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m13:00:03.797926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1BBB178C0>]}
[0m13:00:03.900302 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:00:03.914816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:00:03.948130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1BC959100>]}
[0m13:00:03.948130 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:00:03.948130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AD534D70>]}
[0m13:00:03.958140 [info ] [MainThread]: 
[0m13:00:03.958140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:03.958140 [info ] [MainThread]: 
[0m13:00:03.958140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:03.958140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:00:04.080509 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:00:04.080509 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:00:04.080509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:05.740487 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.656 seconds
[0m13:00:05.756427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m13:00:05.772425 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:00:05.772425 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:00:05.772425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:06.791915 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.027 seconds
[0m13:00:06.791915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:00:06.807612 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:00:06.807612 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:00:07.017320 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m13:00:07.017320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:00:07.017320 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:00:07.017320 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:00:07.243410 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.219 seconds
[0m13:00:07.243410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1ACCA1310>]}
[0m13:00:07.243410 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:00:07.243410 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:00:07.243410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:00:07.243410 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:00:07.265380 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:00:07.267533 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:00:07.308186 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:00:07.310189 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:00:07.311186 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank
        );
[0m13:00:07.311186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:08.699430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.388 seconds
[0m13:00:08.715555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e8ac8a-1109-4820-a011-924952401905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1ACBF73B0>]}
[0m13:00:08.731353 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.47s]
[0m13:00:08.731353 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:00:08.731353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:08.731353 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:00:08.731353 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:00:09.062030 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m13:00:09.064040 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m13:00:09.383523 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:00:09.383523 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:00:09.715302 [info ] [MainThread]: 
[0m13:00:09.716301 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m13:00:09.717302 [debug] [MainThread]: Command end result
[0m13:00:09.745002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:00:09.745002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:00:09.757015 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:00:09.758014 [info ] [MainThread]: 
[0m13:00:09.759017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:09.759017 [info ] [MainThread]: 
[0m13:00:09.760016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:00:09.760016 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:09.760016 after 8.71 seconds
[0m13:00:09.760016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AF8544D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AF8569C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1AF855100>]}
[0m13:00:09.760016 [debug] [MainThread]: Flushing usage events
[0m13:00:10.669118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:04.861560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C76826180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C768275C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C768260F0>]}


============================== 13:11:04.870599 | 75edfef8-f140-4c02-8b6c-6cbc6507803f ==============================
[0m13:11:04.870599 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:11:04.870599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi7', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:11:08.814560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C76843D10>]}
[0m13:11:08.890588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C7F253800>]}
[0m13:11:08.890588 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:11:09.630183 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:11:11.367470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:11.368615 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m13:11:11.709530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C03ABFE60>]}
[0m13:11:11.806297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:11:11.824005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:11:11.859112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C03A4CEF0>]}
[0m13:11:11.862039 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:11:11.862039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C03AA7050>]}
[0m13:11:11.862039 [info ] [MainThread]: 
[0m13:11:11.862039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:11.862039 [info ] [MainThread]: 
[0m13:11:11.862039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:11:11.862039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:11:15.141619 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:11:15.141619 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:11:15.142584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:16.859290 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.719 seconds
[0m13:11:16.870704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:11:16.874018 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:11:16.874018 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:11:16.874018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:17.821781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.948 seconds
[0m13:11:17.837606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m13:11:17.837606 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:11:17.837606 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:11:18.049088 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m13:11:18.049088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m13:11:18.067824 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:11:18.069075 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:11:18.266170 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m13:11:18.281968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C03542CF0>]}
[0m13:11:18.281968 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:11:18.281968 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m13:11:18.281968 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m13:11:18.281968 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:11:18.298029 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:11:18.299634 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:11:18.338814 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m13:11:18.340823 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m13:11:18.341857 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID
-- ),
-- ranked_customers AS (
--     SELECT 
--         CUSTOMER_ID,
--         total_revenue,
--         RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
-- SELECT 
--     rc.CUSTOMER_ID,
--     rc.total_revenue,
--     rc.revenue_rank,
--     cc.CUSTOMER_NAME
-- FROM ranked_customers rc
-- JOIN DE_MINI_PROJECT.staging.stg_customers cc
--     ON rc.customer_id = cc.customer_id
-- ORDER BY revenue_rank
-- ORDER BY revenue_rank

WITH int_rank_customers AS(
SELECT
    t.customer_id,
    c.customer_name,
    SUM(t.revenue) AS total_revenue,
    rank() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
FROM
    DE_MINI_PROJECT.staging.stg_transactions t
JOIN
    DE_MINI_PROJECT.staging.stg_customers c ON t.customer_id = c.customer_id
GROUP BY
    t.customer_id, c.customer_name
ORDER BY
    total_revenue DESC
)
SELECT * FROM int_rank_customers
        );
[0m13:11:18.341857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:20.156924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.825 seconds
[0m13:11:20.189026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75edfef8-f140-4c02-8b6c-6cbc6507803f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C75CD95E0>]}
[0m13:11:20.189026 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi7 ............................ [[32mSUCCESS 1[0m in 1.91s]
[0m13:11:20.189026 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:11:20.189026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:20.189026 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:11:20.189026 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:11:20.531967 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:11:20.531967 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:11:20.868381 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m13:11:20.870405 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m13:11:21.201249 [info ] [MainThread]: 
[0m13:11:21.201249 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m13:11:21.201249 [debug] [MainThread]: Command end result
[0m13:11:21.233047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:11:21.233047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:11:21.247181 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:11:21.247181 [info ] [MainThread]: 
[0m13:11:21.247181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:21.247181 [info ] [MainThread]: 
[0m13:11:21.247181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:21.247181 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:21.247181 after 16.68 seconds
[0m13:11:21.247181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C7664AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C758F27E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C758F1880>]}
[0m13:11:21.247181 [debug] [MainThread]: Flushing usage events
[0m13:11:22.139324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:58.032631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E60376B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5C3591C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5F4132F0>]}


============================== 13:11:58.032631 | 777f2559-678b-4781-a8ae-0c4627ee98a8 ==============================
[0m13:11:58.032631 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:11:58.032631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:59.243522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '777f2559-678b-4781-a8ae-0c4627ee98a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6D03EFF0>]}
[0m13:11:59.307359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '777f2559-678b-4781-a8ae-0c4627ee98a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6D010470>]}
[0m13:11:59.323123 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:11:59.887446 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:12:00.104444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:00.104444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:00.151752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '777f2559-678b-4781-a8ae-0c4627ee98a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6C69A060>]}
[0m13:12:00.262733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:12:00.262733 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:12:00.294074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '777f2559-678b-4781-a8ae-0c4627ee98a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6D38BEF0>]}
[0m13:12:00.294074 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:12:00.294074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '777f2559-678b-4781-a8ae-0c4627ee98a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6D13DAC0>]}
[0m13:12:00.310163 [info ] [MainThread]: 
[0m13:12:00.310163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:00.310163 [info ] [MainThread]: 
[0m13:12:00.310163 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:12:00.319036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m13:12:00.456397 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:12:00.456397 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:12:00.457400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:01.838713 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.381 seconds
[0m13:12:01.838713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m13:12:01.838713 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:12:01.838713 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:12:02.041053 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m13:12:02.045088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m13:12:02.047096 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:12:02.047096 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:12:02.243117 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m13:12:02.243117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '777f2559-678b-4781-a8ae-0c4627ee98a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6CFD7830>]}
[0m13:12:02.263194 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m13:12:02.263194 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_products'
[0m13:12:02.263194 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m13:12:02.274921 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m13:12:02.274921 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m13:12:02.274921 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m13:12:02.274921 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m13:12:02.279782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m13:12:02.279782 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m13:12:02.279782 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m13:12:02.279782 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m13:12:02.279782 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m13:12:02.279782 [debug] [Thread-1 (]: Began running node seed.DE_MINI_PROJECT.country_region
[0m13:12:02.279782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now seed.DE_MINI_PROJECT.country_region)
[0m13:12:02.279782 [debug] [Thread-1 (]: Began compiling node seed.DE_MINI_PROJECT.country_region
[0m13:12:02.279782 [debug] [Thread-1 (]: Began executing node seed.DE_MINI_PROJECT.country_region
[0m13:12:02.290695 [debug] [Thread-1 (]: Finished running node seed.DE_MINI_PROJECT.country_region
[0m13:12:02.290695 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m13:12:02.290695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.DE_MINI_PROJECT.country_region, now model.DE_MINI_PROJECT.kpi1)
[0m13:12:02.290695 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m13:12:02.290695 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m13:12:02.290695 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m13:12:02.290695 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m13:12:02.290695 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:12:02.290695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi1, now model.DE_MINI_PROJECT.kpi6)
[0m13:12:02.290695 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:12:02.290695 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:12:02.290695 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:12:02.290695 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:12:02.290695 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_country
[0m13:12:02.290695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi6, now model.DE_MINI_PROJECT.stg_country)
[0m13:12:02.306654 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_country
[0m13:12:02.306654 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_country"
[0m13:12:02.306654 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_country
[0m13:12:02.306654 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_country
[0m13:12:02.306654 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m13:12:02.306654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_country, now model.DE_MINI_PROJECT.stg_customers)
[0m13:12:02.306654 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m13:12:02.306654 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m13:12:02.306654 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m13:12:02.322429 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m13:12:02.322429 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m13:12:02.322429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.intermediate_customers)
[0m13:12:02.324439 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m13:12:02.324439 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m13:12:02.324439 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m13:12:02.324439 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m13:12:02.324439 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:12:02.324439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.intermediate_customers, now model.DE_MINI_PROJECT.kpi7)
[0m13:12:02.324439 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:12:02.324439 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:12:02.324439 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:12:02.324439 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:12:02.338265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:02.338265 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m13:12:02.338265 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m13:12:02.662797 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was properly closed.
[0m13:12:02.662797 [debug] [MainThread]: Command end result
[0m13:12:02.710933 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:12:02.710933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:12:02.726956 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:12:02.726956 [debug] [MainThread]: Command `dbt compile` succeeded at 13:12:02.726956 after 4.90 seconds
[0m13:12:02.726956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E601D55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5FF14C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E5FEAFCB0>]}
[0m13:12:02.726956 [debug] [MainThread]: Flushing usage events
[0m13:12:03.602926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:16.363185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FD68DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FBE02C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FD8238F0>]}


============================== 13:12:16.363185 | f171b3c6-311e-433a-a1cd-9452a1d9f3ab ==============================
[0m13:12:16.363185 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:12:16.363185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi7', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:17.587627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78A3FACC0>]}
[0m13:12:17.666916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FD60F260>]}
[0m13:12:17.666916 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:12:18.251047 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:12:18.473664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:18.473664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:18.531672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FE918650>]}
[0m13:12:18.615539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:12:18.630833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:12:18.675757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78AF13440>]}
[0m13:12:18.676759 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:12:18.677757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78AE56570>]}
[0m13:12:18.678679 [info ] [MainThread]: 
[0m13:12:18.679837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:18.680803 [info ] [MainThread]: 
[0m13:12:18.682231 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:12:18.683412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:12:18.821615 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:12:18.821615 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:12:18.821615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:20.201017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.378 seconds
[0m13:12:20.213027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m13:12:20.226002 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:12:20.226002 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:12:20.227037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:21.223124 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.997 seconds
[0m13:12:21.227123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:12:21.233834 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:12:21.233834 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:12:21.427361 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.192 seconds
[0m13:12:21.433484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:12:21.440192 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:12:21.440192 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:12:21.635632 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.195 seconds
[0m13:12:21.635632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FB640F80>]}
[0m13:12:21.635632 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:12:21.635632 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m13:12:21.635632 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m13:12:21.635632 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:12:21.655727 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:12:21.657808 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:12:21.698263 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m13:12:21.700229 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m13:12:21.701263 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID
-- ),
-- ranked_customers AS (
--     SELECT 
--         CUSTOMER_ID,
--         total_revenue,
--         RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
-- SELECT 
--     rc.CUSTOMER_ID,
--     rc.total_revenue,
--     rc.revenue_rank,
--     cc.CUSTOMER_NAME
-- FROM ranked_customers rc
-- JOIN DE_MINI_PROJECT.staging.stg_customers cc
--     ON rc.customer_id = cc.customer_id
-- ORDER BY revenue_rank
-- ORDER BY revenue_rank

WITH int_rank_customers AS(
SELECT
    t.customer_id,
    c.customer_name,
    SUM(t.revenue) AS total_revenue,
    rank() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
FROM
    DE_MINI_PROJECT.staging.stg_transactions t
JOIN
    DE_MINI_PROJECT.staging.stg_customers c ON t.customer_id = c.customer_id
GROUP BY
    t.customer_id, c.customer_name
ORDER BY
    total_revenue DESC
)
SELECT * FROM int_rank_customers
        );
[0m13:12:21.702031 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:23.067260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.365 seconds
[0m13:12:23.086653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f171b3c6-311e-433a-a1cd-9452a1d9f3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FD659880>]}
[0m13:12:23.086653 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi7 ............................ [[32mSUCCESS 1[0m in 1.45s]
[0m13:12:23.086653 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:12:23.086653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:23.086653 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:12:23.101931 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:12:23.421350 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m13:12:23.431479 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m13:12:23.859495 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m13:12:23.861423 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m13:12:24.195646 [info ] [MainThread]: 
[0m13:12:24.196731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m13:12:24.198745 [debug] [MainThread]: Command end result
[0m13:12:24.227327 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:12:24.229327 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:12:24.238701 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:12:24.239708 [info ] [MainThread]: 
[0m13:12:24.240702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:24.240702 [info ] [MainThread]: 
[0m13:12:24.240702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:12:24.240702 [debug] [MainThread]: Command `dbt run` succeeded at 13:12:24.240702 after 8.17 seconds
[0m13:12:24.240702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FDE48680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7FABD4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78B11D2E0>]}
[0m13:12:24.246763 [debug] [MainThread]: Flushing usage events
[0m13:12:25.477743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:12.489760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C5955B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C30A4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C5954830>]}


============================== 13:14:12.489760 | 4ab25966-2332-498a-b890-cbc5ed54c30d ==============================
[0m13:14:12.489760 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:14:12.489760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi7', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:14:13.746726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D250EED0>]}
[0m13:14:13.814791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D01687D0>]}
[0m13:14:13.814791 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:14:14.429607 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:14:14.659956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:14.659956 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m13:14:14.999890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D2BFFEF0>]}
[0m13:14:15.095756 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:14:15.099885 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:14:15.127574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D2B8CDD0>]}
[0m13:14:15.127574 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:14:15.127574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D2AEDD00>]}
[0m13:14:15.143460 [info ] [MainThread]: 
[0m13:14:15.143460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:15.143460 [info ] [MainThread]: 
[0m13:14:15.143460 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:14:15.143460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:14:15.264833 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:14:15.264833 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:14:15.264833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:16.603503 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.332 seconds
[0m13:14:16.614206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m13:14:16.629303 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:14:16.629303 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:14:16.629303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:17.596402 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.968 seconds
[0m13:14:17.596402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:14:17.596402 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:14:17.596402 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:14:17.787293 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.183 seconds
[0m13:14:17.787293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m13:14:17.787293 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:14:17.787293 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:14:17.998951 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m13:14:18.015085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235D408F860>]}
[0m13:14:18.017159 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:14:18.017159 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m13:14:18.017159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m13:14:18.030849 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:14:18.055466 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:14:18.057479 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:14:18.096395 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m13:14:18.099359 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m13:14:18.099359 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.CUSTOMER_ID,
    rc.total_revenue,
    rc.revenue_rank,
    cc.CUSTOMER_NAME
FROM ranked_customers rc
JOIN DE_MINI_PROJECT.staging.stg_customers cc
    ON rc.customer_id = cc.customer_id
ORDER BY revenue_rank
ORDER BY revenue_rank

-- WITH int_rank_customers AS(
-- SELECT
--     t.customer_id,
--     c.customer_name,
--     SUM(t.revenue) AS total_revenue,
--     rank() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_customers c ON t.customer_id = c.customer_id
-- GROUP BY
--     t.customer_id, c.customer_name
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_customers
        );
[0m13:14:18.100393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:19.250984 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff70-3201-7e56-000c-3d5a000234b6
[0m13:14:19.255148 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 0 unexpected 'ORDER'.
syntax error line 44 at position 8 unexpected ')'.
[0m13:14:19.276965 [debug] [Thread-1 (]: Database Error in model kpi7 (models\intermediate\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 0 unexpected 'ORDER'.
  syntax error line 44 at position 8 unexpected ')'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi7.sql
[0m13:14:19.279966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab25966-2332-498a-b890-cbc5ed54c30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C4DFDA00>]}
[0m13:14:19.280967 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi7 ........................ [[31mERROR[0m in 1.26s]
[0m13:14:19.281453 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:14:19.282496 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi7' to be skipped because of status 'error'.  Reason: Database Error in model kpi7 (models\intermediate\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 0 unexpected 'ORDER'.
  syntax error line 44 at position 8 unexpected ')'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi7.sql.
[0m13:14:19.285462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:19.285462 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:14:19.285462 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:14:19.613726 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:14:19.613726 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:14:19.932530 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m13:14:19.948261 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m13:14:20.273820 [info ] [MainThread]: 
[0m13:14:20.273820 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m13:14:20.273820 [debug] [MainThread]: Command end result
[0m13:14:20.309907 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:14:20.310904 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:14:20.320920 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:14:20.320920 [info ] [MainThread]: 
[0m13:14:20.321918 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:14:20.323149 [info ] [MainThread]: 
[0m13:14:20.323149 [error] [MainThread]:   Database Error in model kpi7 (models\intermediate\kpi7.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 0 unexpected 'ORDER'.
  syntax error line 44 at position 8 unexpected ')'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi7.sql
[0m13:14:20.323149 [info ] [MainThread]: 
[0m13:14:20.323149 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:14:20.328210 [debug] [MainThread]: Command `dbt run` failed at 13:14:20.323149 after 8.04 seconds
[0m13:14:20.328210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C54F0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C533EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235C4E34E60>]}
[0m13:14:20.329253 [debug] [MainThread]: Flushing usage events
[0m13:14:21.618890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:35.978080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4C5F69F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4C5F7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4C5F5490>]}


============================== 13:14:35.983114 | 3e347786-b721-46fb-88c1-566f2cdf1c1f ==============================
[0m13:14:35.983114 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:14:35.985081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi7', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:37.198302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC56E76B40>]}
[0m13:14:37.275716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5919E750>]}
[0m13:14:37.276903 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:14:37.867389 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:14:38.099547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:38.099547 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m13:14:38.437051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC596AF800>]}
[0m13:14:38.551048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:14:38.557080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:14:38.635978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC5986CCB0>]}
[0m13:14:38.635978 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:14:38.637987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC597CF3E0>]}
[0m13:14:38.642011 [info ] [MainThread]: 
[0m13:14:38.642011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:38.643761 [info ] [MainThread]: 
[0m13:14:38.645773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:14:38.652429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:14:38.803069 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:14:38.803069 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:14:38.803069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:40.189873 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.386 seconds
[0m13:14:40.222001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m13:14:40.247151 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:14:40.247541 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:14:40.247541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:41.305258 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.057 seconds
[0m13:14:41.311337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m13:14:41.320094 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:14:41.321095 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:14:41.522746 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m13:14:41.525471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m13:14:41.528472 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:14:41.529474 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:14:41.740572 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m13:14:41.746639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC59277B60>]}
[0m13:14:41.754224 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:14:41.754224 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m13:14:41.754224 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m13:14:41.754224 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:14:41.766179 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:14:41.768186 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:14:41.808333 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m13:14:41.810420 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m13:14:41.810420 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.CUSTOMER_ID,
    rc.total_revenue,
    rc.revenue_rank,
    cc.CUSTOMER_NAME
FROM ranked_customers rc
JOIN DE_MINI_PROJECT.staging.stg_customers cc
    ON rc.customer_id = cc.customer_id
ORDER BY revenue_rank


-- WITH int_rank_customers AS(
-- SELECT
--     t.customer_id,
--     c.customer_name,
--     SUM(t.revenue) AS total_revenue,
--     rank() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_customers c ON t.customer_id = c.customer_id
-- GROUP BY
--     t.customer_id, c.customer_name
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_customers
        );
[0m13:14:41.811421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:43.222666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.420 seconds
[0m13:14:43.270792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e347786-b721-46fb-88c1-566f2cdf1c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC49997410>]}
[0m13:14:43.270792 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi7 ............................ [[32mSUCCESS 1[0m in 1.52s]
[0m13:14:43.270792 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:14:43.270792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:43.270792 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:14:43.270792 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:14:43.609846 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m13:14:43.609846 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m13:14:43.947123 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m13:14:43.947123 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m13:14:44.269500 [info ] [MainThread]: 
[0m13:14:44.269500 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m13:14:44.269500 [debug] [MainThread]: Command end result
[0m13:14:44.310462 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:14:44.313889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:14:44.313889 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:14:44.313889 [info ] [MainThread]: 
[0m13:14:44.313889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:44.313889 [info ] [MainThread]: 
[0m13:14:44.313889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:14:44.327160 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:44.327160 after 8.56 seconds
[0m13:14:44.328945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4BD4C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4BE53920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4A3BC260>]}
[0m13:14:44.328945 [debug] [MainThread]: Flushing usage events
[0m13:14:45.278177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:35.879451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC9B912B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC9B900E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC9B91670>]}


============================== 13:15:35.895156 | 2c11f99d-b778-4f00-892a-f31af958b149 ==============================
[0m13:15:35.895156 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:15:35.895156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi7', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:15:37.086625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD6472A50>]}
[0m13:15:37.165460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC9B912B0>]}
[0m13:15:37.165460 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:15:37.753783 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:15:37.975767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:37.975767 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m13:15:38.363247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD6CCF1A0>]}
[0m13:15:38.469974 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:15:38.474900 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:15:38.514800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD6B24BC0>]}
[0m13:15:38.514800 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:15:38.514800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD6DC1C10>]}
[0m13:15:38.514800 [info ] [MainThread]: 
[0m13:15:38.514800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:38.522730 [info ] [MainThread]: 
[0m13:15:38.522730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:15:38.524737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:15:38.680072 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:15:38.680072 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:15:38.681074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:39.996816 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.323 seconds
[0m13:15:39.996816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:15:40.017271 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:15:40.017271 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:15:40.017271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:41.050651 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.026 seconds
[0m13:15:41.054463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m13:15:41.057459 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:15:41.058494 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:15:41.256774 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m13:15:41.262833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:15:41.271727 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:15:41.272717 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:15:41.523231 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.250 seconds
[0m13:15:41.527266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC6FE11F0>]}
[0m13:15:41.529486 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:15:41.529486 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m13:15:41.529486 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m13:15:41.529486 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:15:41.529486 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:15:41.545202 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:15:41.583605 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m13:15:41.585819 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m13:15:41.586820 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID
-- ),
-- ranked_customers AS (
--     SELECT 
--         CUSTOMER_ID,
--         total_revenue,
--         RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
-- SELECT 
--     rc.CUSTOMER_ID,
--     rc.total_revenue,
--     rc.revenue_rank,
--     cc.CUSTOMER_NAME
-- FROM ranked_customers rc
-- JOIN DE_MINI_PROJECT.staging.stg_customers cc
--     ON rc.customer_id = cc.customer_id
-- ORDER BY revenue_rank


WITH int_rank_customers AS(
SELECT
    t.customer_id,
    c.customer_name,
    SUM(t.revenue) AS total_revenue,
    rank() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
FROM
    DE_MINI_PROJECT.staging.stg_transactions t
JOIN
    DE_MINI_PROJECT.staging.stg_customers c ON t.customer_id = c.customer_id
GROUP BY
    t.customer_id, c.customer_name
ORDER BY
    total_revenue DESC
)
SELECT * FROM int_rank_customers
        );
[0m13:15:41.586820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:43.455864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.870 seconds
[0m13:15:43.489080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c11f99d-b778-4f00-892a-f31af958b149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC6F3B3E0>]}
[0m13:15:43.489080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi7 ............................ [[32mSUCCESS 1[0m in 1.96s]
[0m13:15:43.489080 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:15:43.489080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:43.489080 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:15:43.489080 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:15:43.822604 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m13:15:43.822604 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m13:15:44.154289 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m13:15:44.154289 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m13:15:44.486231 [info ] [MainThread]: 
[0m13:15:44.488172 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m13:15:44.489678 [debug] [MainThread]: Command end result
[0m13:15:44.523392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:15:44.524300 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:15:44.524300 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:15:44.524300 [info ] [MainThread]: 
[0m13:15:44.524300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:44.524300 [info ] [MainThread]: 
[0m13:15:44.537141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:15:44.539077 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:44.539077 after 8.85 seconds
[0m13:15:44.539077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC933A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC8B30D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC9314500>]}
[0m13:15:44.541289 [debug] [MainThread]: Flushing usage events
[0m13:15:45.772704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:26.892437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200A9D6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200A9D4BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200A9D5130>]}


============================== 13:16:26.892437 | 41357d33-a3a4-4a50-8687-25e50f77b259 ==============================
[0m13:16:26.892437 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:16:26.892437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi7', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:28.083176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200AA1C4D0>]}
[0m13:16:28.150027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017623EF0>]}
[0m13:16:28.150027 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:16:28.739193 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:16:28.969134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:28.970175 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi7.sql
[0m13:16:29.315626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017C1FE60>]}
[0m13:16:29.417104 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:16:29.417104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:16:29.471153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017965D30>]}
[0m13:16:29.472154 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:16:29.473154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017C1AD20>]}
[0m13:16:29.475155 [info ] [MainThread]: 
[0m13:16:29.475155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:29.475155 [info ] [MainThread]: 
[0m13:16:29.475155 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:29.479893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:16:29.599136 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:16:29.599136 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:16:29.599136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:31.202943 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.598 seconds
[0m13:16:31.202943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m13:16:31.217498 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:16:31.217498 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:16:31.217498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:32.302053 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.087 seconds
[0m13:16:32.317597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m13:16:32.321699 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:16:32.321699 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:16:32.508353 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.186 seconds
[0m13:16:32.511388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m13:16:32.514390 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:16:32.514390 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:16:32.712139 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.196 seconds
[0m13:16:32.716143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220191A3320>]}
[0m13:16:32.719434 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m13:16:32.720572 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi7 ................................. [RUN]
[0m13:16:32.721113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi7'
[0m13:16:32.722157 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m13:16:32.732154 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m13:16:32.733156 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m13:16:32.774590 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m13:16:32.774590 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m13:16:32.778927 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.CUSTOMER_ID,
    rc.total_revenue,
    rc.revenue_rank,
    cc.CUSTOMER_NAME
FROM ranked_customers rc
JOIN DE_MINI_PROJECT.staging.stg_customers cc
    ON rc.customer_id = cc.customer_id
ORDER BY revenue_rank
        );
[0m13:16:32.778927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:34.116765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.349 seconds
[0m13:16:34.148114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41357d33-a3a4-4a50-8687-25e50f77b259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022007D77350>]}
[0m13:16:34.148114 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi7 ............................ [[32mSUCCESS 1[0m in 1.43s]
[0m13:16:34.148114 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m13:16:34.148114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:34.163905 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:16:34.163905 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:16:34.487341 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m13:16:34.487341 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m13:16:34.819597 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m13:16:34.819597 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m13:16:35.165585 [info ] [MainThread]: 
[0m13:16:35.165585 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m13:16:35.165585 [debug] [MainThread]: Command end result
[0m13:16:35.195252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:16:35.205207 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:16:35.212088 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:16:35.212088 [info ] [MainThread]: 
[0m13:16:35.212088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:35.212088 [info ] [MainThread]: 
[0m13:16:35.212088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:35.212088 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:35.212088 after 8.53 seconds
[0m13:16:35.212088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022017B5DD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022009E3EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022009E3D0A0>]}
[0m13:16:35.212088 [debug] [MainThread]: Flushing usage events
[0m13:16:36.121386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:09.502540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638230E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263823E7B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026385A96FC0>]}


============================== 13:20:09.502540 | 04dceb9b-c483-4668-b96c-49846374535f ==============================
[0m13:20:09.502540 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:20:09.502540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi6', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:20:10.705961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026391742B40>]}
[0m13:20:10.777715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026384FAC2F0>]}
[0m13:20:10.777715 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:20:11.367749 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:20:11.603060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:11.603060 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:20:11.932414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263929A0260>]}
[0m13:20:12.026611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:20:12.042556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:20:12.074479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026392C9D1F0>]}
[0m13:20:12.074479 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:20:12.074479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026382120FB0>]}
[0m13:20:12.074479 [info ] [MainThread]: 
[0m13:20:12.074479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:12.074479 [info ] [MainThread]: 
[0m13:20:12.074479 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:20:12.090284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:20:12.203521 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:20:12.203521 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:20:12.203521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:13.711340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.501 seconds
[0m13:20:13.722353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m13:20:13.729499 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:20:13.729499 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:20:13.729499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:14.733059 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.000 seconds
[0m13:20:14.737923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m13:20:14.741933 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:20:14.741933 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:20:14.959643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m13:20:14.965708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m13:20:14.969988 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:20:14.969988 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:20:15.184541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m13:20:15.186582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263926A7CE0>]}
[0m13:20:15.186582 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:20:15.186582 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:20:15.186582 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:20:15.186582 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:20:15.204539 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:20:15.207604 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:20:15.245451 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:20:15.247417 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:20:15.248452 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID,
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN DE_MINI_PROJECT.staging.stg_products rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


WITH int_rank_products AS(
SELECT
    p.product_id,
    SUM(t.revenue) AS total_revenue,
    RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
FROM
    DE_MINI_PROJECT.staging.stg_transactions t
JOIN
    DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
GROUP BY
    p.product_id
ORDER BY
    total_revenue DESC
)
SELECT * FROM int_rank_products
        );
[0m13:20:15.249452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:16.674276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.437 seconds
[0m13:20:16.706217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04dceb9b-c483-4668-b96c-49846374535f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026382E3B530>]}
[0m13:20:16.706217 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.52s]
[0m13:20:16.706217 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:20:16.706217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:16.706217 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:20:16.706217 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:20:17.057744 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m13:20:17.057744 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m13:20:17.384707 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:20:17.384707 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:20:17.725489 [info ] [MainThread]: 
[0m13:20:17.725489 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m13:20:17.725489 [debug] [MainThread]: Command end result
[0m13:20:17.747990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:20:17.747990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:20:17.767187 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:20:17.767187 [info ] [MainThread]: 
[0m13:20:17.767187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:17.767187 [info ] [MainThread]: 
[0m13:20:17.767187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:20:17.767187 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:17.767187 after 8.47 seconds
[0m13:20:17.767187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263855F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263855FB0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263855F9F10>]}
[0m13:20:17.767187 [debug] [MainThread]: Flushing usage events
[0m13:20:19.051597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:54.542300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021013B873E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021013B85D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021013B85F70>]}


============================== 13:20:54.549035 | ea4740b2-8644-4551-ab07-d069a4ba5bba ==============================
[0m13:20:54.549035 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:20:54.549391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:55.771782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101FD91040>]}
[0m13:20:55.849047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020810740>]}
[0m13:20:55.849047 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:20:56.414469 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:20:56.645225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:56.645225 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:20:56.982652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020E3FEF0>]}
[0m13:20:57.080658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:20:57.085468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:20:57.117502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020DD0FB0>]}
[0m13:20:57.117502 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:20:57.117502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020D2F0B0>]}
[0m13:20:57.117502 [info ] [MainThread]: 
[0m13:20:57.117502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:57.117502 [info ] [MainThread]: 
[0m13:20:57.117502 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:20:57.117502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:20:57.247340 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:20:57.247340 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:20:57.247340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:58.572790 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.320 seconds
[0m13:20:58.588496 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:20:58.588496 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:20:58.588496 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:20:58.588496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:59.574812 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.971 seconds
[0m13:20:59.574812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m13:20:59.590592 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:20:59.590592 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:20:59.787109 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.196 seconds
[0m13:20:59.787109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:20:59.787109 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:20:59.787109 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:20:59.997342 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.211 seconds
[0m13:21:00.019284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210207D7AD0>]}
[0m13:21:00.023301 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:21:00.023301 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:21:00.025310 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:21:00.025310 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:21:00.034896 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:21:00.034896 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:21:00.076954 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:21:00.078919 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:21:00.079957 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:21:00.079957 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:01.576082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.501 seconds
[0m13:21:01.608079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea4740b2-8644-4551-ab07-d069a4ba5bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021010F27350>]}
[0m13:21:01.608079 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.58s]
[0m13:21:01.608079 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:21:01.608079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:01.608079 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:21:01.608079 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:21:01.939107 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m13:21:01.940094 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m13:21:02.255059 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:21:02.255059 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:21:02.596013 [info ] [MainThread]: 
[0m13:21:02.596013 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m13:21:02.599796 [debug] [MainThread]: Command end result
[0m13:21:02.627503 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:21:02.628503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:21:02.638108 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:21:02.639106 [info ] [MainThread]: 
[0m13:21:02.639908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:02.639908 [info ] [MainThread]: 
[0m13:21:02.639908 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:02.639908 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:02.639908 after 8.32 seconds
[0m13:21:02.639908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101309D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021013B9FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021013B9FCB0>]}
[0m13:21:02.639908 [debug] [MainThread]: Flushing usage events
[0m13:21:03.573126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:37.314453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD801443E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DDFF764380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DDFF793AA0>]}


============================== 13:21:37.320688 | db4dcf77-dc6a-4482-9877-8c51cfd4f478 ==============================
[0m13:21:37.320688 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:21:37.321656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:38.536865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8CD46000>]}
[0m13:21:38.609085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DDFFAACE60>]}
[0m13:21:38.616138 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:21:39.178954 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:21:39.409608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:39.409608 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:21:39.768909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8D3AFEC0>]}
[0m13:21:39.856109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:21:39.871817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:21:39.910247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8D0ECA40>]}
[0m13:21:39.910247 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:21:39.910247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8D13EE10>]}
[0m13:21:39.919182 [info ] [MainThread]: 
[0m13:21:39.919182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:39.919182 [info ] [MainThread]: 
[0m13:21:39.919182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:39.919182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:21:40.039700 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:21:40.039700 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:21:40.039700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:41.495380 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.456 seconds
[0m13:21:41.514921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:21:41.527146 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:21:41.527146 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:21:41.527146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:42.511173 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.983 seconds
[0m13:21:42.512014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m13:21:42.512014 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:21:42.512014 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:21:42.712771 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m13:21:42.728325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m13:21:42.728325 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:21:42.728325 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:21:42.929690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m13:21:42.944773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD8E8639B0>]}
[0m13:21:42.944773 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:21:42.944773 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:21:42.944773 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:21:42.957094 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:21:42.969705 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:21:42.969705 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:21:43.013708 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:21:43.015675 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:21:43.016708 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:21:43.016708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:44.408191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.399 seconds
[0m13:21:44.439685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4dcf77-dc6a-4482-9877-8c51cfd4f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DDFD477350>]}
[0m13:21:44.439685 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.49s]
[0m13:21:44.439685 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:21:44.439685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:44.439685 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:21:44.439685 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:21:44.784082 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:21:44.785048 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:21:45.102552 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:21:45.102552 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:21:45.572683 [info ] [MainThread]: 
[0m13:21:45.572683 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m13:21:45.572683 [debug] [MainThread]: Command end result
[0m13:21:45.603156 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:21:45.604158 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:21:45.613235 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:21:45.614250 [info ] [MainThread]: 
[0m13:21:45.615161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:45.616108 [info ] [MainThread]: 
[0m13:21:45.616108 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:45.616108 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:45.616108 after 8.52 seconds
[0m13:21:45.616108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DDFF6DBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DD80038A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DDFFC6CEC0>]}
[0m13:21:45.616108 [debug] [MainThread]: Flushing usage events
[0m13:21:46.526992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:24.930320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1C677470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1C675130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1C6754F0>]}


============================== 13:23:24.930320 | 6d62e3a3-95b5-4a07-ba5c-5f398a05d15e ==============================
[0m13:23:24.930320 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:24.930320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi6', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:23:28.788925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC29099C70>]}
[0m13:23:28.863515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC28F23A40>]}
[0m13:23:28.863515 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:23:29.604907 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:23:31.205880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:31.205880 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:23:31.554683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2978C530>]}
[0m13:23:31.655183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:23:31.676875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:23:31.716052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC29854E60>]}
[0m13:23:31.718059 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:23:31.718059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC293823F0>]}
[0m13:23:31.718059 [info ] [MainThread]: 
[0m13:23:31.718059 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:31.718059 [info ] [MainThread]: 
[0m13:23:31.718059 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:31.718059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:23:35.141495 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:23:35.141495 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:23:35.142490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:36.707441 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.576 seconds
[0m13:23:36.721175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m13:23:36.737113 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:23:36.737113 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:23:36.737113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:37.712146 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.973 seconds
[0m13:23:37.714146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:23:37.717147 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:23:37.717147 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:23:38.020477 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.310 seconds
[0m13:23:38.020477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m13:23:38.020477 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:23:38.020477 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:23:38.224867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.198 seconds
[0m13:23:38.224867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2939EF30>]}
[0m13:23:38.240678 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:23:38.240678 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:23:38.240678 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:23:38.240678 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:23:38.262311 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:23:38.262843 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:23:38.303136 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:23:38.305102 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:23:38.306136 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID,PRODUCT_FAMILY
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:23:38.306136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:39.427186 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff79-3201-7d7b-000c-3d5a00022762
[0m13:23:39.428194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 24
invalid identifier 'PRODUCT_FAMILY'
[0m13:23:39.445277 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 8 at position 24
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:23:39.447285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d62e3a3-95b5-4a07-ba5c-5f398a05d15e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1BB1D4F0>]}
[0m13:23:39.447285 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 1.20s]
[0m13:23:39.447285 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:23:39.447285 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 8 at position 24
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m13:23:39.447285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:39.447285 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:23:39.447285 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:23:39.769687 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:23:39.769687 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:23:40.105231 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:23:40.105231 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:23:40.429221 [info ] [MainThread]: 
[0m13:23:40.429221 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m13:23:40.429221 [debug] [MainThread]: Command end result
[0m13:23:40.465347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:23:40.469416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:23:40.470522 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:23:40.470522 [info ] [MainThread]: 
[0m13:23:40.479599 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:23:40.480585 [info ] [MainThread]: 
[0m13:23:40.481585 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 8 at position 24
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:23:40.482586 [info ] [MainThread]: 
[0m13:23:40.482586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:23:40.486819 [debug] [MainThread]: Command `dbt run` failed at 13:23:40.486819 after 15.79 seconds
[0m13:23:40.486819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1C64CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC2952C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1A39DD30>]}
[0m13:23:40.488017 [debug] [MainThread]: Flushing usage events
[0m13:23:41.747253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:56.641983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D950B74C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D950B77560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D950B766F0>]}


============================== 13:23:56.656141 | 9a27afd0-e9e8-4f74-ab17-8238aceab934 ==============================
[0m13:23:56.656141 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:23:56.656141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:23:57.850796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95D790BC0>]}
[0m13:23:57.930035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95D75ACC0>]}
[0m13:23:57.930035 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:23:58.522067 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:23:58.747579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:58.747579 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:23:59.087869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95DD9FBC0>]}
[0m13:23:59.182234 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:23:59.182234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:23:59.229565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95DADCC80>]}
[0m13:23:59.229565 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:23:59.229565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95D7C7E00>]}
[0m13:23:59.229565 [info ] [MainThread]: 
[0m13:23:59.229565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:59.229565 [info ] [MainThread]: 
[0m13:23:59.229565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:59.238015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:23:59.361966 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:23:59.361966 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:23:59.361966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:00.707083 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.341 seconds
[0m13:24:00.715989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m13:24:00.728266 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:24:00.728266 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:24:00.729266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:01.699846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.970 seconds
[0m13:24:01.699846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:24:01.699846 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:24:01.699846 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:24:01.914288 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m13:24:01.914288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:24:01.914288 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:24:01.914288 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:24:02.128877 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m13:24:02.140203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95DB2AED0>]}
[0m13:24:02.140203 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:24:02.140203 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:24:02.140203 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:24:02.140203 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:24:02.157293 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:24:02.159040 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:24:02.198528 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:24:02.200530 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:24:02.201563 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID,PRODUCT_FAMILY
)
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:24:02.202563 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:24:03.182304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff7a-3201-7e56-000c-3d5a000235e6
[0m13:24:03.182304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 0 unexpected 'ranked_products'.
syntax error line 14 at position 21 unexpected 'OVER'.
[0m13:24:03.182304 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected 'ranked_products'.
  syntax error line 14 at position 21 unexpected 'OVER'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:24:03.182304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a27afd0-e9e8-4f74-ab17-8238aceab934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D950021340>]}
[0m13:24:03.182304 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 1.04s]
[0m13:24:03.197989 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:24:03.198530 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected 'ranked_products'.
  syntax error line 14 at position 21 unexpected 'OVER'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m13:24:03.198530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:03.198530 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:24:03.198530 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:24:03.521203 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m13:24:03.523221 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m13:24:03.833973 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:24:03.833973 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:24:04.166208 [info ] [MainThread]: 
[0m13:24:04.166208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m13:24:04.166208 [debug] [MainThread]: Command end result
[0m13:24:04.203507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:24:04.206504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:24:04.207539 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:24:04.207539 [info ] [MainThread]: 
[0m13:24:04.207539 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:24:04.207539 [info ] [MainThread]: 
[0m13:24:04.207539 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected 'ranked_products'.
  syntax error line 14 at position 21 unexpected 'OVER'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:24:04.207539 [info ] [MainThread]: 
[0m13:24:04.217869 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:24:04.219878 [debug] [MainThread]: Command `dbt run` failed at 13:24:04.219878 after 7.77 seconds
[0m13:24:04.220881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9508FDF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D95DA2C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9508430B0>]}
[0m13:24:04.221599 [debug] [MainThread]: Flushing usage events
[0m13:24:05.116378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:32.185769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024232DBF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024232F22A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024232F22EA0>]}


============================== 13:25:32.189223 | fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb ==============================
[0m13:25:32.189223 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:25:32.189223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:33.431941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002423E892D80>]}
[0m13:25:33.501349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002423F853680>]}
[0m13:25:33.501349 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:25:34.082116 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:25:34.324704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:34.324704 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:25:34.691305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002423FA078C0>]}
[0m13:25:34.791997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:25:34.791997 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:25:34.825355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002423FF04DD0>]}
[0m13:25:34.825355 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:25:34.825355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002423FC1E570>]}
[0m13:25:34.842026 [info ] [MainThread]: 
[0m13:25:34.842026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:34.842026 [info ] [MainThread]: 
[0m13:25:34.842026 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:34.845975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:25:34.962641 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:25:34.962641 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:25:34.962641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:36.445990 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.473 seconds
[0m13:25:36.459309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m13:25:36.475462 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:25:36.476287 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:25:36.476287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:37.431373 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.956 seconds
[0m13:25:37.431373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:25:37.445901 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:25:37.446221 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:25:37.662296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.224 seconds
[0m13:25:37.671385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m13:25:37.675402 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:25:37.675910 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:25:37.862709 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.196 seconds
[0m13:25:37.876227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024231EC3B30>]}
[0m13:25:37.879609 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:25:37.879609 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:25:37.879609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:25:37.879609 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:25:37.879609 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:25:37.879609 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:25:37.934764 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:25:37.936770 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:25:37.936770 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID,PRODUCT_FAMILY
)
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank,
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:25:37.938778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:38.824514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff7b-3201-7e56-000c-3d5a000235ee
[0m13:25:38.824514 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 0 unexpected 'ranked_products'.
syntax error line 14 at position 21 unexpected 'OVER'.
[0m13:25:38.824514 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected 'ranked_products'.
  syntax error line 14 at position 21 unexpected 'OVER'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:25:38.840462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd34bf52-5b8f-4f43-ae66-7f64c00fb7cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024241778740>]}
[0m13:25:38.840462 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 0.94s]
[0m13:25:38.840462 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:25:38.840462 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected 'ranked_products'.
  syntax error line 14 at position 21 unexpected 'OVER'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m13:25:38.840462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:38.840462 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:25:38.840462 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:25:39.179443 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:25:39.179443 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:25:39.504613 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:25:39.504613 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:25:39.836707 [info ] [MainThread]: 
[0m13:25:39.837671 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m13:25:39.838671 [debug] [MainThread]: Command end result
[0m13:25:39.867150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:25:39.871160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:25:39.879769 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:25:39.879769 [info ] [MainThread]: 
[0m13:25:39.881823 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:25:39.882792 [info ] [MainThread]: 
[0m13:25:39.883790 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 0 unexpected 'ranked_products'.
  syntax error line 14 at position 21 unexpected 'OVER'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:25:39.884791 [info ] [MainThread]: 
[0m13:25:39.885788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:25:39.887792 [debug] [MainThread]: Command `dbt run` failed at 13:25:39.886793 after 7.92 seconds
[0m13:25:39.888230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024232DBF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024230A40800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242326A4500>]}
[0m13:25:39.888230 [debug] [MainThread]: Flushing usage events
[0m13:25:41.098637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:48.009288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF1D55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF1D7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEF1D5850>]}


============================== 13:25:48.015315 | eddad431-e557-48b4-9d58-f904d656e19f ==============================
[0m13:25:48.015315 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:25:48.015315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi6', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:25:49.245374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFBC805F0>]}
[0m13:25:49.320193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFBD3E750>]}
[0m13:25:49.320193 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:25:49.892769 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:25:50.099970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:50.099970 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:25:50.457636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFC45FCE0>]}
[0m13:25:50.559673 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:25:50.559673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:25:50.609472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFC414E00>]}
[0m13:25:50.609472 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:25:50.609472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFC208E30>]}
[0m13:25:50.609472 [info ] [MainThread]: 
[0m13:25:50.609472 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:50.609472 [info ] [MainThread]: 
[0m13:25:50.609472 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:50.609472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:25:50.741595 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:25:50.741595 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:25:50.741595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:52.170300 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.436 seconds
[0m13:25:52.186007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m13:25:52.203402 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:25:52.203402 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:25:52.204399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:53.159960 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.957 seconds
[0m13:25:53.168049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:25:53.179687 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:25:53.179687 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:25:53.360259 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.190 seconds
[0m13:25:53.379703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m13:25:53.393780 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:25:53.394801 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:25:53.604012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m13:25:53.607950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFC2C8B60>]}
[0m13:25:53.610151 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:25:53.611839 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:25:53.613211 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:25:53.613211 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:25:53.623288 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:25:53.624288 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:25:53.665208 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:25:53.667209 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:25:53.668208 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID,PRODUCT_FAMILY
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:25:53.668208 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:54.631974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff7b-3201-7db6-000c-3d5a000208f2
[0m13:25:54.633981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 24
invalid identifier 'PRODUCT_FAMILY'
[0m13:25:54.638426 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 8 at position 24
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:25:54.638426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eddad431-e557-48b4-9d58-f904d656e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEE681970>]}
[0m13:25:54.641645 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 1.03s]
[0m13:25:54.641645 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:25:54.641645 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 8 at position 24
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m13:25:54.641645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:54.641645 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:25:54.641645 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:25:54.974582 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m13:25:54.974582 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m13:25:55.308761 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:25:55.308761 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:25:55.632117 [info ] [MainThread]: 
[0m13:25:55.633152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m13:25:55.635117 [debug] [MainThread]: Command end result
[0m13:25:55.667715 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:25:55.669717 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:25:55.669717 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:25:55.669717 [info ] [MainThread]: 
[0m13:25:55.678841 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:25:55.679853 [info ] [MainThread]: 
[0m13:25:55.680850 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 8 at position 24
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:25:55.681875 [info ] [MainThread]: 
[0m13:25:55.681875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:25:55.685038 [debug] [MainThread]: Command `dbt run` failed at 13:25:55.685038 after 7.92 seconds
[0m13:25:55.685038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AEED3AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AECF98290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AECF98260>]}
[0m13:25:55.686081 [debug] [MainThread]: Flushing usage events
[0m13:25:56.573061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:19.500772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D30D47020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D30D47500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D30D46630>]}


============================== 13:26:19.505463 | 673079ce-182c-40f5-a792-cf3b272036b3 ==============================
[0m13:26:19.505463 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:19.505463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi6', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:26:20.691206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D302AAC60>]}
[0m13:26:20.769141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3D9A5280>]}
[0m13:26:20.769141 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:26:21.351588 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:26:21.571067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:21.571067 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:26:21.907929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3E00FF50>]}
[0m13:26:22.008290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:26:22.010807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:26:22.042264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3DF9CEF0>]}
[0m13:26:22.042264 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:26:22.042264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3E003110>]}
[0m13:26:22.058153 [info ] [MainThread]: 
[0m13:26:22.058153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:22.058153 [info ] [MainThread]: 
[0m13:26:22.058153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:22.061892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:26:22.171621 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:26:22.171621 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:26:22.187327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:23.536275 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.362 seconds
[0m13:26:23.552221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:26:23.568079 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:26:23.568079 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:26:23.568079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:24.522782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.961 seconds
[0m13:26:24.522782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m13:26:24.538822 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:26:24.538822 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:26:24.733721 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m13:26:24.733721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m13:26:24.733721 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:26:24.733721 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:26:24.928742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.188 seconds
[0m13:26:24.928742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D2E1E0FE0>]}
[0m13:26:24.928742 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:26:24.928742 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:26:24.928742 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:26:24.928742 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:26:24.949681 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:26:24.950779 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:26:24.989657 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:26:24.992406 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:26:24.993405 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID, pRODUCT_FAMILY,
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID,PRODUCT_FAMILY
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:26:24.994406 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:25.936939 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff7c-3201-7d7b-000c-3d5a0002277a
[0m13:26:25.936939 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 20
invalid identifier 'PRODUCT_FAMILY'
[0m13:26:25.942961 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 5 at position 20
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:26:25.944710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '673079ce-182c-40f5-a792-cf3b272036b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3F4C1370>]}
[0m13:26:25.944710 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 1.01s]
[0m13:26:25.944710 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:26:25.944710 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 5 at position 20
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m13:26:25.944710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:25.944710 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:26:25.944710 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:26:26.270538 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m13:26:26.270538 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m13:26:26.608416 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:26:26.608416 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:26:26.935507 [info ] [MainThread]: 
[0m13:26:26.935507 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m13:26:26.935507 [debug] [MainThread]: Command end result
[0m13:26:26.966649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:26:26.967614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:26:26.977681 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:26:26.977681 [info ] [MainThread]: 
[0m13:26:26.979677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:26:26.979677 [info ] [MainThread]: 
[0m13:26:26.979677 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 5 at position 20
  invalid identifier 'PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:26:26.979677 [info ] [MainThread]: 
[0m13:26:26.979677 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:26:26.984964 [debug] [MainThread]: Command `dbt run` failed at 13:26:26.984964 after 7.68 seconds
[0m13:26:26.986008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3011DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3E00FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3031F1A0>]}
[0m13:26:26.986008 [debug] [MainThread]: Flushing usage events
[0m13:26:27.886273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:47.767502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021029F65580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102959BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021029F656D0>]}


============================== 13:26:47.773540 | d931c897-3f50-414c-9720-984d0db8ec2b ==============================
[0m13:26:47.773540 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:47.774537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi6', 'send_anonymous_usage_stats': 'True'}
[0m13:26:48.958422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021036B4CB00>]}
[0m13:26:49.037114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210272241D0>]}
[0m13:26:49.039117 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:26:49.631042 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:26:49.856351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:49.856351 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:26:50.184302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103720FEC0>]}
[0m13:26:50.295147 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:26:50.302149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:26:50.326650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210371A0CE0>]}
[0m13:26:50.342295 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:26:50.342295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021036EA31D0>]}
[0m13:26:50.342295 [info ] [MainThread]: 
[0m13:26:50.342295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:50.342295 [info ] [MainThread]: 
[0m13:26:50.342295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:26:50.342295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:26:50.465479 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:26:50.465479 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:26:50.465479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:51.838800 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.367 seconds
[0m13:26:51.851581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:26:51.864847 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:26:51.864847 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:26:51.864847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:52.844052 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.988 seconds
[0m13:26:52.859871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m13:26:52.865640 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:26:52.866196 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:26:53.054532 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.191 seconds
[0m13:26:53.054532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m13:26:53.070938 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:26:53.070938 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:26:53.271119 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m13:26:53.291547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021036CF0680>]}
[0m13:26:53.294887 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:26:53.294887 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:26:53.294887 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:26:53.294887 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:26:53.311180 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:26:53.311180 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:26:53.353552 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:26:53.353552 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:26:53.353552 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID, 
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN DE_MINI_PROJECT.staging.stg_products rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:26:53.353552 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:54.698653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m13:26:54.730280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd931c897-3f50-414c-9720-984d0db8ec2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102730B4D0>]}
[0m13:26:54.730280 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.42s]
[0m13:26:54.730280 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:26:54.730280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:54.730280 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:26:54.730280 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:26:55.076851 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:26:55.078851 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:26:55.404709 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:26:55.404709 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:26:55.757508 [info ] [MainThread]: 
[0m13:26:55.757508 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m13:26:55.757508 [debug] [MainThread]: Command end result
[0m13:26:55.788693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:26:55.792501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:26:55.792501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:26:55.792501 [info ] [MainThread]: 
[0m13:26:55.792501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:55.792501 [info ] [MainThread]: 
[0m13:26:55.805317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:26:55.808359 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:55.808359 after 8.25 seconds
[0m13:26:55.808359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021028FF8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021028FFB3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021028FFAE40>]}
[0m13:26:55.809393 [debug] [MainThread]: Flushing usage events
[0m13:26:57.270533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:19.606846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037E9265A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037E9275F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037E925370>]}


============================== 13:28:19.613814 | 1ef2a2cb-5138-4917-9eda-057acd223663 ==============================
[0m13:28:19.613814 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:28:19.614780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi6', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:21.005957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030B4DEAB0>]}
[0m13:28:21.096183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037F221CD0>]}
[0m13:28:21.096183 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:28:21.691017 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:28:21.933605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:21.934604 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m13:28:22.304976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030BAED760>]}
[0m13:28:22.415242 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:28:22.415242 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:28:22.470115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030BBB4C80>]}
[0m13:28:22.470115 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m13:28:22.470115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030BAB1130>]}
[0m13:28:22.470115 [info ] [MainThread]: 
[0m13:28:22.470115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:22.474981 [info ] [MainThread]: 
[0m13:28:22.476081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:22.478079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m13:28:22.598601 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m13:28:22.598601 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m13:28:22.598601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:23.999620 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.398 seconds
[0m13:28:23.999620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m13:28:24.015256 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m13:28:24.015256 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m13:28:24.015256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:24.992183 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.971 seconds
[0m13:28:24.992183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m13:28:24.992183 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m13:28:24.992183 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m13:28:25.199516 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.195 seconds
[0m13:28:25.199516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m13:28:25.215361 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m13:28:25.215361 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m13:28:25.407563 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m13:28:25.423502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037F4A9AC0>]}
[0m13:28:25.432918 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m13:28:25.432918 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m13:28:25.432918 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m13:28:25.432918 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m13:28:25.447138 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m13:28:25.447138 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m13:28:25.486693 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m13:28:25.486693 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m13:28:25.486693 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        PRODUCT_ID, 
        SUM(revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT 
    rc.PRODUCT_ID,
    rp.PRODUCT_FAMILY,
    rc.total_products_revenue,
    rc.revenue_rank
FROM ranked_products rc
JOIN PRODUCT_REVENUE rp
    ON rc.product_id = rp.product_id
ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m13:28:25.486693 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:26.385557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff7e-3201-7e57-000c-3d5a0001fb12
[0m13:28:26.385557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 4
invalid identifier 'RP.PRODUCT_FAMILY'
[0m13:28:26.385557 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'RP.PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:28:26.385557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef2a2cb-5138-4917-9eda-057acd223663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002037DDD9640>]}
[0m13:28:26.385557 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 0.95s]
[0m13:28:26.401262 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m13:28:26.401262 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'RP.PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m13:28:26.401262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:26.401262 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m13:28:26.401262 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m13:28:26.722569 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m13:28:26.722569 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m13:28:27.045916 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m13:28:27.045916 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m13:28:27.385218 [info ] [MainThread]: 
[0m13:28:27.385218 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m13:28:27.385218 [debug] [MainThread]: Command end result
[0m13:28:27.416936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m13:28:27.416936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m13:28:27.416936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m13:28:27.431781 [info ] [MainThread]: 
[0m13:28:27.432794 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:28:27.432794 [info ] [MainThread]: 
[0m13:28:27.432794 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'RP.PRODUCT_FAMILY'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m13:28:27.432794 [info ] [MainThread]: 
[0m13:28:27.432794 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:28:27.432794 [debug] [MainThread]: Command `dbt run` failed at 13:28:27.432794 after 8.05 seconds
[0m13:28:27.432794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030BA9A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030BA99E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030B597F80>]}
[0m13:28:27.432794 [debug] [MainThread]: Flushing usage events
[0m13:28:28.347976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:09.734209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E4B41E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E50B7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E50B5F70>]}


============================== 14:04:09.754006 | 451d8f99-f28a-44fa-9772-963421935079 ==============================
[0m14:04:09.754006 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:04:09.757009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:14.187335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9EF8738F0>]}
[0m14:04:14.266680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F1D3F050>]}
[0m14:04:14.266680 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:04:15.023502 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:04:16.669231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:16.669231 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m14:04:17.014701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F233C1A0>]}
[0m14:04:17.110086 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:04:17.125799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:04:17.196008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F22F4F80>]}
[0m14:04:17.196008 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m14:04:17.196008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F230B830>]}
[0m14:04:17.199269 [info ] [MainThread]: 
[0m14:04:17.199269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:17.199269 [info ] [MainThread]: 
[0m14:04:17.199269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:17.199269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:04:20.528852 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:04:20.528852 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:04:20.528852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:22.129776 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.593 seconds
[0m14:04:22.142170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m14:04:22.155473 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:04:22.155473 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:04:22.157481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:23.199706 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.056 seconds
[0m14:04:23.215524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m14:04:23.215524 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:04:23.215524 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:04:23.457831 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.237 seconds
[0m14:04:23.465790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m14:04:23.473743 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:04:23.473743 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:04:23.690939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m14:04:23.694949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F1CD78C0>]}
[0m14:04:23.698959 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m14:04:23.698959 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m14:04:23.700708 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m14:04:23.700708 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m14:04:23.700708 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m14:04:23.700708 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m14:04:23.753459 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m14:04:23.755486 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m14:04:23.756486 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        p.PRODUCT_FAMILY,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        PRODUCT_FAMILY,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank;
[0m14:04:23.756486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:24.902240 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa2-3201-7e56-000c-3d5a00023626
[0m14:04:24.902240 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 21 unexpected ';'.
[0m14:04:24.933705 [debug] [Thread-1 (]: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 21 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m14:04:24.933705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '451d8f99-f28a-44fa-9772-963421935079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E4561970>]}
[0m14:04:24.933705 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi6 ........................ [[31mERROR[0m in 1.23s]
[0m14:04:24.933705 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m14:04:24.933705 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 21 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql.
[0m14:04:24.933705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:24.933705 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:04:24.933705 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:04:25.282920 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m14:04:25.282920 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m14:04:25.613877 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m14:04:25.615887 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m14:04:25.941248 [info ] [MainThread]: 
[0m14:04:25.941248 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.73 seconds (8.73s).
[0m14:04:25.941248 [debug] [MainThread]: Command end result
[0m14:04:25.971425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:04:25.977115 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:04:25.979125 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:04:25.979125 [info ] [MainThread]: 
[0m14:04:25.979125 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:04:25.979125 [info ] [MainThread]: 
[0m14:04:25.979125 [error] [MainThread]:   Database Error in model kpi6 (models\intermediate\kpi6.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 21 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi6.sql
[0m14:04:25.979125 [info ] [MainThread]: 
[0m14:04:25.979125 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:04:25.979125 [debug] [MainThread]: Command `dbt run` failed at 14:04:25.979125 after 16.51 seconds
[0m14:04:25.992707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E47E9D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E4C1EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F233BDA0>]}
[0m14:04:25.992707 [debug] [MainThread]: Flushing usage events
[0m14:04:27.291528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:48.277883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9ADC60C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9ADC7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9ADC64E0>]}


============================== 14:04:48.293713 | 9f061800-8534-4d64-ab61-7b6f9f5c978b ==============================
[0m14:04:48.293713 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:04:48.293713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi6', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:49.514794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA6B4AE40>]}
[0m14:04:49.594361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA6A80470>]}
[0m14:04:49.594361 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:04:50.177510 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:04:50.396170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:50.396170 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m14:04:50.747221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA802C200>]}
[0m14:04:50.840215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:04:50.853026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:04:50.890735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA7CC24E0>]}
[0m14:04:50.890735 [info ] [MainThread]: Found 8 models, 1 seed, 4 sources, 473 macros
[0m14:04:50.890735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA802EDE0>]}
[0m14:04:50.890735 [info ] [MainThread]: 
[0m14:04:50.890735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:50.890735 [info ] [MainThread]: 
[0m14:04:50.899072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:50.899072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:04:51.018169 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:04:51.018169 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:04:51.018169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:52.383986 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.371 seconds
[0m14:04:52.400108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m14:04:52.416241 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:04:52.416241 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:04:52.416241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:53.418169 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.002 seconds
[0m14:04:53.420173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m14:04:53.423925 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:04:53.423925 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:04:53.620430 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.195 seconds
[0m14:04:53.622441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m14:04:53.626463 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:04:53.626463 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:04:53.838421 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.216 seconds
[0m14:04:53.844883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BA806DC40>]}
[0m14:04:53.844883 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m14:04:53.844883 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m14:04:53.844883 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m14:04:53.844883 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m14:04:53.854255 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m14:04:53.854255 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m14:04:53.888935 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m14:04:53.905838 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m14:04:53.906873 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        p.PRODUCT_FAMILY,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID, p.PRODUCT_FAMILY
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        PRODUCT_FAMILY,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m14:04:53.906873 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:55.687281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m14:04:55.721736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f061800-8534-4d64-ab61-7b6f9f5c978b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B981673E0>]}
[0m14:04:55.721736 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.88s]
[0m14:04:55.721736 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m14:04:55.721736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:55.721736 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:04:55.721736 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:04:56.066032 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m14:04:56.066032 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m14:04:56.388365 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m14:04:56.389371 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m14:04:56.705833 [info ] [MainThread]: 
[0m14:04:56.705833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m14:04:56.705833 [debug] [MainThread]: Command end result
[0m14:04:56.740558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:04:56.740558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:04:56.740558 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:04:56.740558 [info ] [MainThread]: 
[0m14:04:56.740558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:56.755751 [info ] [MainThread]: 
[0m14:04:56.756764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:56.759525 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:56.757299 after 8.67 seconds
[0m14:04:56.759525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9A2A5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9AABD580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B9AABE000>]}
[0m14:04:56.760570 [debug] [MainThread]: Flushing usage events
[0m14:04:57.675004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:33.193970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521F9A7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521F9A7B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521F9A5A30>]}


============================== 14:14:33.212730 | cd827cd0-ebea-4826-8fee-7582a27c2f6d ==============================
[0m14:14:33.212730 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:14:33.212730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi5', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:37.072630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522C2F8D70>]}
[0m14:14:37.152425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522B9880E0>]}
[0m14:14:37.152425 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:14:37.888696 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:14:39.486802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:14:39.486802 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:14:39.826063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522CBC8620>]}
[0m14:14:39.912812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:14:39.941645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:14:39.979705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522CB7D220>]}
[0m14:14:39.982820 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:14:39.982820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522CA9E900>]}
[0m14:14:39.982820 [info ] [MainThread]: 
[0m14:14:39.982820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:39.982820 [info ] [MainThread]: 
[0m14:14:39.982820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:14:39.982820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:14:43.290808 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:14:43.290808 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:14:43.290808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:44.740822 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.452 seconds
[0m14:14:44.751383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m14:14:44.765694 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:14:44.765694 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:14:44.766693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:45.695871 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.935 seconds
[0m14:14:45.695871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m14:14:45.695871 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:14:45.695871 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:14:45.924637 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.229 seconds
[0m14:14:45.942768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m14:14:45.946703 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:14:45.948715 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:14:46.197706 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.252 seconds
[0m14:14:46.197706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522DF6A480>]}
[0m14:14:46.197706 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:14:46.197706 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:14:46.197706 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:14:46.197706 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:14:46.213535 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:14:46.213535 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:14:46.256639 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:14:46.262224 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:14:46.263259 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    fiscal_year,
    new_logos_count
FROM new_logos_by_fy;
[0m14:14:46.263259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:47.412740 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffac-3201-7e9a-000c-3d5a00021336
[0m14:14:47.412740 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 20 unexpected ';'.
[0m14:14:47.428610 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 20 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:14:47.428610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd827cd0-ebea-4826-8fee-7582a27c2f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521EE4DA60>]}
[0m14:14:47.443715 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 1.23s]
[0m14:14:47.445277 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:14:47.445277 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 20 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m14:14:47.445277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:47.445277 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:14:47.445277 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:14:47.773469 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m14:14:47.773469 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m14:14:48.091810 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:14:48.091810 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:14:48.430756 [info ] [MainThread]: 
[0m14:14:48.430756 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m14:14:48.430756 [debug] [MainThread]: Command end result
[0m14:14:48.481715 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:14:48.481715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:14:48.481715 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:14:48.481715 [info ] [MainThread]: 
[0m14:14:48.481715 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:14:48.481715 [info ] [MainThread]: 
[0m14:14:48.495688 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 20 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:14:48.496700 [info ] [MainThread]: 
[0m14:14:48.497251 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:14:48.500223 [debug] [MainThread]: Command `dbt run` failed at 14:14:48.497251 after 15.53 seconds
[0m14:14:48.500223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521F3AF9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521F4AE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002521F4DBF50>]}
[0m14:14:48.501266 [debug] [MainThread]: Flushing usage events
[0m14:14:49.415287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:01.790664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B536A53380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B53759C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B53759C170>]}


============================== 14:15:01.790664 | 22665c7d-198e-4b10-ad22-9b553d966351 ==============================
[0m14:15:01.790664 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:15:01.790664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi5', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:02.991610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54625A990>]}
[0m14:15:03.064705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5455C9C70>]}
[0m14:15:03.064705 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:15:03.645588 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:15:03.868593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:15:03.868593 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:15:04.211389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B546A48B00>]}
[0m14:15:04.311599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:15:04.314212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:15:04.353821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B546A0D790>]}
[0m14:15:04.353821 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:15:04.353821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54690AE70>]}
[0m14:15:04.353821 [info ] [MainThread]: 
[0m14:15:04.353821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:04.353821 [info ] [MainThread]: 
[0m14:15:04.353821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:04.364557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:15:04.478906 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:15:04.478906 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:15:04.478906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:05.962582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.479 seconds
[0m14:15:05.978460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m14:15:05.978460 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:15:05.978460 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:15:05.978460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:07.018533 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.026 seconds
[0m14:15:07.018533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m14:15:07.030584 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:15:07.030584 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:15:07.258879 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.229 seconds
[0m14:15:07.258879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m14:15:07.274699 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:15:07.274699 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:15:07.501941 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.227 seconds
[0m14:15:07.501941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B546533590>]}
[0m14:15:07.501941 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:15:07.501941 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:15:07.501941 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:15:07.501941 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:15:07.520983 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:15:07.520983 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:15:07.565705 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:15:07.568739 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:15:07.568739 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    fiscal_year,
    new_logos_count
FROM new_logos_by_fy
        );
[0m14:15:07.569739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:09.215882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.658 seconds
[0m14:15:09.247797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22665c7d-198e-4b10-ad22-9b553d966351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B536B77410>]}
[0m14:15:09.247797 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi5 ............................ [[32mSUCCESS 1[0m in 1.75s]
[0m14:15:09.247797 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:15:09.247797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:09.247797 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:15:09.247797 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:15:09.593449 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:15:09.593449 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:15:09.936326 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:15:09.936326 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:15:10.478206 [info ] [MainThread]: 
[0m14:15:10.478206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m14:15:10.478206 [debug] [MainThread]: Command end result
[0m14:15:10.522111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:15:10.525138 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:15:10.525138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:15:10.525138 [info ] [MainThread]: 
[0m14:15:10.525138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:10.534334 [info ] [MainThread]: 
[0m14:15:10.535345 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:10.537254 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:10.537254 after 8.95 seconds
[0m14:15:10.537254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B536A53380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5397F7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5397F7BC0>]}
[0m14:15:10.537254 [debug] [MainThread]: Flushing usage events
[0m14:15:11.452774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:22.884083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA85C46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA85B31370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA85C448C0>]}


============================== 14:19:22.884083 | c79ac58a-2447-4c2e-90e2-f61d157d5fd9 ==============================
[0m14:19:22.884083 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:19:22.884083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi5', 'send_anonymous_usage_stats': 'True'}
[0m14:19:24.077060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA914E6270>]}
[0m14:19:24.155874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9287E840>]}
[0m14:19:24.155874 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:19:24.753594 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:19:24.968936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:24.968936 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:19:25.318446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA92DDFA40>]}
[0m14:19:25.413651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:19:25.413651 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:19:25.460823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA92EA9460>]}
[0m14:19:25.461857 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:19:25.462822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA92DDD460>]}
[0m14:19:25.463822 [info ] [MainThread]: 
[0m14:19:25.465051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:25.466059 [info ] [MainThread]: 
[0m14:19:25.466059 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:25.467874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:19:25.588081 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:19:25.588081 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:19:25.588081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:27.070830 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.479 seconds
[0m14:19:27.073500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m14:19:27.088874 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:19:27.088874 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:19:27.088874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:28.089811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.998 seconds
[0m14:19:28.089811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m14:19:28.089811 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:19:28.089811 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:19:28.365266 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.271 seconds
[0m14:19:28.378320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m14:19:28.381336 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:19:28.381336 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:19:28.574351 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.192 seconds
[0m14:19:28.580421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA83091190>]}
[0m14:19:28.580421 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:19:28.589996 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:19:28.589996 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:19:28.589996 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:19:28.589996 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:19:28.589996 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:19:28.625296 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:19:28.642029 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:19:28.642029 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    SELECT YEAR('fiscal_year') AS Fiscal_year;
[0m14:19:28.642029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:19:29.575854 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb1-3201-7e9a-000c-3d5a0002133e
[0m14:19:29.575854 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 4 unexpected 'SELECT'.
syntax error line 20 at position 31 unexpected 'AS'.
[0m14:19:29.575854 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'SELECT'.
  syntax error line 20 at position 31 unexpected 'AS'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:19:29.575854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c79ac58a-2447-4c2e-90e2-f61d157d5fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA850F1520>]}
[0m14:19:29.591732 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 0.99s]
[0m14:19:29.591732 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:19:29.591732 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'SELECT'.
  syntax error line 20 at position 31 unexpected 'AS'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m14:19:29.591732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:29.591732 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:19:29.591732 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:19:29.901782 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m14:19:29.901782 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m14:19:30.226588 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:19:30.242455 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:19:30.566534 [info ] [MainThread]: 
[0m14:19:30.566534 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m14:19:30.566534 [debug] [MainThread]: Command end result
[0m14:19:30.600742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:19:30.600742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:19:30.612755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:19:30.612755 [info ] [MainThread]: 
[0m14:19:30.612755 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:19:30.612755 [info ] [MainThread]: 
[0m14:19:30.612755 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 4 unexpected 'SELECT'.
  syntax error line 20 at position 31 unexpected 'AS'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:19:30.612755 [info ] [MainThread]: 
[0m14:19:30.612755 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:30.612755 [debug] [MainThread]: Command `dbt run` failed at 14:19:30.612755 after 7.94 seconds
[0m14:19:30.612755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA8593DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA928A7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA85B31370>]}
[0m14:19:30.612755 [debug] [MainThread]: Flushing usage events
[0m14:19:31.527495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:46.760371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47F1B3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47F4B2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40170C080>]}


============================== 14:19:46.760371 | 92636638-9bf2-4f0f-980f-80080ccf33f9 ==============================
[0m14:19:46.760371 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:19:46.760371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi5', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:47.977057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40E26F0E0>]}
[0m14:19:48.040509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40E15AE70>]}
[0m14:19:48.056316 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:19:48.620279 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:19:48.853481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:48.853481 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:19:49.185761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40F2485C0>]}
[0m14:19:49.291433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:19:49.291433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:19:49.339042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40F1E9430>]}
[0m14:19:49.339042 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:19:49.339042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40F248C20>]}
[0m14:19:49.339042 [info ] [MainThread]: 
[0m14:19:49.339042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:49.339042 [info ] [MainThread]: 
[0m14:19:49.339042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:49.339042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:19:49.461799 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:19:49.461799 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:19:49.461799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:50.831801 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.358 seconds
[0m14:19:50.839759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m14:19:50.847833 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:19:50.847833 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:19:50.847833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:51.800662 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.952 seconds
[0m14:19:51.807616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m14:19:51.809623 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:19:51.809623 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:19:51.997513 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.189 seconds
[0m14:19:51.997513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m14:19:52.010870 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:19:52.010870 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:19:52.205944 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m14:19:52.205944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B40EBAD520>]}
[0m14:19:52.221706 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:19:52.221706 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:19:52.221706 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:19:52.221706 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:19:52.221706 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:19:52.221706 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:19:52.273751 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:19:52.276751 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:19:52.276751 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    YEAR('fiscal_year') AS Fiscal_year;
[0m14:19:52.277748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:19:53.255812 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb1-3201-7db6-000c-3d5a0002096e
[0m14:19:53.255812 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 38 unexpected ';'.
[0m14:19:53.255812 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 38 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:19:53.255812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92636638-9bf2-4f0f-980f-80080ccf33f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4106A6D20>]}
[0m14:19:53.255812 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 1.03s]
[0m14:19:53.255812 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:19:53.271954 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 38 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m14:19:53.271954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:53.271954 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:19:53.271954 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:19:53.600868 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:19:53.600868 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:19:53.933003 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:19:53.933003 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:19:54.257430 [info ] [MainThread]: 
[0m14:19:54.257430 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m14:19:54.257430 [debug] [MainThread]: Command end result
[0m14:19:54.291214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:19:54.291214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:19:54.302930 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:19:54.302930 [info ] [MainThread]: 
[0m14:19:54.302930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:19:54.302930 [info ] [MainThread]: 
[0m14:19:54.302930 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 38 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:19:54.302930 [info ] [MainThread]: 
[0m14:19:54.302930 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:54.302930 [debug] [MainThread]: Command `dbt run` failed at 14:19:54.302930 after 7.76 seconds
[0m14:19:54.302930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4013EEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47F100B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4014F8DA0>]}
[0m14:19:54.302930 [debug] [MainThread]: Flushing usage events
[0m14:19:55.587407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:15.980273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027907F51F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002790B6F0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002790B6F0E00>]}


============================== 14:20:15.982051 | a1e4f7d6-058e-4160-a19b-313c8b74d2f7 ==============================
[0m14:20:15.982051 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:20:15.982051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi5', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:17.186416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027918243560>]}
[0m14:20:17.265521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027917538470>]}
[0m14:20:17.265521 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:20:17.871892 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:20:18.100127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:18.100127 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:20:18.439774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027918A28590>]}
[0m14:20:18.524858 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:20:18.538938 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:20:18.579959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279189C1280>]}
[0m14:20:18.583088 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:20:18.584098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002791852DE20>]}
[0m14:20:18.584098 [info ] [MainThread]: 
[0m14:20:18.586730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:18.586730 [info ] [MainThread]: 
[0m14:20:18.586730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:18.586730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:20:18.712928 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:20:18.712928 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:20:18.713932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:20.357744 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.647 seconds
[0m14:20:20.373447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m14:20:20.389328 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:20:20.390369 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:20:20.390369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:21.376245 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.985 seconds
[0m14:20:21.381552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m14:20:21.385570 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:20:21.385570 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:20:21.587229 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.205 seconds
[0m14:20:21.594489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m14:20:21.594489 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:20:21.594489 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:20:21.808531 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m14:20:21.813625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027918ACC6B0>]}
[0m14:20:21.813625 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:20:21.813625 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:20:21.813625 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:20:21.813625 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:20:21.831281 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:20:21.832048 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:20:21.870985 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:20:21.872951 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:20:21.873985 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    YEAR('fiscal_year') AS Fiscal_year,
    new_logos_count
FROM new_logos_by_fy
        );
[0m14:20:21.873985 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:22.801652 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb2-3201-7e56-000c-3d5a0002366a
[0m14:20:22.803660 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function EXTRACT does not support VARCHAR(11) argument type
[0m14:20:22.807674 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(11) argument type
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:20:22.809681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1e4f7d6-058e-4160-a19b-313c8b74d2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002790ACB1730>]}
[0m14:20:22.809681 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 0.99s]
[0m14:20:22.809681 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:20:22.809681 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(11) argument type
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m14:20:22.815346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:22.815346 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:20:22.815346 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:20:23.138806 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:20:23.138806 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:20:23.482234 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:20:23.483242 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:20:23.798124 [info ] [MainThread]: 
[0m14:20:23.798124 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m14:20:23.812355 [debug] [MainThread]: Command end result
[0m14:20:23.841405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:20:23.843406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:20:23.847752 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:20:23.847752 [info ] [MainThread]: 
[0m14:20:23.847752 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:20:23.847752 [info ] [MainThread]: 
[0m14:20:23.847752 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(11) argument type
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:20:23.847752 [info ] [MainThread]: 
[0m14:20:23.847752 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:20:23.847752 [debug] [MainThread]: Command `dbt run` failed at 14:20:23.847752 after 8.08 seconds
[0m14:20:23.847752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002790AC7EDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002790AC06300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002790B13E090>]}
[0m14:20:23.847752 [debug] [MainThread]: Flushing usage events
[0m14:20:24.784619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:14.859660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A202660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A855E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A8567B0>]}


============================== 14:23:14.859660 | 8034424a-d1d4-42fe-b7c9-8918a509a5f9 ==============================
[0m14:23:14.859660 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:23:14.859660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi5', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:18.716058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A82E270>]}
[0m14:23:18.795116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A3F1190>]}
[0m14:23:18.795116 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:23:19.519304 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:23:21.147824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:21.149831 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:23:21.485610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025627A983B0>]}
[0m14:23:21.576578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:23:21.590696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:23:21.638011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025627A31010>]}
[0m14:23:21.638011 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:23:21.638011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025627A98C20>]}
[0m14:23:21.638011 [info ] [MainThread]: 
[0m14:23:21.638011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:21.638011 [info ] [MainThread]: 
[0m14:23:21.638011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:21.638011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:23:24.888952 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:23:24.888952 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:23:24.888952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:26.335415 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.449 seconds
[0m14:23:26.367253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m14:23:26.379173 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:23:26.379173 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:23:26.379173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:27.434436 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.058 seconds
[0m14:23:27.434436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m14:23:27.434436 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:23:27.434436 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:23:27.662956 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.222 seconds
[0m14:23:27.662956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m14:23:27.662956 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:23:27.678697 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:23:27.873266 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.207 seconds
[0m14:23:27.889380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A86DBB0>]}
[0m14:23:27.889380 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:23:27.889380 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:23:27.889380 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:23:27.889380 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:23:27.889380 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:23:27.906338 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:23:27.945406 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:23:27.947587 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:23:27.948584 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    fiscal_year,
    new_logos_count
FROM new_logos_by_fy;
[0m14:23:27.949585 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:29.116432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb5-3201-7e57-000c-3d5a0001fb6a
[0m14:23:29.116432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 20 unexpected ';'.
[0m14:23:29.132326 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 20 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:23:29.132326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8034424a-d1d4-42fe-b7c9-8918a509a5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025619D093D0>]}
[0m14:23:29.132326 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 1.24s]
[0m14:23:29.132326 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:23:29.132326 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 20 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m14:23:29.132326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:29.132326 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:23:29.132326 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:23:29.474200 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:23:29.474200 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:23:29.798477 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:23:29.798477 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:23:30.138088 [info ] [MainThread]: 
[0m14:23:30.138088 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.50 seconds (8.50s).
[0m14:23:30.138088 [debug] [MainThread]: Command end result
[0m14:23:30.183464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:23:30.183464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:23:30.204493 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:23:30.204493 [info ] [MainThread]: 
[0m14:23:30.205414 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:23:30.206422 [info ] [MainThread]: 
[0m14:23:30.207458 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 20 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m14:23:30.207458 [info ] [MainThread]: 
[0m14:23:30.208455 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:23:30.210457 [debug] [MainThread]: Command `dbt run` failed at 14:23:30.210457 after 15.58 seconds
[0m14:23:30.210457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025617AD3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A3F0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561A202660>]}
[0m14:23:30.211458 [debug] [MainThread]: Flushing usage events
[0m14:23:31.138603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:40.135205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF71EB6BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF71EB6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF71EB7410>]}


============================== 14:23:40.151333 | 906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc ==============================
[0m14:23:40.151333 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:23:40.151333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi5', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:41.329560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF71EB7410>]}
[0m14:23:41.406618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7C6670B0>]}
[0m14:23:41.406618 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:23:42.002217 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:23:42.237301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:42.237301 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m14:23:42.579237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7E818F80>]}
[0m14:23:42.678939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:23:42.684462 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:23:42.706311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7F0BD3A0>]}
[0m14:23:42.706311 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:23:42.722164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7EFDF200>]}
[0m14:23:42.722164 [info ] [MainThread]: 
[0m14:23:42.722164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:42.722164 [info ] [MainThread]: 
[0m14:23:42.722164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:42.722164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:23:42.843944 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:23:42.843944 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:23:42.843944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:44.244811 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.404 seconds
[0m14:23:44.260817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m14:23:44.276522 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:23:44.276522 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:23:44.276522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:45.207809 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.943 seconds
[0m14:23:45.225656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m14:23:45.229427 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:23:45.229427 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:23:45.407377 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.185 seconds
[0m14:23:45.407377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m14:23:45.407377 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:23:45.407377 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:23:45.614235 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.202 seconds
[0m14:23:45.614235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF6F301280>]}
[0m14:23:45.629970 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m14:23:45.629970 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m14:23:45.629970 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m14:23:45.629970 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m14:23:45.629970 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m14:23:45.629970 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m14:23:45.685445 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m14:23:45.688039 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m14:23:45.689073 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH customer_first_transaction AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('YEAR', payment_month) AS fiscal_year, -- Extract fiscal year from payment_month
        MIN(payment_month) AS first_transaction_date
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('YEAR', payment_month)
),
new_logos_by_fy AS (
    SELECT 
        fiscal_year,
        COUNT(DISTINCT CUSTOMER_ID) AS new_logos_count
    FROM customer_first_transaction
    GROUP BY fiscal_year
    ORDER BY fiscal_year
)
SELECT 
    fiscal_year,
    new_logos_count
FROM new_logos_by_fy
        );
[0m14:23:45.689073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:47.173121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.487 seconds
[0m14:23:47.204965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '906ab56b-6aa3-4c76-9fe1-fb5235a3ebbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF6F25B560>]}
[0m14:23:47.204965 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi5 ............................ [[32mSUCCESS 1[0m in 1.57s]
[0m14:23:47.204965 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m14:23:47.204965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:47.204965 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:23:47.204965 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:23:47.544719 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m14:23:47.544719 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m14:23:47.867385 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m14:23:47.867385 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m14:23:48.209824 [info ] [MainThread]: 
[0m14:23:48.209824 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m14:23:48.225872 [debug] [MainThread]: Command end result
[0m14:23:48.254837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:23:48.257836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:23:48.257836 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:23:48.257836 [info ] [MainThread]: 
[0m14:23:48.257836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:48.267416 [info ] [MainThread]: 
[0m14:23:48.268427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:23:48.269380 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:48.269380 after 8.32 seconds
[0m14:23:48.269380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7132ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7148F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF719C75F0>]}
[0m14:23:48.269380 [debug] [MainThread]: Flushing usage events
[0m14:23:49.486513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:14.995713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF3E85610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF3E84290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF3E86E70>]}


============================== 14:32:14.997462 | 8083d0cf-105d-468a-a8c5-52bb9bfa27ba ==============================
[0m14:32:14.997462 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:32:14.997462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi1', 'send_anonymous_usage_stats': 'True'}
[0m14:32:16.206909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FFF6F8BF0>]}
[0m14:32:16.286255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F808386E0>]}
[0m14:32:16.286255 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:32:16.866597 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:32:17.098480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:17.099988 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m14:32:17.432688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F810175C0>]}
[0m14:32:17.523425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:32:17.538584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:32:17.570633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F82125610>]}
[0m14:32:17.570633 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:32:17.570633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F81110530>]}
[0m14:32:17.582073 [info ] [MainThread]: 
[0m14:32:17.582073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:17.582073 [info ] [MainThread]: 
[0m14:32:17.582073 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:17.585489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:32:17.705974 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:32:17.705974 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:32:17.705974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:19.009954 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.309 seconds
[0m14:32:19.026093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m14:32:19.041968 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:32:19.041968 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:32:19.041968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:20.047109 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.015 seconds
[0m14:32:20.063059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m14:32:20.079249 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:32:20.079249 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:32:20.354723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.271 seconds
[0m14:32:20.354723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m14:32:20.354723 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:32:20.354723 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:32:20.596669 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.246 seconds
[0m14:32:20.612515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F80F940E0>]}
[0m14:32:20.612515 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m14:32:20.612515 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m14:32:20.612515 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m14:32:20.612515 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m14:32:20.633165 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m14:32:20.633741 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m14:32:20.672818 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m14:32:20.675821 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m14:32:20.676464 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
new_customers AS (
    SELECT 
        transaction_month,
        COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
    FROM customer_activity ca
    WHERE transaction_month = (
        SELECT MIN(transaction_month)
        FROM customer_activity ca2
        WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
    )
    GROUP BY transaction_month
),
churned_customers AS (
    SELECT 
        ca.transaction_month,
        COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
    FROM customer_activity ca
    LEFT JOIN customer_activity next_month_activity
        ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 1, ca.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ca.transaction_month
)
SELECT 
    COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
    COALESCE(nc.new_customers_count, 0) AS new_customers,
    COALESCE(cc.churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.transaction_month = cc.transaction_month
ORDER BY transaction_month;
[0m14:32:20.676464 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:21.641798 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-3201-7d7b-000c-3d5a0002283e
[0m14:32:21.641798 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 26 unexpected ';'.
[0m14:32:21.647392 [debug] [Thread-1 (]: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 26 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m14:32:21.647392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8083d0cf-105d-468a-a8c5-52bb9bfa27ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF33398B0>]}
[0m14:32:21.647392 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi1 ........................ [[31mERROR[0m in 1.03s]
[0m14:32:21.657842 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m14:32:21.657842 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi1' to be skipped because of status 'error'.  Reason: Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 26 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql.
[0m14:32:21.657842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:21.657842 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:32:21.657842 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:32:22.063195 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m14:32:22.063195 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m14:32:22.397947 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m14:32:22.397947 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m14:32:22.722149 [info ] [MainThread]: 
[0m14:32:22.724163 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m14:32:22.724163 [debug] [MainThread]: Command end result
[0m14:32:22.762926 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:32:22.765923 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:32:22.765923 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:32:22.765923 [info ] [MainThread]: 
[0m14:32:22.765923 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:22.765923 [info ] [MainThread]: 
[0m14:32:22.765923 [error] [MainThread]:   Database Error in model kpi1 (models\intermediate\kpi1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 26 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi1.sql
[0m14:32:22.778584 [info ] [MainThread]: 
[0m14:32:22.779594 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:22.781712 [debug] [MainThread]: Command `dbt run` failed at 14:32:22.781712 after 8.00 seconds
[0m14:32:22.782803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF386B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF33EE930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF10C5B20>]}
[0m14:32:22.782803 [debug] [MainThread]: Flushing usage events
[0m14:32:24.217847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:30.875358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD91B65C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD91B65430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD91B654C0>]}


============================== 14:32:30.875358 | 963174af-0508-4103-9b26-bfcd8065070e ==============================
[0m14:32:30.875358 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:32:30.875358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:32.069402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9DCAACC0>]}
[0m14:32:32.137981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9E3DB650>]}
[0m14:32:32.137981 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:32:32.718989 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:32:32.940702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:32.956392 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m14:32:33.283444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9ED983B0>]}
[0m14:32:33.394701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:32:33.394701 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:32:33.434383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9ED69CA0>]}
[0m14:32:33.434383 [info ] [MainThread]: Found 9 models, 1 seed, 4 sources, 473 macros
[0m14:32:33.434383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD91B3E570>]}
[0m14:32:33.442146 [info ] [MainThread]: 
[0m14:32:33.442146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:33.442146 [info ] [MainThread]: 
[0m14:32:33.442146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:33.442146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:32:33.556624 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:32:33.556624 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:32:33.556624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:34.868382 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.303 seconds
[0m14:32:34.868382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m14:32:34.894505 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:32:34.894505 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:32:34.894505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:35.848475 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.953 seconds
[0m14:32:35.851473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m14:32:35.853507 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:32:35.854506 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:32:36.063832 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.224 seconds
[0m14:32:36.079501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m14:32:36.083518 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:32:36.083518 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:32:36.303796 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.224 seconds
[0m14:32:36.303796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA01F7F80>]}
[0m14:32:36.303796 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m14:32:36.303796 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m14:32:36.303796 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m14:32:36.303796 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m14:32:36.319485 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m14:32:36.319485 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m14:32:36.367539 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m14:32:36.371535 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m14:32:36.371535 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
new_customers AS (
    SELECT 
        transaction_month,
        COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
    FROM customer_activity ca
    WHERE transaction_month = (
        SELECT MIN(transaction_month)
        FROM customer_activity ca2
        WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
    )
    GROUP BY transaction_month
),
churned_customers AS (
    SELECT 
        ca.transaction_month,
        COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
    FROM customer_activity ca
    LEFT JOIN customer_activity next_month_activity
        ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 1, ca.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ca.transaction_month
)
SELECT 
    COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
    COALESCE(nc.new_customers_count, 0) AS new_customers,
    COALESCE(cc.churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.transaction_month = cc.transaction_month
ORDER BY transaction_month
        );
[0m14:32:36.372535 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:37.864389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m14:32:37.898815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963174af-0508-4103-9b26-bfcd8065070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD91019280>]}
[0m14:32:37.898815 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi1 ............................ [[32mSUCCESS 1[0m in 1.59s]
[0m14:32:37.901076 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m14:32:37.901076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:37.901076 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:32:37.901076 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:32:38.219991 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:32:38.219991 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:32:38.546060 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m14:32:38.546060 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m14:32:38.878313 [info ] [MainThread]: 
[0m14:32:38.878313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m14:32:38.878313 [debug] [MainThread]: Command end result
[0m14:32:38.918952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:32:38.921957 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:32:38.929362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:32:38.929362 [info ] [MainThread]: 
[0m14:32:38.931378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:38.933389 [info ] [MainThread]: 
[0m14:32:38.933389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:32:38.935397 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:38.935397 after 8.26 seconds
[0m14:32:38.935397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9EBC83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8F928260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8F928290>]}
[0m14:32:38.935397 [debug] [MainThread]: Flushing usage events
[0m14:32:39.871327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:52.710854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDF5C5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDF5C4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDF5C6420>]}


============================== 14:43:52.719774 | 741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe ==============================
[0m14:43:52.719774 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:43:52.719774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi2', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:56.551496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEEAE760C0>]}
[0m14:43:56.637801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEEB9C95E0>]}
[0m14:43:56.646356 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:43:57.370433 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:43:59.003364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:43:59.003364 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi2.sql
[0m14:43:59.343041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEEC6AAA80>]}
[0m14:43:59.441044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:43:59.456955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:43:59.489174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEEC72EE70>]}
[0m14:43:59.489174 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 473 macros
[0m14:43:59.489174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEEC583080>]}
[0m14:43:59.489174 [info ] [MainThread]: 
[0m14:43:59.489174 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:59.489174 [info ] [MainThread]: 
[0m14:43:59.505040 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:59.505040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:44:02.691173 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:44:02.691173 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:44:02.691173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:04.234126 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.532 seconds
[0m14:44:04.250054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m14:44:04.260502 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:44:04.260502 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:44:04.260502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:05.276251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.013 seconds
[0m14:44:05.282317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m14:44:05.294164 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:44:05.294164 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:44:05.486380 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.194 seconds
[0m14:44:05.486380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m14:44:05.486380 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:44:05.486380 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:44:05.724925 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.231 seconds
[0m14:44:05.736642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEEC34F2C0>]}
[0m14:44:05.736642 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m14:44:05.736642 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi2 ................................. [RUN]
[0m14:44:05.736642 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m14:44:05.736642 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m14:44:05.754848 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m14:44:05.756540 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m14:44:05.794500 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m14:44:05.798446 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m14:44:05.798446 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        p.PRODUCT_FAMILY,
        DATE_TRUNC('MONTH', t.payment_month) AS transaction_month,
        COUNT(DISTINCT t.product_id) AS products_purchased
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p
        ON t.product_id = p.product_id
    GROUP BY t.CUSTOMER_ID, p.PRODUCT_FAMILY, DATE_TRUNC('MONTH', t.payment_month)
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_FAMILY) AS product_families_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_FAMILY) > 1 -- Customers who purchased from multiple product families
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_FAMILY,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_FAMILY = next_month_activity.PRODUCT_FAMILY
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_FAMILY
)
SELECT 
    csc.CUSTOMER_ID,
    csc.product_families_purchased,
    pcc.PRODUCT_FAMILY AS churned_product_family,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
ORDER BY csc.product_families_purchased DESC, pcc.last_purchase_month DESC
        );
[0m14:44:05.799451 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:07.533425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.737 seconds
[0m14:44:07.549211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '741e378e-d3ca-4aa2-aad2-e9e38d7bb6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDC96B590>]}
[0m14:44:07.564922 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi2 ............................ [[32mSUCCESS 1[0m in 1.81s]
[0m14:44:07.564922 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m14:44:07.564922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:07.564922 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:44:07.569112 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:44:07.890597 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:44:07.890597 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:44:08.230186 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m14:44:08.230186 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m14:44:08.554670 [info ] [MainThread]: 
[0m14:44:08.554670 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m14:44:08.554670 [debug] [MainThread]: Command end result
[0m14:44:08.600695 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:44:08.600695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:44:08.616398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:44:08.616398 [info ] [MainThread]: 
[0m14:44:08.616398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:08.616398 [info ] [MainThread]: 
[0m14:44:08.616398 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:08.620868 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:08.620868 after 16.15 seconds
[0m14:44:08.620868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDF099B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDE59B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEDE59BF80>]}
[0m14:44:08.620868 [debug] [MainThread]: Flushing usage events
[0m14:44:09.492243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:51.216938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C356855190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3566EB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35654D490>]}


============================== 14:50:51.216938 | aa872db5-c868-415d-a888-4fa729931f50 ==============================
[0m14:50:51.216938 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:50:51.216938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi6', 'send_anonymous_usage_stats': 'True'}
[0m14:50:52.480916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C363534B00>]}
[0m14:50:52.544717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3632F7C20>]}
[0m14:50:52.544717 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m14:50:53.135469 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:50:53.365274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:50:53.365274 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi6.sql
[0m14:50:53.708179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C363AA8950>]}
[0m14:50:53.803812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:50:53.803812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:50:53.851228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C363A69760>]}
[0m14:50:53.851228 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 473 macros
[0m14:50:53.851228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3631B7230>]}
[0m14:50:53.851228 [info ] [MainThread]: 
[0m14:50:53.851228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:53.851228 [info ] [MainThread]: 
[0m14:50:53.851228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:53.859699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m14:50:54.001619 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m14:50:54.001619 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m14:50:54.001619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:55.410068 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.410 seconds
[0m14:50:55.425869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m14:50:55.425869 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m14:50:55.441725 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m14:50:55.441725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:56.429631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.995 seconds
[0m14:50:56.429631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m14:50:56.429631 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m14:50:56.429631 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m14:50:56.642918 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.204 seconds
[0m14:50:56.642918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m14:50:56.642918 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m14:50:56.642918 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m14:50:56.861672 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.216 seconds
[0m14:50:56.861672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C364E17CE0>]}
[0m14:50:56.875099 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m14:50:56.875099 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi6 ................................. [RUN]
[0m14:50:56.877105 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m14:50:56.877105 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m14:50:56.877105 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m14:50:56.877105 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m14:50:56.929095 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m14:50:56.932094 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m14:50:56.932094 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m14:50:56.933058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:58.288480 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.364 seconds
[0m14:50:58.320135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa872db5-c868-415d-a888-4fa729931f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C353BF71D0>]}
[0m14:50:58.320135 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi6 ............................ [[32mSUCCESS 1[0m in 1.44s]
[0m14:50:58.320135 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m14:50:58.320135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:58.320135 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m14:50:58.320135 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m14:50:58.650146 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m14:50:58.665971 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m14:50:58.984603 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m14:50:59.000747 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m14:50:59.338509 [info ] [MainThread]: 
[0m14:50:59.339459 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m14:50:59.341280 [debug] [MainThread]: Command end result
[0m14:50:59.363097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m14:50:59.363097 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m14:50:59.381076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m14:50:59.381076 [info ] [MainThread]: 
[0m14:50:59.381076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:59.381076 [info ] [MainThread]: 
[0m14:50:59.381076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:50:59.381076 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:59.381076 after 8.38 seconds
[0m14:50:59.381076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35461C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35461C3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C35461C3E0>]}
[0m14:50:59.381076 [debug] [MainThread]: Flushing usage events
[0m14:51:00.324023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:52.568948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE3083590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE3BC8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE3BC8080>]}


============================== 15:01:52.568948 | b40424fb-9a8a-44fb-b695-b8220269f058 ==============================
[0m15:01:52.568948 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:01:52.568948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:01:56.477699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFF29C6270>]}
[0m15:01:56.558603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFF1F0BF80>]}
[0m15:01:56.558603 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:01:57.297024 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:01:58.910558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:58.910558 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m15:01:59.252230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFF3038EF0>]}
[0m15:01:59.341007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:01:59.368944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:01:59.405909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFF2FF1850>]}
[0m15:01:59.409111 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 473 macros
[0m15:01:59.409111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFF301E060>]}
[0m15:01:59.411753 [info ] [MainThread]: 
[0m15:01:59.411753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:59.411753 [info ] [MainThread]: 
[0m15:01:59.411753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:59.415347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:02:02.617779 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:02:02.619787 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:02:02.619787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:04.083321 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.471 seconds
[0m15:02:04.099138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:02:04.099138 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:02:04.099138 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:02:04.099138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:05.003111 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.898 seconds
[0m15:02:05.003111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:02:05.003111 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:02:05.003111 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:02:05.218485 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.202 seconds
[0m15:02:05.218485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:02:05.222875 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:02:05.222875 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:02:05.427781 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.204 seconds
[0m15:02:05.427781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFF43C5160>]}
[0m15:02:05.427781 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m15:02:05.427781 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m15:02:05.427781 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m15:02:05.427781 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m15:02:05.448728 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m15:02:05.449727 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m15:02:05.487971 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m15:02:05.491974 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m15:02:05.491974 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
new_customers AS (
    SELECT 
        transaction_month,
        COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
    FROM customer_activity ca
    WHERE transaction_month = (
        SELECT MIN(transaction_month)
        FROM customer_activity ca2
        WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
    )
    GROUP BY transaction_month
),
churned_customers AS (
    SELECT 
        ca.transaction_month,
        COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
    FROM customer_activity ca
    LEFT JOIN customer_activity next_month_activity
        ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ca.transaction_month
)
SELECT 
    COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
    COALESCE(nc.new_customers_count, 0) AS new_customers,
    COALESCE(cc.churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.transaction_month = cc.transaction_month
ORDER BY transaction_month
        );
[0m15:02:05.492969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:07.451275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.964 seconds
[0m15:02:07.482831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b40424fb-9a8a-44fb-b695-b8220269f058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE52AD490>]}
[0m15:02:07.482831 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi1 ............................ [[32mSUCCESS 1[0m in 2.06s]
[0m15:02:07.482831 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m15:02:07.482831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:07.482831 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:02:07.482831 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:02:07.812285 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:02:07.812285 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:02:08.145298 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m15:02:08.145298 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m15:02:08.696166 [info ] [MainThread]: 
[0m15:02:08.696166 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m15:02:08.696166 [debug] [MainThread]: Command end result
[0m15:02:08.742718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:02:08.742718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:02:08.758390 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:02:08.758390 [info ] [MainThread]: 
[0m15:02:08.758390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:08.758390 [info ] [MainThread]: 
[0m15:02:08.758390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:02:08.758390 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:08.758390 after 16.43 seconds
[0m15:02:08.758390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE4BE9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE5CF1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFE3AB43E0>]}
[0m15:02:08.765352 [debug] [MainThread]: Flushing usage events
[0m15:02:09.678061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:17.513669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449E160B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449DA1ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449E161430>]}


============================== 15:20:17.515676 | 72f7df86-6143-4deb-b0ca-a519535651ad ==============================
[0m15:20:17.515676 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:20:17.515676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi4', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:20:22.093216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A8A775C0>]}
[0m15:20:22.172841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244A8A987D0>]}
[0m15:20:22.172841 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:20:22.919148 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:20:24.698580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:20:24.698580 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:20:25.085787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244AB4A4FB0>]}
[0m15:20:25.240806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:20:25.269626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:20:25.350827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244AB45DCA0>]}
[0m15:20:25.350827 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:20:25.353838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244AB387050>]}
[0m15:20:25.353838 [info ] [MainThread]: 
[0m15:20:25.353838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:25.353838 [info ] [MainThread]: 
[0m15:20:25.363814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:25.365019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:20:28.876612 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:20:28.876612 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:20:28.876612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:30.404159 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.519 seconds
[0m15:20:30.413090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m15:20:30.425929 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:20:30.426261 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:20:30.426261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:31.401655 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.975 seconds
[0m15:20:31.405655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:20:31.410504 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:20:31.411560 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:20:31.627321 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.215 seconds
[0m15:20:31.630273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:20:31.632265 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:20:31.634230 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:20:31.851457 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.231 seconds
[0m15:20:31.869612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449B6C12E0>]}
[0m15:20:31.869612 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:20:31.869612 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:20:31.869612 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:20:31.878097 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:20:31.888924 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:20:31.889924 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:20:31.927192 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:20:31.927192 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:20:31.927192 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
revenue_contraction AS (
    SELECT 
        cr.CUSTOMER_ID,
        cr.transaction_month,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue,
        CASE 
            WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
                COALESCE(lm.total_revenue, 0) - cr.total_revenue
            ELSE 0
        END AS revenue_lost
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
revenue_lost_over_time AS (
    SELECT 
        transaction_month,
        SUM(revenue_lost) AS total_revenue_lost
    FROM revenue_contraction
    GROUP BY transaction_month
    ORDER BY transaction_month
)
SELECT 
    transaction_month,
    total_revenue_lost
FROM revenue_lost_over_time
        );
[0m15:20:31.927192 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:33.729865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.797 seconds
[0m15:20:33.788741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f7df86-6143-4deb-b0ca-a519535651ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449B61B560>]}
[0m15:20:33.788741 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.92s]
[0m15:20:33.788741 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:20:33.788741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:33.795184 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:20:33.796196 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:20:34.105852 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:20:34.105852 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:20:34.436939 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:20:34.436939 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:20:34.761249 [info ] [MainThread]: 
[0m15:20:34.764398 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.40 seconds (9.40s).
[0m15:20:34.766221 [debug] [MainThread]: Command end result
[0m15:20:34.798635 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:20:34.802629 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:20:34.811665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:20:34.812663 [info ] [MainThread]: 
[0m15:20:34.814961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:34.815949 [info ] [MainThread]: 
[0m15:20:34.816848 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:34.821112 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:34.821112 after 17.60 seconds
[0m15:20:34.821112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449DAAC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244AB2376E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244AAEFEA50>]}
[0m15:20:34.822155 [debug] [MainThread]: Flushing usage events
[0m15:20:35.733003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:30.898773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4F295AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4F2964B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4F297230>]}


============================== 15:23:30.898773 | b984207e-de0f-42b7-bf91-b8f5483e403f ==============================
[0m15:23:30.898773 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:23:30.898773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi4', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:23:34.756288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4E7F80E0>]}
[0m15:23:34.819976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4EC41A60>]}
[0m15:23:34.835756 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:23:35.560832 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:23:37.178017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:37.180024 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:23:37.514003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5C4C51C0>]}
[0m15:23:37.602171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:23:37.630637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:23:37.669669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5C47DCD0>]}
[0m15:23:37.669669 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:23:37.669669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5C3886B0>]}
[0m15:23:37.669669 [info ] [MainThread]: 
[0m15:23:37.669669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:37.669669 [info ] [MainThread]: 
[0m15:23:37.669669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:37.677833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:23:40.865591 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:23:40.865591 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:23:40.865591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:42.383577 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.505 seconds
[0m15:23:42.383577 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:23:42.400095 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:23:42.400095 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:23:42.400095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:43.418432 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.017 seconds
[0m15:23:43.418432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:23:43.418432 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:23:43.418432 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:23:43.720847 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.296 seconds
[0m15:23:43.720847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:23:43.720847 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:23:43.720847 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:23:43.936506 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.214 seconds
[0m15:23:43.936506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5C33B380>]}
[0m15:23:43.953037 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:23:43.953037 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:23:43.953037 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:23:43.953037 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:23:43.965952 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:23:43.970265 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:23:44.006205 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:23:44.006205 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:23:44.006205 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

SELECT 
    DATE_TRUNC('MONTH', payment_month) AS month,
    SUM(revenue)
FROM 
    STG_TRANSACTION
WHERE 
    revenue < 0 AND REVENUE_TYPE = 1
GROUP BY 
    month
ORDER BY 
    month;
[0m15:23:44.006205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:45.181350 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff1-3201-7e57-000c-3d5a0001fd8a
[0m15:23:45.195659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 50 at position 9 unexpected ';'.
[0m15:23:45.217675 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:23:45.217675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b984207e-de0f-42b7-bf91-b8f5483e403f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5D86A720>]}
[0m15:23:45.217675 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.26s]
[0m15:23:45.217675 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:23:45.217675 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:23:45.229180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:45.229180 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:23:45.229180 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:23:45.551181 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m15:23:45.552182 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m15:23:45.882043 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:23:45.882043 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:23:46.215125 [info ] [MainThread]: 
[0m15:23:46.220292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m15:23:46.220292 [debug] [MainThread]: Command end result
[0m15:23:46.256810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:23:46.270351 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:23:46.271490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:23:46.271490 [info ] [MainThread]: 
[0m15:23:46.271490 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:23:46.271490 [info ] [MainThread]: 
[0m15:23:46.271490 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:23:46.271490 [info ] [MainThread]: 
[0m15:23:46.271490 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:46.285788 [debug] [MainThread]: Command `dbt run` failed at 15:23:46.285788 after 15.62 seconds
[0m15:23:46.285788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4E9C9B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4D05C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4D05C320>]}
[0m15:23:46.286797 [debug] [MainThread]: Flushing usage events
[0m15:23:47.153761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:53.207898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F13E03470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F131B0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F149481D0>]}


============================== 15:23:53.218293 | e7ef9c07-f9b4-4d97-8dda-8b6f9870c734 ==============================
[0m15:23:53.218293 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:23:53.218293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi4', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:54.413908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F2368CA40>]}
[0m15:23:54.492301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F23780470>]}
[0m15:23:54.492301 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:23:55.071559 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:23:55.306671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:55.306671 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:23:55.639362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F23DC5310>]}
[0m15:23:55.744414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:23:55.747317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:23:55.776334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F23D69C70>]}
[0m15:23:55.776334 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:23:55.792050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F238B30B0>]}
[0m15:23:55.792050 [info ] [MainThread]: 
[0m15:23:55.792050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:55.792050 [info ] [MainThread]: 
[0m15:23:55.792050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:55.792050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:23:55.912691 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:23:55.912691 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:23:55.912691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:57.262727 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.347 seconds
[0m15:23:57.279378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m15:23:57.291281 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:23:57.292282 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:23:57.292282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:58.269198 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.982 seconds
[0m15:23:58.269198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:23:58.285380 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:23:58.285380 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:23:58.510822 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.220 seconds
[0m15:23:58.510822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:23:58.510822 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:23:58.510822 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:23:58.736693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.227 seconds
[0m15:23:58.752589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F13FD10D0>]}
[0m15:23:58.752589 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:23:58.752589 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:23:58.752589 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:23:58.752589 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:23:58.766911 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:23:58.768703 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:23:58.808361 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:23:58.810363 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:23:58.810363 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

SELECT 
    DATE_TRUNC('MONTH', payment_month) AS month,
    SUM(revenue)
FROM 
    STG_TRANSACTION
WHERE 
    revenue < 0 AND REVENUE_TYPE = 1
GROUP BY 
    month
ORDER BY 
    month
        );
[0m15:23:58.811361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:59.789170 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff1-3201-7d7b-000c-3d5a000229d6
[0m15:23:59.789170 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_TRANSACTION' does not exist or not authorized.
[0m15:23:59.789170 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTION' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:23:59.789170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ef9c07-f9b4-4d97-8dda-8b6f9870c734', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F253CCB90>]}
[0m15:23:59.789170 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.04s]
[0m15:23:59.789170 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:23:59.789170 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTION' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:23:59.789170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:59.789170 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:23:59.789170 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:24:00.176920 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:24:00.176920 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:24:00.514385 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:24:00.514385 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:24:00.853347 [info ] [MainThread]: 
[0m15:24:00.855358 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m15:24:00.855358 [debug] [MainThread]: Command end result
[0m15:24:00.887443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:24:00.890468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:24:00.892486 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:24:00.892486 [info ] [MainThread]: 
[0m15:24:00.892486 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:24:00.892486 [info ] [MainThread]: 
[0m15:24:00.892486 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTION' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:24:00.901359 [info ] [MainThread]: 
[0m15:24:00.902396 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:24:00.904865 [debug] [MainThread]: Command `dbt run` failed at 15:24:00.904865 after 7.89 seconds
[0m15:24:00.905387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F15FEFF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F15FEEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F1472C500>]}
[0m15:24:00.905387 [debug] [MainThread]: Flushing usage events
[0m15:24:02.202522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:19.965965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242185F7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242185F68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242185F4740>]}


============================== 15:24:19.981705 | 301615cc-a82b-49db-be5e-9273aa20ce14 ==============================
[0m15:24:19.981705 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:24:19.981705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi4', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:21.221992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024218617DA0>]}
[0m15:24:21.301708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024218614F80>]}
[0m15:24:21.301708 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:24:21.883997 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:24:22.129785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:22.129785 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:24:22.470469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242258752B0>]}
[0m15:24:22.567195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:24:22.572717 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:24:22.609946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024225821CD0>]}
[0m15:24:22.613190 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:24:22.613190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242258619D0>]}
[0m15:24:22.613190 [info ] [MainThread]: 
[0m15:24:22.613190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:22.613190 [info ] [MainThread]: 
[0m15:24:22.618398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:24:22.618398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:24:22.739043 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:24:22.739043 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:24:22.739043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:24.141878 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.396 seconds
[0m15:24:24.141878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:24:24.155800 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:24:24.164876 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:24:24.164876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:25.191622 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.026 seconds
[0m15:24:25.192630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m15:24:25.192630 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:24:25.192630 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:24:25.385817 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.202 seconds
[0m15:24:25.401535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:24:25.417613 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:24:25.417613 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:24:25.610405 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m15:24:25.626444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024225876B40>]}
[0m15:24:25.626444 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:24:25.626444 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:24:25.626444 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:24:25.626444 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:24:25.642145 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:24:25.643089 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:24:25.682089 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:24:25.684089 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:24:25.685086 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

SELECT 
    DATE_TRUNC('MONTH', payment_month) AS month,
    SUM(revenue)
FROM 
    STG_TRANSACTIONS
WHERE 
    revenue < 0 AND REVENUE_TYPE = 1
GROUP BY 
    month
ORDER BY 
    month
        );
[0m15:24:25.685086 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:26.583840 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff2-3201-7eb6-000c-3d5a0002412a
[0m15:24:26.599767 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_TRANSACTIONS' does not exist or not authorized.
[0m15:24:26.599767 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:24:26.599767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '301615cc-a82b-49db-be5e-9273aa20ce14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024217AA9400>]}
[0m15:24:26.599767 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 0.97s]
[0m15:24:26.599767 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:24:26.599767 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:24:26.615590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:26.615590 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:24:26.615590 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:24:26.940611 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:24:26.940611 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:24:27.277731 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:24:27.277731 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:24:27.602324 [info ] [MainThread]: 
[0m15:24:27.602324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m15:24:27.613860 [debug] [MainThread]: Command end result
[0m15:24:27.661334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:24:27.663093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:24:27.663093 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:24:27.663093 [info ] [MainThread]: 
[0m15:24:27.663093 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:24:27.663093 [info ] [MainThread]: 
[0m15:24:27.663093 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:24:27.663093 [info ] [MainThread]: 
[0m15:24:27.677973 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:24:27.679565 [debug] [MainThread]: Command `dbt run` failed at 15:24:27.679565 after 7.90 seconds
[0m15:24:27.680562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421631E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002421631E120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242163BC170>]}
[0m15:24:27.680562 [debug] [MainThread]: Flushing usage events
[0m15:24:28.585908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:03.724247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B2873530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B4666870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B4666540>]}


============================== 15:25:03.724247 | f93ec7ab-9aeb-4421-909d-66a096cea3b0 ==============================
[0m15:25:03.724247 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:25:03.732037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi4', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:25:04.944259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C1DB7470>]}
[0m15:25:05.025321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C13894F0>]}
[0m15:25:05.025321 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:25:05.590126 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:25:05.828175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:05.828175 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:25:06.171076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C2705760>]}
[0m15:25:06.266423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:25:06.280552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:25:06.314102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C27D2000>]}
[0m15:25:06.314102 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:25:06.314102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C26EAE70>]}
[0m15:25:06.314102 [info ] [MainThread]: 
[0m15:25:06.314102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:06.314102 [info ] [MainThread]: 
[0m15:25:06.314102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:06.314102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:25:06.450675 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:25:06.450675 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:25:06.450675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:08.091723 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.638 seconds
[0m15:25:08.109551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m15:25:08.123499 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:25:08.124464 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:25:08.124464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:09.045817 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.921 seconds
[0m15:25:09.049853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:25:09.051860 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:25:09.051860 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:25:09.248754 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.197 seconds
[0m15:25:09.248754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:25:09.268631 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:25:09.270640 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:25:09.474736 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.217 seconds
[0m15:25:09.490781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B2A413A0>]}
[0m15:25:09.490781 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:25:09.490781 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:25:09.490781 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:25:09.490781 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:25:09.507778 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:25:09.510026 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:25:09.549907 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:25:09.552908 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:25:09.553246 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

SELECT 
    DATE_TRUNC('MONTH', payment_month) AS month,
    SUM(revenue)
FROM 
    DE_MINI_PROJECT.staging.stg_transactions
WHERE 
    revenue < 0 AND REVENUE_TYPE = 1
GROUP BY 
    month
ORDER BY 
    month
        );
[0m15:25:09.554305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:10.498124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff3-3201-7e57-000c-3d5a0001fd9a
[0m15:25:10.498124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m15:25:10.498124 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:25:10.498124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f93ec7ab-9aeb-4421-909d-66a096cea3b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B4A9D3D0>]}
[0m15:25:10.498124 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.01s]
[0m15:25:10.514084 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:25:10.514084 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:25:10.514084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:10.514084 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:25:10.514084 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:25:10.851477 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:25:10.851477 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:25:11.183111 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:25:11.185121 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:25:11.511776 [info ] [MainThread]: 
[0m15:25:11.511776 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m15:25:11.511776 [debug] [MainThread]: Command end result
[0m15:25:11.545882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:25:11.557062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:25:11.557705 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:25:11.557705 [info ] [MainThread]: 
[0m15:25:11.557705 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:25:11.557705 [info ] [MainThread]: 
[0m15:25:11.557705 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:25:11.557705 [info ] [MainThread]: 
[0m15:25:11.557705 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:11.557705 [debug] [MainThread]: Command `dbt run` failed at 15:25:11.557705 after 8.05 seconds
[0m15:25:11.557705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B55F5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B337FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171B337EE10>]}
[0m15:25:11.571719 [debug] [MainThread]: Flushing usage events
[0m15:25:12.860074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:38.057086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024717EDFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024717CDE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247157D4B60>]}


============================== 15:27:38.057086 | a708ce90-6bb0-4a70-8220-57ef7e538f1b ==============================
[0m15:27:38.057086 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:27:38.057086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi4', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:39.267936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247183820F0>]}
[0m15:27:39.345140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024722BC70B0>]}
[0m15:27:39.346889 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:27:39.926574 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:27:40.144197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:40.144197 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:27:40.496363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002472512CEC0>]}
[0m15:27:40.587570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:27:40.597569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:27:40.629371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247255EDF10>]}
[0m15:27:40.629371 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:27:40.629371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247253E0650>]}
[0m15:27:40.642985 [info ] [MainThread]: 
[0m15:27:40.642985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:40.642985 [info ] [MainThread]: 
[0m15:27:40.645411 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:40.647488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:27:40.768919 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:27:40.768919 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:27:40.768919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:42.252046 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.482 seconds
[0m15:27:42.280242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:27:42.295939 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:27:42.295939 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:27:42.295939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:43.192947 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.897 seconds
[0m15:27:43.205310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:27:43.221152 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:27:43.221152 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:27:43.430535 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.214 seconds
[0m15:27:43.439961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:27:43.441969 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:27:43.441969 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:27:43.638798 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.208 seconds
[0m15:27:43.654407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247247B66C0>]}
[0m15:27:43.654407 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:27:43.654407 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:27:43.654407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:27:43.654407 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:27:43.671247 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:27:43.672133 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:27:43.711528 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:27:43.713528 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:27:43.714528 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

SELECT 
    DATE_TRUNC('MONTH', payment_month) AS month,
    SUM(revenue) AS total_revenue_lost
FROM 
    DE_MINI_PROJECT.staging.stg_transactions
WHERE 
    revenue < 0 AND REVENUE_TYPE = 1
GROUP BY 
    month
ORDER BY 
    month
        );
[0m15:27:43.714528 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:45.238200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.524 seconds
[0m15:27:45.268149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a708ce90-6bb0-4a70-8220-57ef7e538f1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024717859850>]}
[0m15:27:45.269149 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.61s]
[0m15:27:45.270114 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:27:45.272116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:45.272116 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:27:45.273150 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:27:45.596839 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m15:27:45.596839 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m15:27:45.908300 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:27:45.908300 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:27:46.224578 [info ] [MainThread]: 
[0m15:27:46.224578 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m15:27:46.240272 [debug] [MainThread]: Command end result
[0m15:27:46.279867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:27:46.282865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:27:46.282865 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:27:46.282865 [info ] [MainThread]: 
[0m15:27:46.282865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:46.293503 [info ] [MainThread]: 
[0m15:27:46.294515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:27:46.295211 [debug] [MainThread]: Command `dbt run` succeeded at 15:27:46.295211 after 8.44 seconds
[0m15:27:46.297225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024717CDE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002471616C260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002471616C3B0>]}
[0m15:27:46.297225 [debug] [MainThread]: Flushing usage events
[0m15:27:47.164827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:53.337575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D75BA7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D75BA7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D75BA7B60>]}


============================== 15:37:53.337575 | 67ef76e3-1f87-4c7a-a47c-db2d834ee2a9 ==============================
[0m15:37:53.337575 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:37:53.337575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi1', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:57.201416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D75844F80>]}
[0m15:37:57.280874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D01EEB4A0>]}
[0m15:37:57.280874 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:37:58.000662 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:37:59.647206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:59.647206 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m15:37:59.984762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D02DE3320>]}
[0m15:38:00.069898 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:38:00.101955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:38:00.141091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D02EB5DC0>]}
[0m15:38:00.141091 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:38:00.145197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D02DE2DE0>]}
[0m15:38:00.145197 [info ] [MainThread]: 
[0m15:38:00.145197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:00.145197 [info ] [MainThread]: 
[0m15:38:00.149495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:00.150615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:38:03.368495 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:38:03.368495 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:38:03.368495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:04.841780 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.461 seconds
[0m15:38:04.841780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:38:04.857865 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:38:04.857865 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:38:04.857865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:05.857817 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.997 seconds
[0m15:38:05.857817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:38:05.857817 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:38:05.857817 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:38:06.084358 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.219 seconds
[0m15:38:06.084358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m15:38:06.084358 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:38:06.084358 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:38:06.293685 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m15:38:06.293685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D72FF12E0>]}
[0m15:38:06.309738 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m15:38:06.309738 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m15:38:06.309738 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m15:38:06.309738 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m15:38:06.309738 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m15:38:06.309738 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m15:38:06.361702 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m15:38:06.363668 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m15:38:06.364668 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (-- WITH customer_activity AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- new_customers AS (
--     SELECT 
--         transaction_month,
--         COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
--     FROM customer_activity ca
--     WHERE transaction_month = (
--         SELECT MIN(transaction_month)
--         FROM customer_activity ca2
--         WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
--     )
--     GROUP BY transaction_month
-- ),
-- churned_customers AS (
--     SELECT 
--         ca.transaction_month,
--         COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
--     FROM customer_activity ca
--     LEFT JOIN customer_activity next_month_activity
--         ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
--         AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
--     WHERE next_month_activity.CUSTOMER_ID IS NULL
--     GROUP BY ca.transaction_month
-- )
-- SELECT 
--     COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
--     COALESCE(nc.new_customers_count, 0) AS new_customers,
--     COALESCE(cc.churned_customers_count, 0) AS churned_customers
-- FROM new_customers nc
-- FULL OUTER JOIN churned_customers cc
--     ON nc.transaction_month = cc.transaction_month
-- ORDER BY transaction_month


WITH customers_data AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM new_and_churned_customers
        );
[0m15:38:06.365668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:07.897576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.545 seconds
[0m15:38:07.928073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ef76e3-1f87-4c7a-a47c-db2d834ee2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D72F4B500>]}
[0m15:38:07.928073 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi1 ............................ [[32mSUCCESS 1[0m in 1.62s]
[0m15:38:07.928073 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m15:38:07.944091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:07.944091 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:38:07.944091 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:38:08.279762 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:38:08.279762 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:38:08.609910 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m15:38:08.609910 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m15:38:08.944280 [info ] [MainThread]: 
[0m15:38:08.944280 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m15:38:08.960067 [debug] [MainThread]: Command end result
[0m15:38:08.996590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:38:08.996590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:38:09.013422 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:38:09.013422 [info ] [MainThread]: 
[0m15:38:09.013422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:09.013422 [info ] [MainThread]: 
[0m15:38:09.013422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:09.013422 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:09.013422 after 15.93 seconds
[0m15:38:09.013422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D75746F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D01D29040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D02CAAA80>]}
[0m15:38:09.022130 [debug] [MainThread]: Flushing usage events
[0m15:38:10.433882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:05.044530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79EDC75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79EDC6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79EDC7650>]}


============================== 15:40:05.044530 | b74b61bb-541e-4541-9595-837aadfc6c51 ==============================
[0m15:40:05.044530 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:40:05.044530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi1', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:40:06.279052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7A9617740>]}
[0m15:40:06.357776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB9BAF00>]}
[0m15:40:06.357776 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:40:06.938606 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:40:07.175281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:07.175281 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m15:40:07.519890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AC0492B0>]}
[0m15:40:07.615047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:40:07.622775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:40:07.663165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7ABFF9EE0>]}
[0m15:40:07.663165 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:40:07.663165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7ABF0B530>]}
[0m15:40:07.666296 [info ] [MainThread]: 
[0m15:40:07.666296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:07.666296 [info ] [MainThread]: 
[0m15:40:07.666296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:07.669765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:40:07.799516 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:40:07.799516 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:40:07.799516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:09.109625 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.317 seconds
[0m15:40:09.125310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:40:09.136254 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:40:09.136254 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:40:09.136254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:10.112038 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.978 seconds
[0m15:40:10.112038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m15:40:10.112038 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:40:10.112038 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:40:10.321311 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.204 seconds
[0m15:40:10.321311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:40:10.321311 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:40:10.321311 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:40:10.524210 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m15:40:10.536490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7ABAA3590>]}
[0m15:40:10.538842 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m15:40:10.539842 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m15:40:10.540843 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m15:40:10.540843 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m15:40:10.551172 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m15:40:10.553178 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m15:40:10.585201 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m15:40:10.585201 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m15:40:10.585201 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (WITH customer_activity AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
new_customers AS (
    SELECT 
        transaction_month,
        COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
    FROM customer_activity ca
    WHERE transaction_month = (
        SELECT MIN(transaction_month)
        FROM customer_activity ca2
        WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
    )
    GROUP BY transaction_month
),
churned_customers AS (
    SELECT 
        ca.transaction_month,
        COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
    FROM customer_activity ca
    LEFT JOIN customer_activity next_month_activity
        ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL
    GROUP BY ca.transaction_month
)
SELECT 
    COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
    COALESCE(nc.new_customers_count, 0) AS new_customers,
    COALESCE(cc.churned_customers_count, 0) AS churned_customers
FROM new_customers nc
FULL OUTER JOIN churned_customers cc
    ON nc.transaction_month = cc.transaction_month
ORDER BY transaction_month


-- WITH customers_data AS (
--     SELECT
--         payment_month,
--         customer_id,
--         MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
--         MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
--     FROM DE_MINI_PROJECT.staging.stg_transactions  
--     JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
-- ),
-- new_and_churned_customers AS (
--     SELECT
--         payment_month,
--         COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
--         COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
--     FROM customers_data
--     GROUP BY payment_month
--     ORDER BY payment_month
-- )
-- SELECT * FROM new_and_churned_customers
        );
[0m15:40:10.585201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:12.392643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.807 seconds
[0m15:40:12.424260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b74b61bb-541e-4541-9595-837aadfc6c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79C1C7050>]}
[0m15:40:12.424260 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi1 ............................ [[32mSUCCESS 1[0m in 1.88s]
[0m15:40:12.424260 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m15:40:12.424260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:12.424260 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:40:12.424260 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:40:12.795811 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:40:12.795811 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:40:13.122928 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m15:40:13.122928 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m15:40:13.448655 [info ] [MainThread]: 
[0m15:40:13.449801 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.78 seconds (5.78s).
[0m15:40:13.450816 [debug] [MainThread]: Command end result
[0m15:40:13.472171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:40:13.472171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:40:13.491899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:40:13.492868 [info ] [MainThread]: 
[0m15:40:13.493868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:13.493868 [info ] [MainThread]: 
[0m15:40:13.493868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:40:13.493868 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:13.493868 after 8.66 seconds
[0m15:40:13.493868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79E23EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79E19F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79B78B800>]}
[0m15:40:13.493868 [debug] [MainThread]: Flushing usage events
[0m15:40:14.414341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:13.268032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF9067E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF9076E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF906F90>]}


============================== 15:42:13.288311 | 0666a5e9-651e-4117-8972-b4f6fdd19703 ==============================
[0m15:42:13.288311 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:42:13.288311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi1', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:14.505234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF8DE270>]}
[0m15:42:14.584282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7FB0E0080>]}
[0m15:42:14.584282 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:42:15.180838 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:42:15.402175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:15.402175 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi1.sql
[0m15:42:15.745314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7FCB350D0>]}
[0m15:42:15.841096 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:42:15.841096 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:42:15.888787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7FCAEDFA0>]}
[0m15:42:15.888787 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:42:15.888787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7FC5B2090>]}
[0m15:42:15.888787 [info ] [MainThread]: 
[0m15:42:15.888787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:15.888787 [info ] [MainThread]: 
[0m15:42:15.888787 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:15.888787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:42:16.025406 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:42:16.025406 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:42:16.025406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:17.420658 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.395 seconds
[0m15:42:17.430428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:42:17.442468 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:42:17.444476 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:42:17.444476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:18.399681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.959 seconds
[0m15:42:18.404137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:42:18.406145 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:42:18.406145 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:42:18.608304 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.198 seconds
[0m15:42:18.610314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:42:18.614330 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:42:18.614330 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:42:18.820814 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.205 seconds
[0m15:42:18.827900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7FC62E360>]}
[0m15:42:18.837969 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m15:42:18.837969 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi1 ................................. [RUN]
[0m15:42:18.837969 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m15:42:18.837969 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m15:42:18.872681 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m15:42:18.872681 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m15:42:18.915477 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m15:42:18.918512 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m15:42:18.918512 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi1
         as
        (-- WITH customer_activity AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- new_customers AS (
--     SELECT 
--         transaction_month,
--         COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
--     FROM customer_activity ca
--     WHERE transaction_month = (
--         SELECT MIN(transaction_month)
--         FROM customer_activity ca2
--         WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
--     )
--     GROUP BY transaction_month
-- ),
-- churned_customers AS (
--     SELECT 
--         ca.transaction_month,
--         COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
--     FROM customer_activity ca
--     LEFT JOIN customer_activity next_month_activity
--         ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
--         AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
--     WHERE next_month_activity.CUSTOMER_ID IS NULL
--     GROUP BY ca.transaction_month
-- )
-- SELECT 
--     COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
--     COALESCE(nc.new_customers_count, 0) AS new_customers,
--     COALESCE(cc.churned_customers_count, 0) AS churned_customers
-- FROM new_customers nc
-- FULL OUTER JOIN churned_customers cc
--     ON nc.transaction_month = cc.transaction_month
-- ORDER BY transaction_month


WITH customers_data AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM new_and_churned_customers
        );
[0m15:42:18.919510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:20.673756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.754 seconds
[0m15:42:20.699548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0666a5e9-651e-4117-8972-b4f6fdd19703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7ECCA73E0>]}
[0m15:42:20.699548 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi1 ............................ [[32mSUCCESS 1[0m in 1.86s]
[0m15:42:20.699548 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m15:42:20.699548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:20.699548 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:42:20.699548 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:42:21.019596 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m15:42:21.019596 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m15:42:21.363574 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m15:42:21.363574 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m15:42:21.687868 [info ] [MainThread]: 
[0m15:42:21.687868 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m15:42:21.689874 [debug] [MainThread]: Command end result
[0m15:42:21.714624 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:42:21.714624 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:42:21.714624 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:42:21.714624 [info ] [MainThread]: 
[0m15:42:21.732181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:21.733194 [info ] [MainThread]: 
[0m15:42:21.734192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:21.736227 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:21.736227 after 8.66 seconds
[0m15:42:21.736227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF46BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF906AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7EF9067E0>]}
[0m15:42:21.737224 [debug] [MainThread]: Flushing usage events
[0m15:42:23.045892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:14.558297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A75E60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A75E71A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A75E5A00>]}


============================== 15:45:14.571001 | 75586a18-1414-4478-a4ce-3b3248fd39f3 ==============================
[0m15:45:14.571001 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:45:14.571001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi4', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:15.784892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A762C170>]}
[0m15:45:15.848426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B3318470>]}
[0m15:45:15.864114 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:45:16.438091 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:45:16.662104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:16.662104 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:45:17.007972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B48152B0>]}
[0m15:45:17.107962 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:45:17.113547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:45:17.154005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B47C1C10>]}
[0m15:45:17.155345 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:45:17.156005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B430CE60>]}
[0m15:45:17.158034 [info ] [MainThread]: 
[0m15:45:17.159007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:17.159523 [info ] [MainThread]: 
[0m15:45:17.160567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:17.161567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:45:17.272486 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:45:17.288141 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:45:17.288141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:18.575658 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.287 seconds
[0m15:45:18.583796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m15:45:18.599161 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:45:18.599161 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:45:18.599161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:19.491941 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.900 seconds
[0m15:45:19.491941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m15:45:19.491941 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:45:19.491941 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:45:19.713303 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.212 seconds
[0m15:45:19.724657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:45:19.728060 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:45:19.728060 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:45:19.924946 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.202 seconds
[0m15:45:19.924946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B47FC230>]}
[0m15:45:19.941784 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:45:19.944132 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:45:19.944132 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:45:19.944132 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:45:19.944132 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:45:19.956942 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:45:19.998915 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:45:20.000925 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:45:20.000925 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        STG_TRANSACTIONs
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    (total_revenue -LAG(total_revenue) OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month;
[0m15:45:20.000925 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:21.158072 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0007-3201-7d7b-000c-3d5a00022a62
[0m15:45:21.158072 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 9 unexpected ';'.
[0m15:45:21.176463 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:45:21.179683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75586a18-1414-4478-a4ce-3b3248fd39f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A6A994F0>]}
[0m15:45:21.179683 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.23s]
[0m15:45:21.181683 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:45:21.182015 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:45:21.184274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:21.184274 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:45:21.185308 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:45:21.513590 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:45:21.514587 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:45:21.841901 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:45:21.841901 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:45:22.173036 [info ] [MainThread]: 
[0m15:45:22.173036 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m15:45:22.179442 [debug] [MainThread]: Command end result
[0m15:45:22.213116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:45:22.223650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:45:22.229565 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:45:22.229565 [info ] [MainThread]: 
[0m15:45:22.229565 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:22.229565 [info ] [MainThread]: 
[0m15:45:22.229565 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:45:22.229565 [info ] [MainThread]: 
[0m15:45:22.229565 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:45:22.229565 [debug] [MainThread]: Command `dbt run` failed at 15:45:22.229565 after 7.89 seconds
[0m15:45:22.229565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A7607950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A3CBA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260A7149D30>]}
[0m15:45:22.229565 [debug] [MainThread]: Flushing usage events
[0m15:45:23.118445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:37.634663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5482D69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5482D58E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5482D5280>]}


============================== 15:45:37.650649 | d5bf3a4a-27cc-4b96-95eb-63c8a713c9ed ==============================
[0m15:45:37.650649 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:45:37.650649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi4', 'send_anonymous_usage_stats': 'True'}
[0m15:45:38.844532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B554E0AFC0>]}
[0m15:45:38.923702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B554A45D00>]}
[0m15:45:38.923702 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:45:39.502582 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:45:39.721487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:39.721487 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:45:40.076678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55500EF60>]}
[0m15:45:40.178924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:45:40.186080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:45:40.222067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5554D1FA0>]}
[0m15:45:40.222067 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:45:40.222067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B555383320>]}
[0m15:45:40.225722 [info ] [MainThread]: 
[0m15:45:40.227730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:40.227730 [info ] [MainThread]: 
[0m15:45:40.229738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:40.230818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:45:40.344695 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:45:40.344695 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:45:40.360576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:41.827927 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.468 seconds
[0m15:45:41.829938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:45:41.841639 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:45:41.841639 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:45:41.841639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:42.829667 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.982 seconds
[0m15:45:42.829667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:45:42.829667 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:45:42.829667 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:45:43.041291 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.207 seconds
[0m15:45:43.041291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m15:45:43.041291 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:45:43.041291 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:45:43.283606 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.231 seconds
[0m15:45:43.285373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5555081A0>]}
[0m15:45:43.285373 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:45:43.285373 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:45:43.285373 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:45:43.285373 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:45:43.303377 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:45:43.305377 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:45:43.332203 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:45:43.332203 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:45:43.332203 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        STG_TRANSACTIONs
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    (total_revenue -LAG(total_revenue) OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:45:43.347915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:44.350230 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0007-3201-7e57-000c-3d5a0001fe0e
[0m15:45:44.350230 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_TRANSACTIONS' does not exist or not authorized.
[0m15:45:44.350230 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:45:44.365540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5bf3a4a-27cc-4b96-95eb-63c8a713c9ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B55525FC80>]}
[0m15:45:44.365540 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.06s]
[0m15:45:44.367224 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:45:44.368266 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:45:44.370268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:44.371265 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:45:44.371265 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:45:44.691572 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:45:44.691572 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:45:45.013527 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:45:45.029387 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:45:45.353241 [info ] [MainThread]: 
[0m15:45:45.353241 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m15:45:45.369386 [debug] [MainThread]: Command end result
[0m15:45:45.403651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:45:45.406635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:45:45.407634 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:45:45.407634 [info ] [MainThread]: 
[0m15:45:45.407634 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:45.407634 [info ] [MainThread]: 
[0m15:45:45.416650 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:45:45.417661 [info ] [MainThread]: 
[0m15:45:45.418658 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:45:45.421535 [debug] [MainThread]: Command `dbt run` failed at 15:45:45.420914 after 7.98 seconds
[0m15:45:45.421864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5477ED640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B554F6EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B547CDDF70>]}
[0m15:45:45.421864 [debug] [MainThread]: Flushing usage events
[0m15:45:46.305647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:05.889013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA720495E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7214C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7214FBC0>]}


============================== 15:48:05.889013 | fb73dede-f264-4dc2-8d20-5262b14b39c7 ==============================
[0m15:48:05.889013 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:48:05.889013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi4', 'send_anonymous_usage_stats': 'True'}
[0m15:48:07.116205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7F253C80>]}
[0m15:48:07.197835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7E689580>]}
[0m15:48:07.197835 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:48:07.786277 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:48:08.023875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:08.023875 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:48:08.367038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7F855070>]}
[0m15:48:08.464228 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:48:08.470243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:48:08.493976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7F801DF0>]}
[0m15:48:08.507947 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:48:08.507947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7F854C80>]}
[0m15:48:08.509683 [info ] [MainThread]: 
[0m15:48:08.509683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:08.512193 [info ] [MainThread]: 
[0m15:48:08.512193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:08.512193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:48:08.642638 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:48:08.642638 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:48:08.642638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:10.138757 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.506 seconds
[0m15:48:10.156596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:48:10.160606 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:48:10.170476 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:48:10.170476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:11.174299 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.004 seconds
[0m15:48:11.176303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:48:11.182317 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:48:11.182317 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:48:11.393646 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m15:48:11.395366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:48:11.399379 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:48:11.401384 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:48:11.602916 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m15:48:11.602916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7FBF4110>]}
[0m15:48:11.602916 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:48:11.602916 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:48:11.602916 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:48:11.602916 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:48:11.618880 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:48:11.618880 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:48:11.666283 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:48:11.669283 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:48:11.669283 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    (total_revenue -LAG(total_revenue) OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:48:11.670285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:13.028920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m15:48:13.060861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb73dede-f264-4dc2-8d20-5262b14b39c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7F53DEE0>]}
[0m15:48:13.060861 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.46s]
[0m15:48:13.060861 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:48:13.060861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:13.060861 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:48:13.060861 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:48:13.399742 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:48:13.401759 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:48:13.731488 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:48:13.731488 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:48:14.047781 [info ] [MainThread]: 
[0m15:48:14.047781 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m15:48:14.047781 [debug] [MainThread]: Command end result
[0m15:48:14.085914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:48:14.085914 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:48:14.100423 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:48:14.101392 [info ] [MainThread]: 
[0m15:48:14.102393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:14.103393 [info ] [MainThread]: 
[0m15:48:14.103393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:48:14.122819 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:14.122819 after 8.45 seconds
[0m15:48:14.122819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71FC35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71B7C1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71B7C140>]}
[0m15:48:14.122819 [debug] [MainThread]: Flushing usage events
[0m15:48:15.084039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:27.336668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9B1078F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9AD3D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9B105CA0>]}


============================== 15:50:27.342693 | 0c6ce26f-340c-4705-81fa-b141e6c5b5fe ==============================
[0m15:50:27.342693 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:50:27.344701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi4', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:28.542891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA72EAD80>]}
[0m15:50:28.621759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9AC69EE0>]}
[0m15:50:28.621759 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:50:29.204333 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:50:29.436976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:29.438983 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:50:29.769103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA7E2CC80>]}
[0m15:50:29.863832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:50:29.879509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:50:29.911659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA82D1C70>]}
[0m15:50:29.911659 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:50:29.911659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9A0D8F80>]}
[0m15:50:29.911659 [info ] [MainThread]: 
[0m15:50:29.911659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:29.911659 [info ] [MainThread]: 
[0m15:50:29.911659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:29.911659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:50:30.048520 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:50:30.048520 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:50:30.048520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:31.392306 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.348 seconds
[0m15:50:31.408449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:50:31.424536 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:50:31.424536 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:50:31.424536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:32.410452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.992 seconds
[0m15:50:32.426415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m15:50:32.426415 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:50:32.426415 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:50:32.619248 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.201 seconds
[0m15:50:32.635373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:50:32.642778 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:50:32.642778 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:50:32.857309 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.211 seconds
[0m15:50:32.863557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA7C8DB50>]}
[0m15:50:32.863557 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:50:32.863557 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:50:32.863557 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:50:32.869752 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:50:32.880433 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:50:32.882122 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:50:32.922860 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:50:32.925860 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:50:32.925860 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS current_month_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous_month_revenue,
    (total_revenue -LAG(total_revenue) OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:50:32.926860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:33.882923 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb000c-3201-7e9a-000c-3d5a000215ae
[0m15:50:33.882923 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 54 at position 4
invalid identifier 'TOTAL_REVENUE'
[0m15:50:33.892625 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  000904 (42000): SQL compilation error: error line 54 at position 4
  invalid identifier 'TOTAL_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:50:33.897216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ce26f-340c-4705-81fa-b141e6c5b5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9A5B9880>]}
[0m15:50:33.897216 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.03s]
[0m15:50:33.898978 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:50:33.898978 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  000904 (42000): SQL compilation error: error line 54 at position 4
  invalid identifier 'TOTAL_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:50:33.898978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:33.898978 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:50:33.898978 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:50:34.230613 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:50:34.230613 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:50:34.560724 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:50:34.560724 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:50:34.911984 [info ] [MainThread]: 
[0m15:50:34.911984 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m15:50:34.911984 [debug] [MainThread]: Command end result
[0m15:50:34.939848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:50:34.939848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:50:34.954914 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:50:34.954914 [info ] [MainThread]: 
[0m15:50:34.956087 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:50:34.958091 [info ] [MainThread]: 
[0m15:50:34.959087 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  000904 (42000): SQL compilation error: error line 54 at position 4
  invalid identifier 'TOTAL_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:50:34.959772 [info ] [MainThread]: 
[0m15:50:34.960820 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:34.962842 [debug] [MainThread]: Command `dbt run` failed at 15:50:34.962842 after 7.83 seconds
[0m15:50:34.962842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9AD3D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9ACA4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9A57E570>]}
[0m15:50:34.963881 [debug] [MainThread]: Flushing usage events
[0m15:50:35.872820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:28.553225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D75CAA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D79B30E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D798285C0>]}


============================== 15:51:28.568951 | de802187-2cd7-4494-802e-19fa15611138 ==============================
[0m15:51:28.568951 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:51:28.568951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi4', 'send_anonymous_usage_stats': 'True'}
[0m15:51:29.762529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D79F48830>]}
[0m15:51:29.839796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D0643F080>]}
[0m15:51:29.841545 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:51:30.423938 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:51:30.656272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:30.656272 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:51:31.004776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D071A9A00>]}
[0m15:51:31.101367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:51:31.107373 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:51:31.147658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D072D9EB0>]}
[0m15:51:31.147658 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:51:31.149038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D77D93740>]}
[0m15:51:31.149038 [info ] [MainThread]: 
[0m15:51:31.149038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:31.149038 [info ] [MainThread]: 
[0m15:51:31.149038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:51:31.149038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:51:31.277144 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:51:31.277144 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:51:31.277144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:32.771060 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.489 seconds
[0m15:51:32.775872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:51:32.792021 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:51:32.792021 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:51:32.792021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:33.779345 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.986 seconds
[0m15:51:33.779345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:51:33.779345 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:51:33.779345 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:51:33.972821 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.195 seconds
[0m15:51:33.984119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m15:51:33.986128 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:51:33.986128 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:51:34.200010 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m15:51:34.204046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D06CC79E0>]}
[0m15:51:34.204046 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:51:34.204046 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:51:34.204046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:51:34.204046 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:51:34.213645 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:51:34.213645 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:51:34.249386 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:51:34.249386 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:51:34.249386 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS current_month_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    current_month_revenue,
    LAG(current_month_revenue) OVER (ORDER BY month) AS previous_month_revenue,
    (current_month_revenue -LAG(current_month_revenue) OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:51:34.249386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:35.668328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.415 seconds
[0m15:51:35.701647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de802187-2cd7-4494-802e-19fa15611138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D77437380>]}
[0m15:51:35.701647 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.50s]
[0m15:51:35.701647 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:51:35.715360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:35.716377 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:51:35.717371 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:51:36.034264 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m15:51:36.034264 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m15:51:36.365249 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:51:36.365249 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:51:36.711350 [info ] [MainThread]: 
[0m15:51:36.715407 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m15:51:36.719616 [debug] [MainThread]: Command end result
[0m15:51:36.751738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:51:36.754363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:51:36.754363 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:51:36.754363 [info ] [MainThread]: 
[0m15:51:36.754363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:36.766431 [info ] [MainThread]: 
[0m15:51:36.767440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:36.769335 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:36.769335 after 8.41 seconds
[0m15:51:36.769335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D77E481A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D77E48110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D77E48260>]}
[0m15:51:36.769335 [debug] [MainThread]: Flushing usage events
[0m15:51:38.002026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:26.634934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB84D50D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB8295490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB84D73B0>]}


============================== 15:54:26.634934 | 1de234c9-dcde-49a1-97b1-a7ba338bca23 ==============================
[0m15:54:26.634934 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:54:26.634934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi4', 'send_anonymous_usage_stats': 'True'}
[0m15:54:30.465354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC46BAD80>]}
[0m15:54:30.538554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB4AC0AA0>]}
[0m15:54:30.538554 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:54:31.279892 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:54:32.910630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:32.910630 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:54:33.254914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC5705280>]}
[0m15:54:33.359471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:54:33.376176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:54:33.427053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC56BDE20>]}
[0m15:54:33.427053 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:54:33.427053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC53EDA30>]}
[0m15:54:33.427053 [info ] [MainThread]: 
[0m15:54:33.427053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:33.427053 [info ] [MainThread]: 
[0m15:54:33.427053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:33.439897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:54:36.789560 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:54:36.789560 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:54:36.789560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:38.403488 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.601 seconds
[0m15:54:38.411962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m15:54:38.422797 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:54:38.424804 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:54:38.424804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:39.402040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.983 seconds
[0m15:54:39.408974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m15:54:39.412991 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:54:39.412991 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:54:39.613056 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.211 seconds
[0m15:54:39.613056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m15:54:39.628796 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:54:39.628796 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:54:39.838477 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m15:54:39.854535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC694F410>]}
[0m15:54:39.854535 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:54:39.854535 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:54:39.854535 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:54:39.854535 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:54:39.871198 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:54:39.872859 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:54:39.911791 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:54:39.913756 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:54:39.914757 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS current_month_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    current_month_revenue,
    LAG(current_month_revenue) OVER (ORDER BY month) AS previous_month_revenue,
    (LAG(current_month_revenue)-current_month_revenue OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:54:39.915685 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:54:41.048595 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0010-3201-7e56-000c-3d5a000238c6
[0m15:54:41.048595 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001005 (42P13): SQL compilation error:
invalid function 'CURRENT_MONTH_REVENUE'
[0m15:54:41.064550 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'CURRENT_MONTH_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:54:41.080435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de234c9-dcde-49a1-97b1-a7ba338bca23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB7989910>]}
[0m15:54:41.080435 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.21s]
[0m15:54:41.080435 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:54:41.080435 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'CURRENT_MONTH_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:54:41.080435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:41.080435 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:54:41.080435 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:54:41.410492 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:54:41.410492 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:54:41.748340 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:54:41.748340 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:54:42.078845 [info ] [MainThread]: 
[0m15:54:42.078845 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m15:54:42.078845 [debug] [MainThread]: Command end result
[0m15:54:42.108675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:54:42.108675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:54:42.120312 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:54:42.120312 [info ] [MainThread]: 
[0m15:54:42.120312 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:42.120312 [info ] [MainThread]: 
[0m15:54:42.120312 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'CURRENT_MONTH_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:54:42.120312 [info ] [MainThread]: 
[0m15:54:42.120312 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:54:42.120312 [debug] [MainThread]: Command `dbt run` failed at 15:54:42.120312 after 15.73 seconds
[0m15:54:42.120312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB79ED6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB8295490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDB84EFE60>]}
[0m15:54:42.120312 [debug] [MainThread]: Flushing usage events
[0m15:54:43.039806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:22.415819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE82100DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEFF884EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE82100D70>]}


============================== 15:57:22.415819 | 9aa37d19-ff79-4723-87c4-e1d8a2874af2 ==============================
[0m15:57:22.415819 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:57:22.415819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi4', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:23.675473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8DEFE270>]}
[0m15:57:23.765897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8C9B8470>]}
[0m15:57:23.765897 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:57:24.344254 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:57:24.566521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:24.566521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:24.628632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8E289F70>]}
[0m15:57:24.722816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:57:24.734327 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:57:24.775584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8F13CC80>]}
[0m15:57:24.775584 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:57:24.775584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE82100DD0>]}
[0m15:57:24.775584 [info ] [MainThread]: 
[0m15:57:24.775584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:24.775584 [info ] [MainThread]: 
[0m15:57:24.775584 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:24.783828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:57:24.917765 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:57:24.917765 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:57:24.919776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:26.299702 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.393 seconds
[0m15:57:26.321751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:57:26.331211 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:57:26.331211 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:57:26.331211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:27.284852 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.949 seconds
[0m15:57:27.292941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:57:27.304902 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:57:27.306936 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:57:27.530681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.226 seconds
[0m15:57:27.535223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:57:27.537231 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:57:27.537231 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:57:27.739622 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m15:57:27.755617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8E2890A0>]}
[0m15:57:27.755617 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:57:27.755617 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:57:27.755617 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:57:27.755617 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:57:27.775359 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:57:27.776983 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:57:27.814254 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:57:27.817251 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:57:27.818253 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS current_month_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    current_month_revenue,
    LAG(current_month_revenue) OVER (ORDER BY month) AS previous_month_revenue,
    (LAG(current_month_revenue)-current_month_revenue OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:57:27.818253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:28.792477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0013-3201-7d7b-000c-3d5a00022a86
[0m15:57:28.792477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001005 (42P13): SQL compilation error:
invalid function 'CURRENT_MONTH_REVENUE'
[0m15:57:28.792477 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'CURRENT_MONTH_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:57:28.792477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9aa37d19-ff79-4723-87c4-e1d8a2874af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE816C9970>]}
[0m15:57:28.792477 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.04s]
[0m15:57:28.792477 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:57:28.792477 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'CURRENT_MONTH_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:57:28.792477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:28.792477 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:57:28.792477 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:57:29.116688 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:57:29.116688 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:57:29.479522 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:57:29.481544 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:57:29.818268 [info ] [MainThread]: 
[0m15:57:29.820280 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m15:57:29.820280 [debug] [MainThread]: Command end result
[0m15:57:29.852232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:57:29.854231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:57:29.854231 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:57:29.854231 [info ] [MainThread]: 
[0m15:57:29.854231 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:57:29.854231 [info ] [MainThread]: 
[0m15:57:29.854231 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001005 (42P13): SQL compilation error:
  invalid function 'CURRENT_MONTH_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:57:29.867906 [info ] [MainThread]: 
[0m15:57:29.867906 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:57:29.870594 [debug] [MainThread]: Command `dbt run` failed at 15:57:29.870594 after 7.66 seconds
[0m15:57:29.871630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE81D7DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8177C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE8177C110>]}
[0m15:57:29.871630 [debug] [MainThread]: Flushing usage events
[0m15:57:31.273105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:50.799155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B067578C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B09AE73E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B09AE49E0>]}


============================== 15:59:50.799155 | 75cd5349-2085-4d96-a377-001f5c261935 ==============================
[0m15:59:50.799155 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:59:50.799155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi4', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:59:52.011108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B09F474D0>]}
[0m15:59:52.096921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B16AF4D40>]}
[0m15:59:52.096921 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:59:52.675944 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:59:52.919000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:52.919000 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m15:59:53.252507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B17175400>]}
[0m15:59:53.357048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:59:53.357048 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:59:53.404980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B17119DC0>]}
[0m15:59:53.404980 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m15:59:53.404980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B16C6F2C0>]}
[0m15:59:53.404980 [info ] [MainThread]: 
[0m15:59:53.404980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:53.404980 [info ] [MainThread]: 
[0m15:59:53.404980 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:53.415578 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m15:59:53.528029 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m15:59:53.544141 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m15:59:53.544141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:55.008407 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.477 seconds
[0m15:59:55.037857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m15:59:55.050630 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m15:59:55.050630 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m15:59:55.052638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:56.043640 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.992 seconds
[0m15:59:56.047660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m15:59:56.049667 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m15:59:56.049667 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m15:59:56.274575 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.223 seconds
[0m15:59:56.280641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m15:59:56.291804 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m15:59:56.293821 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m15:59:56.497702 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m15:59:56.497702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B16B95B50>]}
[0m15:59:56.497702 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m15:59:56.497702 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m15:59:56.497702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m15:59:56.497702 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m15:59:56.517393 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m15:59:56.519450 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m15:59:56.557368 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m15:59:56.559334 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m15:59:56.560368 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS current_month_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    current_month_revenue,
    LAG(current_month_revenue) OVER (ORDER BY month) AS previous_month_revenue,
    (previous_month_revenue-current_month_revenue) OVER (ORDER BY month)  AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m15:59:56.561371 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:57.529462 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0015-3201-7eb6-000c-3d5a000241d6
[0m15:59:57.530463 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002060 (42601): SQL compilation error:
Invalid function type [-] for window function.
[0m15:59:57.534235 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [-] for window function.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:59:57.534235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cd5349-2085-4d96-a377-001f5c261935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B187751F0>]}
[0m15:59:57.534235 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.04s]
[0m15:59:57.534235 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m15:59:57.534235 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [-] for window function.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m15:59:57.534235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:57.534235 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m15:59:57.534235 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m15:59:57.867414 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m15:59:57.867414 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m15:59:58.194350 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m15:59:58.194350 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m15:59:58.518355 [info ] [MainThread]: 
[0m15:59:58.518355 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m15:59:58.518355 [debug] [MainThread]: Command end result
[0m15:59:58.553126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m15:59:58.555163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m15:59:58.557160 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m15:59:58.557160 [info ] [MainThread]: 
[0m15:59:58.557160 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:59:58.557160 [info ] [MainThread]: 
[0m15:59:58.565930 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002060 (42601): SQL compilation error:
  Invalid function type [-] for window function.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m15:59:58.566938 [info ] [MainThread]: 
[0m15:59:58.567941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:59:58.570128 [debug] [MainThread]: Command `dbt run` failed at 15:59:58.570128 after 7.97 seconds
[0m15:59:58.571176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0931F920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0931FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B0970CA40>]}
[0m15:59:58.571176 [debug] [MainThread]: Flushing usage events
[0m15:59:59.877899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:41.848496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C18060C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C1804B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C1805A00>]}


============================== 16:00:41.853997 | 935a1bb8-65ca-479f-ad09-9c4a2d9d64ce ==============================
[0m16:00:41.853997 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:00:41.856004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi4', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:43.090654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4CE062990>]}
[0m16:00:43.169878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4CD95BEF0>]}
[0m16:00:43.169878 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:00:43.766834 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:00:43.999390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:43.999390 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m16:00:44.343410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4CEA752E0>]}
[0m16:00:44.438354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:00:44.438354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:00:44.487809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4CEA194F0>]}
[0m16:00:44.487809 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m16:00:44.487809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4CE82A450>]}
[0m16:00:44.487809 [info ] [MainThread]: 
[0m16:00:44.487809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:44.487809 [info ] [MainThread]: 
[0m16:00:44.487809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:44.487809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:00:44.611739 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:00:44.627438 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:00:44.627438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:45.991128 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.376 seconds
[0m16:00:46.010782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m16:00:46.022506 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:00:46.022506 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:00:46.022506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:46.997943 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.973 seconds
[0m16:00:46.997943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m16:00:46.997943 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:00:46.997943 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:00:47.199577 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m16:00:47.207573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m16:00:47.209580 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:00:47.209580 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:00:47.415876 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m16:00:47.415876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4CFDE4A40>]}
[0m16:00:47.415876 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:00:47.415876 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:00:47.415876 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:00:47.415876 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:00:47.435288 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:00:47.437288 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:00:47.467618 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:00:47.467618 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:00:47.467618 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    (total_revenue -LAG(total_revenue) OVER (ORDER BY month) ) AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month;
[0m16:00:47.481332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:00:48.500574 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0016-3201-7e56-000c-3d5a000238ce
[0m16:00:48.516626 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 61 at position 9 unexpected ';'.
[0m16:00:48.516626 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:00:48.516626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '935a1bb8-65ca-479f-ad09-9c4a2d9d64ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D001B6B0>]}
[0m16:00:48.516626 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.10s]
[0m16:00:48.516626 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:00:48.516626 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m16:00:48.516626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:48.516626 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:00:48.516626 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:00:48.850669 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m16:00:48.850669 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m16:00:49.179347 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:00:49.180347 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:00:49.507141 [info ] [MainThread]: 
[0m16:00:49.507141 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m16:00:49.507141 [debug] [MainThread]: Command end result
[0m16:00:49.541282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:00:49.541282 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:00:49.552083 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:00:49.552986 [info ] [MainThread]: 
[0m16:00:49.552986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:00:49.552986 [info ] [MainThread]: 
[0m16:00:49.552986 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 9 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:00:49.552986 [info ] [MainThread]: 
[0m16:00:49.552986 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:00:49.552986 [debug] [MainThread]: Command `dbt run` failed at 16:00:49.552986 after 7.93 seconds
[0m16:00:49.552986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4BF58CFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C16F1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4C12B2CC0>]}
[0m16:00:49.559985 [debug] [MainThread]: Flushing usage events
[0m16:00:50.428243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:04.110537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D8C4F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D8C4CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D8367BF0>]}


============================== 16:04:04.116537 | 722b8ec1-6a69-49ee-a830-7774c5a04076 ==============================
[0m16:04:04.116537 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:04:04.117537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi4', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:04:05.369624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E5F1DE50>]}
[0m16:04:05.453575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E3B76450>]}
[0m16:04:05.453575 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:04:06.065389 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:04:06.294490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:06.294490 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m16:04:06.638766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E65F5280>]}
[0m16:04:06.729354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:04:06.729354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:04:06.775916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E65AE030>]}
[0m16:04:06.775916 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 473 macros
[0m16:04:06.779908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D95679E0>]}
[0m16:04:06.781916 [info ] [MainThread]: 
[0m16:04:06.782543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:06.783554 [info ] [MainThread]: 
[0m16:04:06.783554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:06.785329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:04:06.916249 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:04:06.917251 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:04:06.917251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:08.325970 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.419 seconds
[0m16:04:08.341714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m16:04:08.351793 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:04:08.351793 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:04:08.357765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:09.318009 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.976 seconds
[0m16:04:09.333727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m16:04:09.333727 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:04:09.333727 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:04:09.555806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m16:04:09.563907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m16:04:09.563907 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:04:09.563907 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:04:09.772162 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m16:04:09.777158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E5F77890>]}
[0m16:04:09.777158 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:04:09.777158 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:04:09.777158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:04:09.777158 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:04:09.788085 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:04:09.788085 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:04:09.834832 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:04:09.836831 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:04:09.836831 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (-- WITH customer_revenue AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month,
--         SUM(revenue) AS total_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- revenue_contraction AS (
--     SELECT 
--         cr.CUSTOMER_ID,
--         cr.transaction_month,
--         cr.total_revenue AS current_revenue,
--         COALESCE(lm.total_revenue, 0) AS last_month_revenue,
--         CASE 
--             WHEN COALESCE(lm.total_revenue, 0) > cr.total_revenue THEN 
--                 COALESCE(lm.total_revenue, 0) - cr.total_revenue
--             ELSE 0
--         END AS revenue_lost
--     FROM customer_revenue cr
--     LEFT JOIN customer_revenue lm
--         ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
--         AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
-- ),
-- revenue_lost_over_time AS (
--     SELECT 
--         transaction_month,
--         SUM(revenue_lost) AS total_revenue_lost
--     FROM revenue_contraction
--     GROUP BY transaction_month
--     ORDER BY transaction_month
-- )
-- SELECT 
--     transaction_month,
--     total_revenue_lost
-- FROM revenue_lost_over_time

 
 
WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m16:04:09.837837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:11.486915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.652 seconds
[0m16:04:11.518663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722b8ec1-6a69-49ee-a830-7774c5a04076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D67572F0>]}
[0m16:04:11.518663 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.73s]
[0m16:04:11.518663 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:04:11.518663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:11.518663 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:04:11.518663 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:04:11.860909 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:04:11.860909 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:04:12.187965 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:04:12.189073 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:04:12.502628 [info ] [MainThread]: 
[0m16:04:12.502628 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m16:04:12.502628 [debug] [MainThread]: Command end result
[0m16:04:12.538869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:04:12.538869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:04:12.557253 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:04:12.558215 [info ] [MainThread]: 
[0m16:04:12.558215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:12.559249 [info ] [MainThread]: 
[0m16:04:12.560249 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:12.560249 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:12.560249 after 8.66 seconds
[0m16:04:12.560249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D927E960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128E646D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128D6801010>]}
[0m16:04:12.560249 [debug] [MainThread]: Flushing usage events
[0m16:04:13.872632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:01.725447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847C7131A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847D2582F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847C782A20>]}


============================== 16:22:01.725447 | 8507481f-ad70-4281-8da5-061978db7b06 ==============================
[0m16:22:01.725447 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:22:01.725447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi3', 'send_anonymous_usage_stats': 'True'}
[0m16:22:05.651343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847F4DC3E0>]}
[0m16:22:05.730764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840B71BF80>]}
[0m16:22:05.730764 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:22:06.456798 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:22:08.087178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:22:08.087178 [debug] [MainThread]: Partial parsing: added file: DE_MINI_PROJECT://models\intermediate\kpi3.sql
[0m16:22:08.425358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840C805700>]}
[0m16:22:08.522864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:22:08.536917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:22:08.584403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840C7C6330>]}
[0m16:22:08.584403 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:22:08.584403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840C80F830>]}
[0m16:22:08.584403 [info ] [MainThread]: 
[0m16:22:08.584403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:08.584403 [info ] [MainThread]: 
[0m16:22:08.584403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:22:08.584403 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:22:11.831546 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:22:11.833296 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:22:11.833296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:13.452648 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.620 seconds
[0m16:22:13.454659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m16:22:13.470708 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:22:13.474852 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:22:13.474852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:14.477438 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.009 seconds
[0m16:22:14.477438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m16:22:14.489006 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:22:14.489006 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:22:14.681785 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.204 seconds
[0m16:22:14.697692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m16:22:14.700453 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:22:14.700453 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:22:14.943534 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.242 seconds
[0m16:22:14.947550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840DAFA510>]}
[0m16:22:14.949557 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m16:22:14.949557 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi3 ................................. [RUN]
[0m16:22:14.949557 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m16:22:14.949557 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m16:22:14.957544 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m16:22:14.957544 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m16:22:15.006428 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m16:22:15.010431 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m16:22:15.011430 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue -- Revenue excluding upsells
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        ROUND((total_current_revenue / total_last_month_revenue) * 100, 2) AS NRR,
        ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2) AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        ROUND((total_current_revenue / total_last_month_revenue) * 100, 2) AS NRR,
        ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2) AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m16:22:15.012430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:22:16.882131 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb002c-3201-7db6-000c-3d5a00020bf2
[0m16:22:16.882131 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100051 (22012): Division by zero
[0m16:22:16.894787 [debug] [Thread-1 (]: Database Error in model kpi3 (models\intermediate\kpi3.sql)
  100051 (22012): Division by zero
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi3.sql
[0m16:22:16.894787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8507481f-ad70-4281-8da5-061978db7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840DDE6900>]}
[0m16:22:16.894787 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi3 ........................ [[31mERROR[0m in 1.95s]
[0m16:22:16.894787 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m16:22:16.910599 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\intermediate\kpi3.sql)
  100051 (22012): Division by zero
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi3.sql.
[0m16:22:16.910599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:16.910599 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:22:16.910599 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:22:17.224621 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m16:22:17.240794 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m16:22:17.561234 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m16:22:17.561234 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m16:22:17.882759 [info ] [MainThread]: 
[0m16:22:17.882759 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m16:22:17.895077 [debug] [MainThread]: Command end result
[0m16:22:17.925701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:22:17.927705 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:22:17.935659 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:22:17.935659 [info ] [MainThread]: 
[0m16:22:17.935659 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:22:17.935659 [info ] [MainThread]: 
[0m16:22:17.935659 [error] [MainThread]:   Database Error in model kpi3 (models\intermediate\kpi3.sql)
  100051 (22012): Division by zero
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi3.sql
[0m16:22:17.935659 [info ] [MainThread]: 
[0m16:22:17.935659 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:22:17.935659 [debug] [MainThread]: Command `dbt run` failed at 16:22:17.935659 after 16.48 seconds
[0m16:22:17.935659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847C7131A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847C654890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847F2B9A90>]}
[0m16:22:17.935659 [debug] [MainThread]: Flushing usage events
[0m16:22:19.133929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:20.909229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8726B4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E87090EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86FEC6990>]}


============================== 16:23:20.915859 | 18a4acf2-a320-4a00-8a74-5b125b5cde57 ==============================
[0m16:23:20.915859 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:23:20.915859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi3', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:23:21.427006 [error] [MainThread]: Encountered an error:

[0m16:23:21.572798 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 232, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\runtime.py", line 79, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\__init__.py", line 2, in <module>
    from dbt.adapters.snowflake.connections import SnowflakeConnectionManager
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\connections.py", line 22, in <module>
    from cryptography.hazmat.primitives import serialization
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\cryptography\hazmat\primitives\serialization\__init__.py", line 7, in <module>
    from cryptography.hazmat.primitives._serialization import (
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\cryptography\hazmat\primitives\_serialization.py", line 10, in <module>
    from cryptography.hazmat.primitives.hashes import HashAlgorithm
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\cryptography\hazmat\primitives\hashes.py", line 9, in <module>
    from cryptography.hazmat.bindings._rust import openssl as rust_openssl
  File "<frozen importlib._bootstrap>", line 1349, in _find_and_load
KeyboardInterrupt

[0m16:23:21.575283 [debug] [MainThread]: Command `dbt run` failed at 16:23:21.575283 after 0.90 seconds
[0m16:23:21.576279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E871C53920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8728508F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E872BA3A40>]}
[0m16:23:21.576279 [debug] [MainThread]: Flushing usage events
[0m16:23:22.496024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:33.988370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBDD36690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBDD35820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBDD37A40>]}


============================== 16:23:33.988370 | 879a6120-c662-4523-85eb-5fc9e53d11b7 ==============================
[0m16:23:33.988370 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:23:33.988370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi3', 'send_anonymous_usage_stats': 'True'}
[0m16:23:37.110014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBE001040>]}
[0m16:23:37.188900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCA974D10>]}
[0m16:23:37.188900 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:23:37.883163 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:23:39.499346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:23:39.499346 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi3.sql
[0m16:23:39.835082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCAFE56D0>]}
[0m16:23:39.935140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:23:39.938896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:23:39.986657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCAFA2450>]}
[0m16:23:39.986657 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:23:39.986657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCAFE3830>]}
[0m16:23:39.986657 [info ] [MainThread]: 
[0m16:23:39.986657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:39.986657 [info ] [MainThread]: 
[0m16:23:39.986657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:39.986657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:23:43.123581 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:23:43.123581 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:23:43.123581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:44.680786 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.554 seconds
[0m16:23:44.680786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m16:23:44.696834 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:23:44.696834 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:23:44.696834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:45.699834 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.010 seconds
[0m16:23:45.715813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m16:23:45.731762 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:23:45.731762 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:23:45.958368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.224 seconds
[0m16:23:45.958368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m16:23:45.958368 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:23:45.958368 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:23:46.171302 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.213 seconds
[0m16:23:46.186855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCC21F860>]}
[0m16:23:46.186855 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m16:23:46.186855 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi3 ................................. [RUN]
[0m16:23:46.202853 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m16:23:46.202853 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m16:23:46.225285 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m16:23:46.225285 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m16:23:46.254720 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m16:23:46.254720 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m16:23:46.269944 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue -- Revenue excluding upsells
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m16:23:46.270624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:48.491285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.224 seconds
[0m16:23:48.513171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879a6120-c662-4523-85eb-5fc9e53d11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBB0D7350>]}
[0m16:23:48.513171 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi3 ............................ [[32mSUCCESS 1[0m in 2.31s]
[0m16:23:48.513171 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m16:23:48.513171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:48.513171 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:23:48.513171 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:23:48.852079 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m16:23:48.852079 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m16:23:49.184836 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m16:23:49.184836 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m16:23:49.513279 [info ] [MainThread]: 
[0m16:23:49.513279 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m16:23:49.513279 [debug] [MainThread]: Command end result
[0m16:23:49.550621 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:23:49.561620 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:23:49.565615 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:23:49.565615 [info ] [MainThread]: 
[0m16:23:49.565615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:49.565615 [info ] [MainThread]: 
[0m16:23:49.565615 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:23:49.565615 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:49.565615 after 15.78 seconds
[0m16:23:49.574929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBDA2DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBD5FAFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BBD5FB4A0>]}
[0m16:23:49.574929 [debug] [MainThread]: Flushing usage events
[0m16:23:50.482116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:26.312924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA33C27D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA30E37830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA30E37CB0>]}


============================== 16:37:26.322069 | bc02c64b-4079-4446-a124-ae0c2346af17 ==============================
[0m16:37:26.322069 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:37:26.322069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi5', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:28.234558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc02c64b-4079-4446-a124-ae0c2346af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA408AEA50>]}
[0m16:37:28.321109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc02c64b-4079-4446-a124-ae0c2346af17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA33188110>]}
[0m16:37:28.321109 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:37:28.924987 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:37:29.188591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:29.188591 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m16:37:29.435822 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.DE_MINI_PROJECT.kpi5' (models\intermediate\kpi5.sql) depends on a node named 'stg_TRANSACTION' which was not found
[0m16:37:29.435822 [debug] [MainThread]: Command `dbt run` failed at 16:37:29.435822 after 3.34 seconds
[0m16:37:29.435822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA33AEEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA40AE0A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA40853560>]}
[0m16:37:29.435822 [debug] [MainThread]: Flushing usage events
[0m16:37:30.427875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:55.115210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232836840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232837D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232834770>]}


============================== 16:37:55.115210 | 86cd1663-3a52-42a3-8ed3-39b0109242e2 ==============================
[0m16:37:55.115210 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:37:55.115210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi5', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:58.978855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86cd1663-3a52-42a3-8ed3-39b0109242e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823F15AE10>]}
[0m16:37:59.055709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86cd1663-3a52-42a3-8ed3-39b0109242e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823F15B1A0>]}
[0m16:37:59.057713 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:37:59.777607 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:38:01.430599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:01.432606 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m16:38:01.677237 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.DE_MINI_PROJECT.kpi5' (models\intermediate\kpi5.sql) depends on a node named 'stg_TRANSACTIONS' which was not found
[0m16:38:01.679203 [debug] [MainThread]: Command `dbt run` failed at 16:38:01.678206 after 6.79 seconds
[0m16:38:01.679203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232399280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232A67290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823F042DB0>]}
[0m16:38:01.680205 [debug] [MainThread]: Flushing usage events
[0m16:38:02.623841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:43.286298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE13236990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE132373B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE132358E0>]}


============================== 16:38:43.301951 | 56a5c50d-2ff0-490e-ba37-dfd62f6dde8b ==============================
[0m16:38:43.301951 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:38:43.301951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi5', 'send_anonymous_usage_stats': 'True'}
[0m16:38:44.511457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FEF2FF0>]}
[0m16:38:44.574700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FCDBEF0>]}
[0m16:38:44.590796 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:38:45.163779 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:38:45.396819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:45.405034 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi5.sql
[0m16:38:45.733174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE12F01670>]}
[0m16:38:45.842184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:38:45.859889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:38:45.923348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE204E2180>]}
[0m16:38:45.923348 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:38:45.923348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE202A92B0>]}
[0m16:38:45.923348 [info ] [MainThread]: 
[0m16:38:45.923348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:45.923348 [info ] [MainThread]: 
[0m16:38:45.923348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:45.933598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:38:49.141434 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:38:49.141434 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:38:49.141434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:51.635968 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.490 seconds
[0m16:38:51.635968 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m16:38:51.651803 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:38:51.651803 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:38:51.651803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:52.670861 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.013 seconds
[0m16:38:52.672869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m16:38:52.672869 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:38:52.672869 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:38:52.898012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.233 seconds
[0m16:38:52.913841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m16:38:52.923064 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:38:52.923064 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:38:53.138705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m16:38:53.140645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE2039DB50>]}
[0m16:38:53.140645 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m16:38:53.140645 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m16:38:53.140645 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m16:38:53.140645 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m16:38:53.156259 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m16:38:53.157234 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m16:38:53.197133 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m16:38:53.199098 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m16:38:53.200098 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m16:38:53.200098 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:54.191934 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003c-3201-7e57-000c-3d5a0001feca
[0m16:38:54.191934 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 12
invalid identifier 'PAYMENT_DATE'
[0m16:38:54.220877 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  000904 (42000): SQL compilation error: error line 6 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m16:38:54.223868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a5c50d-2ff0-490e-ba37-dfd62f6dde8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE126E9940>]}
[0m16:38:54.224501 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 1.08s]
[0m16:38:54.224501 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m16:38:54.224501 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  000904 (42000): SQL compilation error: error line 6 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m16:38:54.224501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:54.224501 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:38:54.224501 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:38:54.551280 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m16:38:54.551280 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m16:38:54.897240 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m16:38:54.899263 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m16:38:55.240707 [info ] [MainThread]: 
[0m16:38:55.240707 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m16:38:55.247232 [debug] [MainThread]: Command end result
[0m16:38:55.287850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:38:55.289857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:38:55.294068 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:38:55.294068 [info ] [MainThread]: 
[0m16:38:55.294068 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:55.294068 [info ] [MainThread]: 
[0m16:38:55.294068 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  000904 (42000): SQL compilation error: error line 6 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m16:38:55.294068 [info ] [MainThread]: 
[0m16:38:55.294068 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:55.294068 [debug] [MainThread]: Command `dbt run` failed at 16:38:55.294068 after 12.24 seconds
[0m16:38:55.294068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE12D9B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE130FABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE10FFC170>]}
[0m16:38:55.294068 [debug] [MainThread]: Flushing usage events
[0m16:38:56.197196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:56.296072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02E4AC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02CD80FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02CD82DE0>]}


============================== 16:40:56.296072 | 4e6238c9-a631-4b70-ad95-f9f0a54d3ca6 ==============================
[0m16:40:56.296072 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:40:56.296072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi5', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:40:57.504582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03D38E0C0>]}
[0m16:40:57.581353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03D26E750>]}
[0m16:40:57.583361 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:40:58.167533 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:40:58.401232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:58.402198 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_transactions.sql
[0m16:40:58.735016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03D935730>]}
[0m16:40:58.835367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:40:58.835367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:40:58.876148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03D8F21E0>]}
[0m16:40:58.876148 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:40:58.876148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0306FE600>]}
[0m16:40:58.885906 [info ] [MainThread]: 
[0m16:40:58.885906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:58.885906 [info ] [MainThread]: 
[0m16:40:58.885906 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:58.889418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:40:59.014059 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:40:59.014059 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:40:59.014059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:00.665312 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.653 seconds
[0m16:41:00.691728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m16:41:00.694829 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:41:00.694829 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:41:00.694829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:01.715497 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.014 seconds
[0m16:41:01.715497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m16:41:01.715497 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:41:01.715497 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:41:01.959501 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.229 seconds
[0m16:41:01.961512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m16:41:01.965679 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:41:01.965679 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:41:02.151599 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.197 seconds
[0m16:41:02.167502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03D7FC380>]}
[0m16:41:02.167502 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m16:41:02.167502 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m16:41:02.167502 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m16:41:02.167502 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m16:41:02.183415 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m16:41:02.183415 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m16:41:02.219254 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m16:41:02.234512 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m16:41:02.235211 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m16:41:02.235211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:03.188270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003f-3201-7e57-000c-3d5a0001fed2
[0m16:41:03.188270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 12
invalid identifier 'PAYMENT_DATE'
[0m16:41:03.205119 [debug] [Thread-1 (]: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  000904 (42000): SQL compilation error: error line 6 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m16:41:03.208118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e6238c9-a631-4b70-ad95-f9f0a54d3ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03ECCC860>]}
[0m16:41:03.209122 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi5 ........................ [[31mERROR[0m in 1.04s]
[0m16:41:03.211119 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m16:41:03.212117 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi5' to be skipped because of status 'error'.  Reason: Database Error in model kpi5 (models\intermediate\kpi5.sql)
  000904 (42000): SQL compilation error: error line 6 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql.
[0m16:41:03.214117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:03.214117 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:41:03.215155 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:41:03.546858 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m16:41:03.553390 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m16:41:03.881569 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m16:41:03.881569 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m16:41:04.222856 [info ] [MainThread]: 
[0m16:41:04.222856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m16:41:04.222856 [debug] [MainThread]: Command end result
[0m16:41:04.255229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:41:04.255229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:41:04.255229 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:41:04.255229 [info ] [MainThread]: 
[0m16:41:04.255229 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:04.268499 [info ] [MainThread]: 
[0m16:41:04.269325 [error] [MainThread]:   Database Error in model kpi5 (models\intermediate\kpi5.sql)
  000904 (42000): SQL compilation error: error line 6 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi5.sql
[0m16:41:04.270336 [info ] [MainThread]: 
[0m16:41:04.271336 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:41:04.273207 [debug] [MainThread]: Command `dbt run` failed at 16:41:04.273207 after 8.30 seconds
[0m16:41:04.273207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02E4AC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02FDDE6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C03D413740>]}
[0m16:41:04.273207 [debug] [MainThread]: Flushing usage events
[0m16:41:05.546791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:55.917017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677D817290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677D1026F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677D8156A0>]}


============================== 16:42:55.932816 | 63901fa3-4ab6-4170-954a-8e61148f5cb5 ==============================
[0m16:42:55.932816 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:42:55.932816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:42:57.125979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670A55E270>]}
[0m16:42:57.204873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670A4F9F40>]}
[0m16:42:57.206512 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:42:57.780652 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:42:58.003201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:58.003201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:58.059114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670A790440>]}
[0m16:42:58.158167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:42:58.161922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:42:58.193434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670A840A40>]}
[0m16:42:58.193434 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:42:58.193434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670A7937D0>]}
[0m16:42:58.193434 [info ] [MainThread]: 
[0m16:42:58.193434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:58.193434 [info ] [MainThread]: 
[0m16:42:58.193434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:58.209452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:42:58.341764 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:42:58.343772 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:42:58.343772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:59.764955 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.425 seconds
[0m16:42:59.792068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m16:42:59.812643 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:42:59.812643 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:42:59.812643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:00.802580 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.988 seconds
[0m16:43:00.802580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m16:43:00.818778 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:43:00.818778 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:43:01.017180 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.201 seconds
[0m16:43:01.017180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m16:43:01.017180 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:43:01.017180 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:43:01.224661 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m16:43:01.224661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016709453E60>]}
[0m16:43:01.224661 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m16:43:01.224661 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_transactions .......................... [RUN]
[0m16:43:01.240339 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_transactions'
[0m16:43:01.240339 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m16:43:01.240339 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m16:43:01.240339 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m16:43:01.293095 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m16:43:01.296559 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m16:43:01.296559 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month AS payment_date,
    revenue_type,
    revenue,
    quantity
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_date IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m16:43:01.296559 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:03.219022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m16:43:03.250645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63901fa3-4ab6-4170-954a-8e61148f5cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677ABB72C0>]}
[0m16:43:03.250645 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 2.01s]
[0m16:43:03.250645 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m16:43:03.250645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:03.250645 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:43:03.250645 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:43:03.588559 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m16:43:03.588559 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m16:43:03.923385 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_transactions' was left open.
[0m16:43:03.923385 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_transactions: Close
[0m16:43:04.259754 [info ] [MainThread]: 
[0m16:43:04.261764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m16:43:04.261764 [debug] [MainThread]: Command end result
[0m16:43:04.295123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:43:04.296120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:43:04.306754 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:43:04.307770 [info ] [MainThread]: 
[0m16:43:04.308366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:04.308366 [info ] [MainThread]: 
[0m16:43:04.308366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:04.312153 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:04.312153 after 8.59 seconds
[0m16:43:04.312153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677D6AFEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677D4526C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001677CCC31A0>]}
[0m16:43:04.312153 [debug] [MainThread]: Flushing usage events
[0m16:43:05.254678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:19.127076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527766A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527BA54560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527BA55550>]}


============================== 16:43:19.142812 | 117aecea-25ac-4af1-8c1f-5472482ecb0c ==============================
[0m16:43:19.142812 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:43:19.142812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi5', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:20.333621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527B11ED20>]}
[0m16:43:20.413541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527AA28C20>]}
[0m16:43:20.413541 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:43:20.981626 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:43:21.203575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:21.203575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:21.250560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152062771D0>]}
[0m16:43:21.360583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:43:21.360583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:43:21.392235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208A26420>]}
[0m16:43:21.392235 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:43:21.408305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152084523F0>]}
[0m16:43:21.408305 [info ] [MainThread]: 
[0m16:43:21.408305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:21.408305 [info ] [MainThread]: 
[0m16:43:21.408305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:21.408305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:43:21.540498 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:43:21.540498 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:43:21.540498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:22.865249 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.323 seconds
[0m16:43:22.882952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m16:43:22.897044 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:43:22.897044 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:43:22.897044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:23.842339 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.950 seconds
[0m16:43:23.850033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m16:43:23.852041 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:43:23.852041 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:43:24.065186 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.212 seconds
[0m16:43:24.067198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m16:43:24.069206 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:43:24.071214 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:43:24.279964 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.209 seconds
[0m16:43:24.284552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520873FD70>]}
[0m16:43:24.287478 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m16:43:24.287478 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi5 ................................. [RUN]
[0m16:43:24.287478 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi5'
[0m16:43:24.287478 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m16:43:24.287478 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m16:43:24.287478 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m16:43:24.345663 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m16:43:24.347662 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m16:43:24.348665 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m16:43:24.349662 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:25.929541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.581 seconds
[0m16:43:25.958947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117aecea-25ac-4af1-8c1f-5472482ecb0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015278DFB590>]}
[0m16:43:25.958947 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi5 ............................ [[32mSUCCESS 1[0m in 1.67s]
[0m16:43:25.958947 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m16:43:25.958947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:25.958947 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:43:25.958947 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:43:26.307668 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:43:26.307668 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:43:26.644897 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi5' was left open.
[0m16:43:26.644897 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi5: Close
[0m16:43:26.984722 [info ] [MainThread]: 
[0m16:43:26.986730 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m16:43:26.986730 [debug] [MainThread]: Command end result
[0m16:43:27.017455 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:43:27.019405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:43:27.020407 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:43:27.020407 [info ] [MainThread]: 
[0m16:43:27.020407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:27.029353 [info ] [MainThread]: 
[0m16:43:27.030365 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:27.032121 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:27.032121 after 8.09 seconds
[0m16:43:27.032121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527B87AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527AE2DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001527B583410>]}
[0m16:43:27.032121 [debug] [MainThread]: Flushing usage events
[0m16:43:27.990759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:06.807622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8254A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C84798290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C847982C0>]}


============================== 16:47:06.807622 | 1a6b8496-0b06-4b9b-bcd8-830497396fc3 ==============================
[0m16:47:06.807622 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:47:06.807622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi4', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:08.002293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C868C1370>]}
[0m16:47:08.084926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8626ECF0>]}
[0m16:47:08.084926 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:47:08.683219 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:47:08.910065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:08.910065 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m16:47:09.243345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C93C095B0>]}
[0m16:47:09.349207 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:47:09.349207 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:47:09.386573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C93BC22A0>]}
[0m16:47:09.386573 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:47:09.386573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C93892F00>]}
[0m16:47:09.396459 [info ] [MainThread]: 
[0m16:47:09.396459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:09.396459 [info ] [MainThread]: 
[0m16:47:09.396459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:47:09.396459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:47:09.517828 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:47:09.517828 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:47:09.517828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:10.904751 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.377 seconds
[0m16:47:10.904751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m16:47:10.928143 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:47:10.928143 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:47:10.929143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:11.906411 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.986 seconds
[0m16:47:11.917812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m16:47:11.919820 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:47:11.919820 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:47:12.116177 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.209 seconds
[0m16:47:12.132022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m16:47:12.141160 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:47:12.147763 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:47:12.357175 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.223 seconds
[0m16:47:12.373140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C93C2E840>]}
[0m16:47:12.373140 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:47:12.373140 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:47:12.389171 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:47:12.391982 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:47:12.403040 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:47:12.403040 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:47:12.444122 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:47:12.446126 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:47:12.447119 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_date) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
ORDER BY
    month
        );
[0m16:47:12.447119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:14.039534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.602 seconds
[0m16:47:14.070949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a6b8496-0b06-4b9b-bcd8-830497396fc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C83D7B4D0>]}
[0m16:47:14.070949 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.68s]
[0m16:47:14.070949 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:47:14.070949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:14.070949 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:47:14.070949 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:47:14.413695 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:47:14.413695 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:47:14.737314 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:47:14.753166 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:47:15.076037 [info ] [MainThread]: 
[0m16:47:15.076037 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m16:47:15.091866 [debug] [MainThread]: Command end result
[0m16:47:15.126668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:47:15.128659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:47:15.130661 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:47:15.130661 [info ] [MainThread]: 
[0m16:47:15.130661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:15.130661 [info ] [MainThread]: 
[0m16:47:15.139783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:15.141791 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:15.141791 after 8.61 seconds
[0m16:47:15.142690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8254A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C869ADE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C869AF230>]}
[0m16:47:15.142690 [debug] [MainThread]: Flushing usage events
[0m16:47:16.721834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:13.165496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5440072F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F544006840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5440074D0>]}


============================== 16:50:13.165496 | 3cf233cf-6f1f-4502-a8ca-99691f400ba5 ==============================
[0m16:50:13.165496 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:50:13.181296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi4', 'send_anonymous_usage_stats': 'True'}
[0m16:50:14.374625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55049ECF0>]}
[0m16:50:14.462486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5500987D0>]}
[0m16:50:14.464490 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:50:15.064221 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:50:15.299263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:50:15.299263 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m16:50:15.627429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55114D760>]}
[0m16:50:15.723846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:50:15.739750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:50:15.771723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5512894F0>]}
[0m16:50:15.771723 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:50:15.771723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F550DB6600>]}
[0m16:50:15.784524 [info ] [MainThread]: 
[0m16:50:15.784524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:15.784524 [info ] [MainThread]: 
[0m16:50:15.787360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:15.787360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:50:15.905657 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:50:15.905657 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:50:15.905657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:17.357552 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.455 seconds
[0m16:50:17.373606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m16:50:17.397581 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:50:17.399589 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:50:17.399589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:18.386584 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.987 seconds
[0m16:50:18.388589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m16:50:18.394347 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:50:18.394347 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:50:18.602307 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m16:50:18.610573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m16:50:18.618218 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:50:18.618218 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:50:18.833092 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.218 seconds
[0m16:50:18.833092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5513225D0>]}
[0m16:50:18.833092 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:50:18.833092 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:50:18.833092 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:50:18.833092 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:50:18.856820 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:50:18.856820 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:50:18.896391 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:50:18.898400 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:50:18.899433 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_date) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
WHERE
    LAG(total_revenue) OVER (ORDER BY month) > total_revenue    
ORDER BY
    month
        );
[0m16:50:18.899433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:19.877074 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0048-3201-7e9a-000c-3d5a000216a6
[0m16:50:19.879082 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002063 (42601): SQL compilation error:
Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
[0m16:50:19.883530 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:50:19.884538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cf233cf-6f1f-4502-a8ca-99691f400ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F550CF6720>]}
[0m16:50:19.884538 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.05s]
[0m16:50:19.888488 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:50:19.888488 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m16:50:19.888488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:19.888488 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:50:19.888488 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:50:20.235131 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:50:20.235131 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:50:20.565026 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:50:20.565026 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:50:20.927832 [info ] [MainThread]: 
[0m16:50:20.927832 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m16:50:20.927832 [debug] [MainThread]: Command end result
[0m16:50:20.965719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:50:20.965719 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:50:20.976774 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:50:20.976774 [info ] [MainThread]: 
[0m16:50:20.977773 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:50:20.977773 [info ] [MainThread]: 
[0m16:50:20.977773 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:50:20.977773 [info ] [MainThread]: 
[0m16:50:20.977773 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:50:20.983823 [debug] [MainThread]: Command `dbt run` failed at 16:50:20.983823 after 8.04 seconds
[0m16:50:20.983823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F544006840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5440072F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F544004590>]}
[0m16:50:20.984835 [debug] [MainThread]: Flushing usage events
[0m16:50:21.939561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:51:19.591524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556E6858E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556E6875C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556E687290>]}


============================== 16:51:19.604825 | 6a0f3b8f-6797-4c8e-9158-8f63f7da62fc ==============================
[0m16:51:19.604825 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:51:19.604825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi4', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:51:20.797729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025578E49190>]}
[0m16:51:20.868349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025579EEF980>]}
[0m16:51:20.876181 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:51:21.474721 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:51:21.708412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:51:21.708412 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m16:51:22.050353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557B8E5670>]}
[0m16:51:22.145690 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:51:22.145690 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:51:22.193759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557B8A6240>]}
[0m16:51:22.193759 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:51:22.193759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557B8E1BE0>]}
[0m16:51:22.193759 [info ] [MainThread]: 
[0m16:51:22.193759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:22.193759 [info ] [MainThread]: 
[0m16:51:22.193759 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:22.204603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:51:22.332314 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:51:22.332314 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:51:22.332314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:23.934676 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.602 seconds
[0m16:51:23.940802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m16:51:23.955675 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:51:23.955675 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:51:23.955675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:24.948549 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.003 seconds
[0m16:51:24.948549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m16:51:24.964334 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:51:24.964334 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:51:25.158866 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m16:51:25.177068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m16:51:25.189982 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:51:25.191045 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:51:25.415705 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.226 seconds
[0m16:51:25.421580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557B3DE960>]}
[0m16:51:25.423588 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:51:25.423588 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:51:25.423588 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:51:25.423588 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:51:25.436682 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:51:25.438967 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:51:25.477781 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:51:25.479748 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:51:25.480782 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_date) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
WHERE
    revenue_lost > 0
ORDER BY
    month
        );
[0m16:51:25.480782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:26.450293 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0049-3201-7e57-000c-3d5a0001ff6a
[0m16:51:26.450293 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002063 (42601): SQL compilation error:
Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
[0m16:51:26.450293 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:51:26.450293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a0f3b8f-6797-4c8e-9158-8f63f7da62fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556DB314C0>]}
[0m16:51:26.450293 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.03s]
[0m16:51:26.450293 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:51:26.450293 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m16:51:26.450293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:26.450293 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:51:26.450293 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:51:26.791068 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m16:51:26.806054 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m16:51:27.160338 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:51:27.160338 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:51:27.500438 [info ] [MainThread]: 
[0m16:51:27.516306 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m16:51:27.516306 [debug] [MainThread]: Command end result
[0m16:51:27.563740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:51:27.567756 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:51:27.575428 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:51:27.576427 [info ] [MainThread]: 
[0m16:51:27.577426 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:51:27.578054 [info ] [MainThread]: 
[0m16:51:27.579063 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:51:27.580063 [info ] [MainThread]: 
[0m16:51:27.580063 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:51:27.582063 [debug] [MainThread]: Command `dbt run` failed at 16:51:27.582063 after 8.18 seconds
[0m16:51:27.582063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556E6A3BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556E6A3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002556E6A3C50>]}
[0m16:51:27.583096 [debug] [MainThread]: Flushing usage events
[0m16:51:28.918233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:17.317187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015878A96C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158787F6A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158787F6540>]}


============================== 16:52:17.325500 | 0eb17970-3b1a-430e-9f66-eaf494e75378 ==============================
[0m16:52:17.325500 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:52:17.326501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:18.520860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eb17970-3b1a-430e-9f66-eaf494e75378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015805491DF0>]}
[0m16:52:18.598017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eb17970-3b1a-430e-9f66-eaf494e75378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587F2437D0>]}
[0m16:52:18.599984 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:52:19.174443 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:52:19.380331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:19.380331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:19.443644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eb17970-3b1a-430e-9f66-eaf494e75378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158058E6DE0>]}
[0m16:52:19.538335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:52:19.538335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:52:19.585938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eb17970-3b1a-430e-9f66-eaf494e75378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015805BB2AE0>]}
[0m16:52:19.585938 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:52:19.585938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eb17970-3b1a-430e-9f66-eaf494e75378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015805B2B470>]}
[0m16:52:19.585938 [info ] [MainThread]: 
[0m16:52:19.585938 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:19.585938 [info ] [MainThread]: 
[0m16:52:19.585938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:19.601013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m16:52:19.730600 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:52:19.730600 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:52:19.730600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:21.146084 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.415 seconds
[0m16:52:21.146084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m16:52:21.146084 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:52:21.146084 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:52:21.358703 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.213 seconds
[0m16:52:21.374717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m16:52:21.390530 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:52:21.390530 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:52:21.583361 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.194 seconds
[0m16:52:21.583361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eb17970-3b1a-430e-9f66-eaf494e75378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587FA2E5D0>]}
[0m16:52:21.583361 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m16:52:21.583361 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_products'
[0m16:52:21.583361 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m16:52:21.599513 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m16:52:21.604595 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m16:52:21.604595 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m16:52:21.606601 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m16:52:21.606601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m16:52:21.606601 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m16:52:21.610611 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m16:52:21.610611 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m16:52:21.610611 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m16:52:21.610611 [debug] [Thread-1 (]: Began running node seed.DE_MINI_PROJECT.country_region
[0m16:52:21.610611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now seed.DE_MINI_PROJECT.country_region)
[0m16:52:21.615201 [debug] [Thread-1 (]: Began compiling node seed.DE_MINI_PROJECT.country_region
[0m16:52:21.615201 [debug] [Thread-1 (]: Began executing node seed.DE_MINI_PROJECT.country_region
[0m16:52:21.615201 [debug] [Thread-1 (]: Finished running node seed.DE_MINI_PROJECT.country_region
[0m16:52:21.615201 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m16:52:21.615201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.DE_MINI_PROJECT.country_region, now model.DE_MINI_PROJECT.kpi2)
[0m16:52:21.615201 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m16:52:21.615201 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m16:52:21.615201 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m16:52:21.615201 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m16:52:21.615201 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m16:52:21.615201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi2, now model.DE_MINI_PROJECT.kpi3)
[0m16:52:21.615201 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m16:52:21.630942 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m16:52:21.630942 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m16:52:21.630942 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m16:52:21.630942 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:52:21.635207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi3, now model.DE_MINI_PROJECT.kpi4)
[0m16:52:21.635207 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:52:21.635207 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:52:21.635207 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:52:21.635207 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:52:21.635207 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m16:52:21.635207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi4, now model.DE_MINI_PROJECT.kpi5)
[0m16:52:21.635207 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m16:52:21.635207 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m16:52:21.635207 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m16:52:21.647091 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m16:52:21.647091 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m16:52:21.647091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi5, now model.DE_MINI_PROJECT.kpi6)
[0m16:52:21.647091 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m16:52:21.647091 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m16:52:21.647091 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m16:52:21.647091 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m16:52:21.647091 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_country
[0m16:52:21.647091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi6, now model.DE_MINI_PROJECT.stg_country)
[0m16:52:21.647091 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_country
[0m16:52:21.647091 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_country"
[0m16:52:21.647091 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_country
[0m16:52:21.647091 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_country
[0m16:52:21.647091 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_country, now model.DE_MINI_PROJECT.stg_customers)
[0m16:52:21.663048 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m16:52:21.663048 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.intermediate_customers)
[0m16:52:21.663048 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m16:52:21.663048 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m16:52:21.663048 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m16:52:21.663048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.intermediate_customers, now model.DE_MINI_PROJECT.kpi1)
[0m16:52:21.678924 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m16:52:21.682797 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m16:52:21.682797 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m16:52:21.684805 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m16:52:21.684805 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m16:52:21.684805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi1, now model.DE_MINI_PROJECT.kpi7)
[0m16:52:21.684805 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m16:52:21.688821 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m16:52:21.688821 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m16:52:21.688821 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m16:52:21.688821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:21.688821 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:52:21.688821 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:52:22.024091 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was properly closed.
[0m16:52:22.028107 [debug] [MainThread]: Command end result
[0m16:52:22.051334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:52:22.051334 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:52:22.067302 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:52:22.067302 [debug] [MainThread]: Command `dbt compile` succeeded at 16:52:22.067302 after 4.97 seconds
[0m16:52:22.067302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587685C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587685C1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587685C200>]}
[0m16:52:22.067302 [debug] [MainThread]: Flushing usage events
[0m16:52:23.016654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:30.980343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A5367EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A53654F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A5365940>]}


============================== 16:52:30.989976 | 6e371531-1b8c-4b0a-80cd-280d612a2082 ==============================
[0m16:52:30.989976 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:52:30.989976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi4', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:32.189287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A5387F80>]}
[0m16:52:32.259981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B13A87D0>]}
[0m16:52:32.266520 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:52:32.851305 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:52:33.064479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:33.064479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:33.111723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B1F75AF0>]}
[0m16:52:33.206701 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:52:33.222538 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:52:33.260633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B244DBB0>]}
[0m16:52:33.260633 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:52:33.260633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B22709B0>]}
[0m16:52:33.268217 [info ] [MainThread]: 
[0m16:52:33.268217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:33.269954 [info ] [MainThread]: 
[0m16:52:33.269954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:33.271683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:52:33.390261 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:52:33.390261 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:52:33.390261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:34.507855 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.105 seconds
[0m16:52:34.507855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m16:52:34.523207 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:52:34.523207 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:52:34.523207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:35.495605 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.971 seconds
[0m16:52:35.495605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m16:52:35.513600 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:52:35.513600 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:52:35.721044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m16:52:35.737007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m16:52:35.741152 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:52:35.743164 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:52:35.946744 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.208 seconds
[0m16:52:35.958373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A53862A0>]}
[0m16:52:35.962881 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:52:35.962881 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:52:35.962881 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:52:35.962881 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:52:35.976303 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:52:35.976303 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:52:36.017296 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:52:36.019259 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:52:36.020300 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_date) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
WHERE
    revenue_lost > 0
ORDER BY
    month
        );
[0m16:52:36.020300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:52:37.414276 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb004a-3201-7d7b-000c-3d5a00022b6e
[0m16:52:37.416284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002063 (42601): SQL compilation error:
Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
[0m16:52:37.420299 [debug] [Thread-1 (]: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:52:37.422307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e371531-1b8c-4b0a-80cd-280d612a2082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A4811430>]}
[0m16:52:37.422307 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate.kpi4 ........................ [[31mERROR[0m in 1.46s]
[0m16:52:37.422307 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:52:37.422307 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql.
[0m16:52:37.422307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:37.422307 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:52:37.422307 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:52:37.757514 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m16:52:37.757514 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m16:52:38.100427 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:52:38.102437 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:52:38.421868 [info ] [MainThread]: 
[0m16:52:38.421868 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m16:52:38.421868 [debug] [MainThread]: Command end result
[0m16:52:38.469384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:52:38.469384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:52:38.480866 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:52:38.480866 [info ] [MainThread]: 
[0m16:52:38.480866 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:52:38.480866 [info ] [MainThread]: 
[0m16:52:38.480866 [error] [MainThread]:   Database Error in model kpi4 (models\intermediate\kpi4.sql)
  002063 (42601): SQL compilation error:
  Window function [LAG(MONTHLY_REVENUE.TOTAL_REVENUE) OVER (ORDER BY MONTHLY_REVENUE.MONTH ASC NULLS LAST)] appears outside of SELECT, QUALIFY, and ORDER BY clauses.
  compiled code at target\run\DE_MINI_PROJECT\models\intermediate\kpi4.sql
[0m16:52:38.480866 [info ] [MainThread]: 
[0m16:52:38.480866 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:52:38.487786 [debug] [MainThread]: Command `dbt run` failed at 16:52:38.480866 after 7.71 seconds
[0m16:52:38.487786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A5387D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A29ECFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197A3129520>]}
[0m16:52:38.488829 [debug] [MainThread]: Flushing usage events
[0m16:52:39.413995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:01.809247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293728C6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293728C7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293728C6780>]}


============================== 16:53:01.809247 | a0f02104-5fd7-456a-aaa1-b62105750eb4 ==============================
[0m16:53:01.809247 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:53:01.809247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi4', 'send_anonymous_usage_stats': 'True'}
[0m16:53:05.389619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937F3423F0>]}
[0m16:53:05.472982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937F4F30E0>]}
[0m16:53:05.472982 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:53:06.199250 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:53:07.825374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:07.827381 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\intermediate\kpi4.sql
[0m16:53:08.163012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937FB25580>]}
[0m16:53:08.257946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:53:08.273643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:53:08.317136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937FAE62D0>]}
[0m16:53:08.320360 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:53:08.321370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002937FA09460>]}
[0m16:53:08.321370 [info ] [MainThread]: 
[0m16:53:08.321370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:08.321370 [info ] [MainThread]: 
[0m16:53:08.321370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:08.326456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:53:11.369622 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:53:11.369622 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:53:11.369622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:12.950380 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.578 seconds
[0m16:53:12.961948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m16:53:12.978026 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m16:53:12.978026 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m16:53:12.978026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:13.973538 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.993 seconds
[0m16:53:13.975545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m16:53:13.981565 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:53:13.981565 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:53:14.185331 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m16:53:14.185331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m16:53:14.185331 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:53:14.185331 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:53:14.390100 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m16:53:14.394134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002936FD112B0>]}
[0m16:53:14.394134 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:53:14.394134 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate.kpi4 ................................. [RUN]
[0m16:53:14.394134 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m16:53:14.394134 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:53:14.403980 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:53:14.403980 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:53:14.450553 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:53:14.452553 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:53:14.452553 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.intermediate.kpi4
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_date) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
-- WHERE
--     revenue_lost > 0
ORDER BY
    month
        );
[0m16:53:14.453556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:15.778200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.328 seconds
[0m16:53:15.831595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f02104-5fd7-456a-aaa1-b62105750eb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002936FC673B0>]}
[0m16:53:15.831595 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate.kpi4 ............................ [[32mSUCCESS 1[0m in 1.44s]
[0m16:53:15.831595 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:53:15.831595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:15.831595 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m16:53:15.831595 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m16:53:16.177944 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:53:16.183138 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:53:16.506552 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m16:53:16.506552 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m16:53:16.842299 [info ] [MainThread]: 
[0m16:53:16.842299 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m16:53:16.842299 [debug] [MainThread]: Command end result
[0m16:53:16.868240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:53:16.868240 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:53:16.883466 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:53:16.884767 [info ] [MainThread]: 
[0m16:53:16.885909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:16.887133 [info ] [MainThread]: 
[0m16:53:16.887758 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:16.889545 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:16.888503 after 15.31 seconds
[0m16:53:16.889545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029372684500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029371DDD5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029372372420>]}
[0m16:53:16.890545 [debug] [MainThread]: Flushing usage events
[0m16:53:17.848955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:31.626437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E159BB6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E159BB5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E159BB7530>]}


============================== 16:58:31.626437 | c78b3bbf-9b14-4e02-90d1-e1ac6f052610 ==============================
[0m16:58:31.626437 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:58:31.642101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:33.809246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E165979D00>]}
[0m16:58:33.872296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E16540DB20>]}
[0m16:58:33.889213 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:58:34.479056 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:58:34.605080 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:58:34.605080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E166BB31D0>]}
[0m16:58:36.422078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E167E23A10>]}
[0m16:58:36.516320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:58:36.516320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:58:36.589196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E167E32840>]}
[0m16:58:36.589196 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:58:36.594951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E167E13C80>]}
[0m16:58:36.594951 [info ] [MainThread]: 
[0m16:58:36.598252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:36.598252 [info ] [MainThread]: 
[0m16:58:36.600555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:36.606852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m16:58:36.778840 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:58:36.778840 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:58:36.778840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:38.378006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.597 seconds
[0m16:58:38.378006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m16:58:38.378006 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m16:58:38.378006 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m16:58:38.785329 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb0050-3201-7e57-000c-3d5a0001ff7a
[0m16:58:38.785329 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:58:38.785329 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:58:38.785329 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:58:38.785329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m16:58:38.785329 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:58:38.785329 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:58:39.015842 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.224 seconds
[0m16:58:39.027387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78b3bbf-9b14-4e02-90d1-e1ac6f052610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E157001040>]}
[0m16:58:39.037621 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m16:58:39.048882 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_products'
[0m16:58:39.050907 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m16:58:39.050907 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m16:58:39.050907 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m16:58:39.050907 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m16:58:39.050907 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m16:58:39.066805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m16:58:39.066805 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m16:58:39.070821 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m16:58:39.070821 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m16:58:39.072829 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m16:58:39.072829 [debug] [Thread-1 (]: Began running node seed.DE_MINI_PROJECT.country_region
[0m16:58:39.072829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now seed.DE_MINI_PROJECT.country_region)
[0m16:58:39.072829 [debug] [Thread-1 (]: Began compiling node seed.DE_MINI_PROJECT.country_region
[0m16:58:39.076845 [debug] [Thread-1 (]: Began executing node seed.DE_MINI_PROJECT.country_region
[0m16:58:39.076845 [debug] [Thread-1 (]: Finished running node seed.DE_MINI_PROJECT.country_region
[0m16:58:39.076845 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m16:58:39.076845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.DE_MINI_PROJECT.country_region, now model.DE_MINI_PROJECT.kpi2)
[0m16:58:39.076845 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m16:58:39.082514 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m16:58:39.084493 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m16:58:39.084493 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m16:58:39.086501 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m16:58:39.086501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi2, now model.DE_MINI_PROJECT.kpi3)
[0m16:58:39.086501 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m16:58:39.090516 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m16:58:39.090516 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m16:58:39.090516 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m16:58:39.090516 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:58:39.093893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi3, now model.DE_MINI_PROJECT.kpi4)
[0m16:58:39.093893 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:58:39.097909 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:58:39.099918 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:58:39.099918 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:58:39.101927 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m16:58:39.101927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi4, now model.DE_MINI_PROJECT.kpi5)
[0m16:58:39.101927 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m16:58:39.105945 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m16:58:39.105945 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m16:58:39.108857 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m16:58:39.108857 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m16:58:39.108857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi5, now model.DE_MINI_PROJECT.kpi6)
[0m16:58:39.108857 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m16:58:39.113525 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m16:58:39.116033 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m16:58:39.116033 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m16:58:39.116033 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_country
[0m16:58:39.118040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi6, now model.DE_MINI_PROJECT.stg_country)
[0m16:58:39.118040 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_country
[0m16:58:39.120048 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_country"
[0m16:58:39.122054 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_country
[0m16:58:39.122054 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_country
[0m16:58:39.123899 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m16:58:39.123899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_country, now model.DE_MINI_PROJECT.stg_customers)
[0m16:58:39.123899 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m16:58:39.127915 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m16:58:39.129426 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m16:58:39.129426 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m16:58:39.129426 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m16:58:39.129426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.intermediate_customers)
[0m16:58:39.129426 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m16:58:39.135677 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m16:58:39.135677 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m16:58:39.135677 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m16:58:39.139089 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m16:58:39.139089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.intermediate_customers, now model.DE_MINI_PROJECT.kpi1)
[0m16:58:39.139089 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m16:58:39.143104 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m16:58:39.145110 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m16:58:39.145110 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m16:58:39.145110 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m16:58:39.147035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi1, now model.DE_MINI_PROJECT.kpi7)
[0m16:58:39.147035 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m16:58:39.151633 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m16:58:39.151633 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m16:58:39.151633 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m16:58:39.151633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:39.151633 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m16:58:39.151633 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m16:58:39.489169 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was properly closed.
[0m16:58:39.489169 [debug] [MainThread]: Command end result
[0m16:58:39.520936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:58:39.520936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:58:39.520936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:58:39.536653 [debug] [MainThread]: Command `dbt compile` succeeded at 16:58:39.536653 after 8.20 seconds
[0m16:58:39.536653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1593A5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E157978260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1579781D0>]}
[0m16:58:39.538631 [debug] [MainThread]: Flushing usage events
[0m16:58:40.521074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:00.212955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3BE66F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3BB5D490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3B55D700>]}


============================== 16:59:00.228712 | 9595489a-f2ab-43fc-8ff8-e8fe4b48849b ==============================
[0m16:59:00.228712 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:59:00.228712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:01.424414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E47766300>]}
[0m16:59:01.494240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3BBC85F0>]}
[0m16:59:01.494240 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:59:02.090098 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:59:02.299906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:02.299906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:02.347737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E48AB4590>]}
[0m16:59:02.458356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:59:02.458356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:59:02.506164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E48F489E0>]}
[0m16:59:02.506164 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m16:59:02.506164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E48BA3CE0>]}
[0m16:59:02.509338 [info ] [MainThread]: 
[0m16:59:02.509338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:02.509338 [info ] [MainThread]: 
[0m16:59:02.509338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:02.518009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m16:59:02.649723 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m16:59:02.649723 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m16:59:02.649723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:04.002010 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.366 seconds
[0m16:59:04.017951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT, now create_DE_MINI_PROJECT_mart)
[0m16:59:04.017951 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT"
schema: "mart"
"
[0m16:59:04.017951 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_mart"
[0m16:59:04.017951 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_mart"} */
create schema if not exists DE_MINI_PROJECT.mart
[0m16:59:04.245668 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.221 seconds
[0m16:59:04.245668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m16:59:04.275664 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m16:59:04.275664 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m16:59:04.277413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:05.297116 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.022 seconds
[0m16:59:05.306731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m16:59:05.313195 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m16:59:05.313195 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m16:59:05.523506 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m16:59:05.523506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m16:59:05.523506 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m16:59:05.523506 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m16:59:05.727909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m16:59:05.748362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E48A27CE0>]}
[0m16:59:05.751739 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m16:59:05.760123 [info ] [Thread-1 (]: 1 of 8 START sql table model mart.intermediate_customers ....................... [RUN]
[0m16:59:05.760123 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.intermediate_customers'
[0m16:59:05.760123 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m16:59:05.783010 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m16:59:05.785570 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m16:59:05.824920 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m16:59:05.827921 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m16:59:05.827921 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.mart.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m16:59:05.828920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:07.231413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m16:59:07.247548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A45B680>]}
[0m16:59:07.247548 [info ] [Thread-1 (]: 1 of 8 OK created sql table model mart.intermediate_customers .................. [[32mSUCCESS 1[0m in 1.49s]
[0m16:59:07.247548 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m16:59:07.247548 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m16:59:07.263220 [info ] [Thread-1 (]: 2 of 8 START sql table model mart.kpi1 ......................................... [RUN]
[0m16:59:07.263220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.intermediate_customers, now model.DE_MINI_PROJECT.kpi1)
[0m16:59:07.263220 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m16:59:07.267863 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m16:59:07.269870 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m16:59:07.271878 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m16:59:07.273885 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m16:59:07.273885 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi1
         as
        (-- WITH customer_activity AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- new_customers AS (
--     SELECT 
--         transaction_month,
--         COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
--     FROM customer_activity ca
--     WHERE transaction_month = (
--         SELECT MIN(transaction_month)
--         FROM customer_activity ca2
--         WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
--     )
--     GROUP BY transaction_month
-- ),
-- churned_customers AS (
--     SELECT 
--         ca.transaction_month,
--         COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
--     FROM customer_activity ca
--     LEFT JOIN customer_activity next_month_activity
--         ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
--         AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
--     WHERE next_month_activity.CUSTOMER_ID IS NULL
--     GROUP BY ca.transaction_month
-- )
-- SELECT 
--     COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
--     COALESCE(nc.new_customers_count, 0) AS new_customers,
--     COALESCE(cc.churned_customers_count, 0) AS churned_customers
-- FROM new_customers nc
-- FULL OUTER JOIN churned_customers cc
--     ON nc.transaction_month = cc.transaction_month
-- ORDER BY transaction_month


WITH customers_data AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM new_and_churned_customers
        );
[0m16:59:07.543277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0051-3201-7e57-000c-3d5a0001ff8a
[0m16:59:07.552185 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m16:59:07.570590 [debug] [Thread-1 (]: Database Error in model kpi1 (models\mart\kpi1.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi1.sql
[0m16:59:07.570590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A4C84D0>]}
[0m16:59:07.572598 [error] [Thread-1 (]: 2 of 8 ERROR creating sql table model mart.kpi1 ................................ [[31mERROR[0m in 0.31s]
[0m16:59:07.572598 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m16:59:07.572598 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m16:59:07.572598 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi1' to be skipped because of status 'error'.  Reason: Database Error in model kpi1 (models\mart\kpi1.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi1.sql.
[0m16:59:07.572598 [info ] [Thread-1 (]: 3 of 8 START sql table model mart.kpi2 ......................................... [RUN]
[0m16:59:07.572598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi1, now model.DE_MINI_PROJECT.kpi2)
[0m16:59:07.572598 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m16:59:07.581256 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m16:59:07.583264 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m16:59:07.585271 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m16:59:07.590239 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m16:59:07.590239 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        p.PRODUCT_FAMILY,
        DATE_TRUNC('MONTH', t.payment_month) AS transaction_month,
        COUNT(DISTINCT t.product_id) AS products_purchased
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p
        ON t.product_id = p.product_id
    GROUP BY t.CUSTOMER_ID, p.PRODUCT_FAMILY, DATE_TRUNC('MONTH', t.payment_month)
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_FAMILY) AS product_families_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_FAMILY) > 1 -- Customers who purchased from multiple product families
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_FAMILY,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_FAMILY = next_month_activity.PRODUCT_FAMILY
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_FAMILY
)
SELECT 
    csc.CUSTOMER_ID,
    csc.product_families_purchased,
    pcc.PRODUCT_FAMILY AS churned_product_family,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
ORDER BY csc.product_families_purchased DESC, pcc.last_purchase_month DESC
        );
[0m16:59:07.800539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0051-3201-7db6-000c-3d5a00020cb2
[0m16:59:07.800539 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 28
invalid identifier 'T.PAYMENT_MONTH'
[0m16:59:07.800539 [debug] [Thread-1 (]: Database Error in model kpi2 (models\mart\kpi2.sql)
  000904 (42000): SQL compilation error: error line 7 at position 28
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi2.sql
[0m16:59:07.800539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A6E6D20>]}
[0m16:59:07.800539 [error] [Thread-1 (]: 3 of 8 ERROR creating sql table model mart.kpi2 ................................ [[31mERROR[0m in 0.23s]
[0m16:59:07.800539 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m16:59:07.800539 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m16:59:07.809451 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi2' to be skipped because of status 'error'.  Reason: Database Error in model kpi2 (models\mart\kpi2.sql)
  000904 (42000): SQL compilation error: error line 7 at position 28
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi2.sql.
[0m16:59:07.800539 [info ] [Thread-1 (]: 4 of 8 START sql table model mart.kpi3 ......................................... [RUN]
[0m16:59:07.809451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi2, now model.DE_MINI_PROJECT.kpi3)
[0m16:59:07.809451 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m16:59:07.811993 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m16:59:07.811993 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m16:59:07.811993 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m16:59:07.825164 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m16:59:07.826029 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_month) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue -- Revenue excluding upsells
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m16:59:08.042622 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0051-3201-7d7b-000c-3d5a00022b8a
[0m16:59:08.042622 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'PAYMENT_MONTH'
[0m16:59:08.042622 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m16:59:08.042622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A6F4740>]}
[0m16:59:08.042622 [error] [Thread-1 (]: 4 of 8 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 0.23s]
[0m16:59:08.042622 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m16:59:08.042622 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m16:59:08.042622 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m16:59:08.042622 [info ] [Thread-1 (]: 5 of 8 START sql table model mart.kpi4 ......................................... [RUN]
[0m16:59:08.042622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi3, now model.DE_MINI_PROJECT.kpi4)
[0m16:59:08.042622 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m16:59:08.060415 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m16:59:08.060415 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m16:59:08.064431 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m16:59:08.066439 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m16:59:08.066439 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (WITH monthly_revenue AS (
    SELECT
        DATE_TRUNC('MONTH', payment_date) AS month,
        SUM(revenue) AS total_revenue
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    WHERE
        REVENUE_TYPE = 1
    GROUP BY
        month
)
SELECT
    month,
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY month) AS previous,
    CASE 
        WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
            LAG(total_revenue) OVER (ORDER BY month) - total_revenue
        ELSE 
            0
    END AS revenue_lost
FROM
    monthly_revenue
-- WHERE
--     revenue_lost > 0
ORDER BY
    month
        );
[0m16:59:08.685596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m16:59:08.687600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A4C9100>]}
[0m16:59:08.689605 [info ] [Thread-1 (]: 5 of 8 OK created sql table model mart.kpi4 .................................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:59:08.689605 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m16:59:08.689605 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m16:59:08.691351 [info ] [Thread-1 (]: 6 of 8 START sql table model mart.kpi5 ......................................... [RUN]
[0m16:59:08.691351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi4, now model.DE_MINI_PROJECT.kpi5)
[0m16:59:08.691351 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m16:59:08.691351 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m16:59:08.691351 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m16:59:08.699090 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m16:59:08.699090 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m16:59:08.699090 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m16:59:09.254656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m16:59:09.270404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A717110>]}
[0m16:59:09.270404 [info ] [Thread-1 (]: 6 of 8 OK created sql table model mart.kpi5 .................................... [[32mSUCCESS 1[0m in 0.58s]
[0m16:59:09.270404 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m16:59:09.270404 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m16:59:09.274013 [info ] [Thread-1 (]: 7 of 8 START sql table model mart.kpi6 ......................................... [RUN]
[0m16:59:09.274013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi5, now model.DE_MINI_PROJECT.kpi6)
[0m16:59:09.274013 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m16:59:09.279746 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m16:59:09.281757 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m16:59:09.283766 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m16:59:09.286980 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m16:59:09.288454 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m16:59:10.763415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.480 seconds
[0m16:59:10.763415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A71B110>]}
[0m16:59:10.763415 [info ] [Thread-1 (]: 7 of 8 OK created sql table model mart.kpi6 .................................... [[32mSUCCESS 1[0m in 1.49s]
[0m16:59:10.763415 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m16:59:10.763415 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m16:59:10.763415 [info ] [Thread-1 (]: 8 of 8 START sql table model mart.kpi7 ......................................... [RUN]
[0m16:59:10.774067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi6, now model.DE_MINI_PROJECT.kpi7)
[0m16:59:10.774067 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m16:59:10.778343 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m16:59:10.779350 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m16:59:10.783248 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m16:59:10.786321 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m16:59:10.786643 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.CUSTOMER_ID,
    rc.total_revenue,
    rc.revenue_rank,
    cc.CUSTOMER_NAME
FROM ranked_customers rc
JOIN DE_MINI_PROJECT.staging.stg_customers cc
    ON rc.customer_id = cc.customer_id
ORDER BY revenue_rank
        );
[0m16:59:11.343926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m16:59:11.343926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9595489a-f2ab-43fc-8ff8-e8fe4b48849b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E4A6F87A0>]}
[0m16:59:11.343926 [info ] [Thread-1 (]: 8 of 8 OK created sql table model mart.kpi7 .................................... [[32mSUCCESS 1[0m in 0.57s]
[0m16:59:11.359796 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m16:59:11.359796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:11.359796 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_mart' was left open.
[0m16:59:11.359796 [debug] [MainThread]: On create_DE_MINI_PROJECT_mart: Close
[0m16:59:11.701082 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m16:59:11.701082 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m16:59:12.038434 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m16:59:12.038434 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m16:59:12.381266 [info ] [MainThread]: 
[0m16:59:12.381266 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 9.87 seconds (9.87s).
[0m16:59:12.381266 [debug] [MainThread]: Command end result
[0m16:59:12.421606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m16:59:12.421606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m16:59:12.443746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m16:59:12.444712 [info ] [MainThread]: 
[0m16:59:12.445710 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:59:12.446712 [info ] [MainThread]: 
[0m16:59:12.447310 [error] [MainThread]:   Database Error in model kpi1 (models\mart\kpi1.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi1.sql
[0m16:59:12.448320 [info ] [MainThread]: 
[0m16:59:12.449353 [error] [MainThread]:   Database Error in model kpi2 (models\mart\kpi2.sql)
  000904 (42000): SQL compilation error: error line 7 at position 28
  invalid identifier 'T.PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi2.sql
[0m16:59:12.449353 [info ] [MainThread]: 
[0m16:59:12.450352 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m16:59:12.451318 [info ] [MainThread]: 
[0m16:59:12.452618 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m16:59:12.453648 [debug] [MainThread]: Command `dbt run` failed at 16:59:12.453648 after 12.43 seconds
[0m16:59:12.455634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E3ADDCB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E39470680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E48D7D4C0>]}
[0m16:59:12.456729 [debug] [MainThread]: Flushing usage events
[0m16:59:13.663128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:12.808885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121BF75610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121BF77590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121BF77BF0>]}


============================== 17:00:12.824613 | 0b4c6bb7-a119-4d92-8d96-3fe2071b7eae ==============================
[0m17:00:12.824613 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:00:12.824613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:14.033059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122808AD80>]}
[0m17:00:14.112100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121B4DC080>]}
[0m17:00:14.113849 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m17:00:14.697298 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:00:14.911786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:14.911786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:14.974472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021228C62F90>]}
[0m17:00:15.068949 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:00:15.068949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:00:15.116497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021228C7E570>]}
[0m17:00:15.116497 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m17:00:15.116497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021227C88350>]}
[0m17:00:15.116497 [info ] [MainThread]: 
[0m17:00:15.116497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:15.116497 [info ] [MainThread]: 
[0m17:00:15.116497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:00:15.126699 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m17:00:15.253764 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m17:00:15.253764 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m17:00:15.253764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:16.644217 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.390 seconds
[0m17:00:16.660082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m17:00:16.675789 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m17:00:16.675789 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m17:00:16.675789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:17.657283 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.978 seconds
[0m17:00:17.660375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m17:00:17.662415 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m17:00:17.662415 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m17:00:17.889316 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.227 seconds
[0m17:00:17.889316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m17:00:17.889316 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m17:00:17.889316 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m17:00:18.099705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.207 seconds
[0m17:00:18.099705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021228B07B60>]}
[0m17:00:18.099705 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m17:00:18.099705 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi1 ......................................... [RUN]
[0m17:00:18.099705 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m17:00:18.099705 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m17:00:18.123531 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m17:00:18.125537 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m17:00:18.165308 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m17:00:18.168305 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m17:00:18.169273 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi1
         as
        (-- WITH customer_activity AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- new_customers AS (
--     SELECT 
--         transaction_month,
--         COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
--     FROM customer_activity ca
--     WHERE transaction_month = (
--         SELECT MIN(transaction_month)
--         FROM customer_activity ca2
--         WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
--     )
--     GROUP BY transaction_month
-- ),
-- churned_customers AS (
--     SELECT 
--         ca.transaction_month,
--         COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
--     FROM customer_activity ca
--     LEFT JOIN customer_activity next_month_activity
--         ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
--         AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
--     WHERE next_month_activity.CUSTOMER_ID IS NULL
--     GROUP BY ca.transaction_month
-- )
-- SELECT 
--     COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
--     COALESCE(nc.new_customers_count, 0) AS new_customers,
--     COALESCE(cc.churned_customers_count, 0) AS churned_customers
-- FROM new_customers nc
-- FULL OUTER JOIN churned_customers cc
--     ON nc.transaction_month = cc.transaction_month
-- ORDER BY transaction_month


WITH customers_data AS (
    SELECT
        payment_month,
        customer_id,
        MIN(payment_month) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_month) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_month THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_month AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_month
    ORDER BY payment_month
)
SELECT * FROM new_and_churned_customers
        );
[0m17:00:18.169597 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:19.099116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0052-3201-7d7b-000c-3d5a00022b9a
[0m17:00:19.100116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m17:00:19.103640 [debug] [Thread-1 (]: Database Error in model kpi1 (models\mart\kpi1.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi1.sql
[0m17:00:19.103640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4c6bb7-a119-4d92-8d96-3fe2071b7eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122901BEF0>]}
[0m17:00:19.103640 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi1 ................................ [[31mERROR[0m in 1.00s]
[0m17:00:19.103640 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m17:00:19.103640 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi1' to be skipped because of status 'error'.  Reason: Database Error in model kpi1 (models\mart\kpi1.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi1.sql.
[0m17:00:19.103640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:19.103640 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m17:00:19.103640 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m17:00:19.445902 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m17:00:19.445902 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m17:00:19.791241 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m17:00:19.793264 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m17:00:20.140608 [info ] [MainThread]: 
[0m17:00:20.141541 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m17:00:20.142268 [debug] [MainThread]: Command end result
[0m17:00:20.171329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:00:20.174627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:00:20.179771 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m17:00:20.179771 [info ] [MainThread]: 
[0m17:00:20.179771 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:00:20.179771 [info ] [MainThread]: 
[0m17:00:20.179771 [error] [MainThread]:   Database Error in model kpi1 (models\mart\kpi1.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi1.sql
[0m17:00:20.179771 [info ] [MainThread]: 
[0m17:00:20.179771 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:00:20.188986 [debug] [MainThread]: Command `dbt run` failed at 17:00:20.187970 after 7.59 seconds
[0m17:00:20.189981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021219B43020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121BD35A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121BD35490>]}
[0m17:00:20.189981 [debug] [MainThread]: Flushing usage events
[0m17:00:21.123099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:24.437458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B100C3D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B100C3C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B100C3D6D0>]}


============================== 17:01:24.443372 | a767c1aa-1b5d-40d7-b13a-79ed182b056c ==============================
[0m17:01:24.443372 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:01:24.444344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:25.699925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B100556180>]}
[0m17:01:25.776692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D7DE840>]}
[0m17:01:25.778700 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m17:01:26.354214 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:01:26.585782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:26.585782 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi1.sql
[0m17:01:26.920647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10DE85A00>]}
[0m17:01:27.023427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:01:27.025434 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:01:27.062989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10DE7E0C0>]}
[0m17:01:27.062989 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m17:01:27.062989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D9733B0>]}
[0m17:01:27.074216 [info ] [MainThread]: 
[0m17:01:27.078638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:01:27.079633 [info ] [MainThread]: 
[0m17:01:27.079633 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:01:27.079633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m17:01:27.205008 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m17:01:27.210937 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m17:01:27.210937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:28.802511 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.593 seconds
[0m17:01:28.802511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m17:01:28.818443 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m17:01:28.818443 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m17:01:28.818443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:29.806684 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.986 seconds
[0m17:01:29.806684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m17:01:29.806684 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m17:01:29.806684 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m17:01:30.065747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.259 seconds
[0m17:01:30.065747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m17:01:30.081600 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m17:01:30.081600 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m17:01:30.291527 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m17:01:30.291527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B17E091160>]}
[0m17:01:30.306850 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m17:01:30.306850 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi1 ......................................... [RUN]
[0m17:01:30.306850 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi1'
[0m17:01:30.306850 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m17:01:30.328979 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m17:01:30.330936 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m17:01:30.358880 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m17:01:30.373735 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m17:01:30.374545 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi1
         as
        (-- WITH customer_activity AS (
--     SELECT 
--         CUSTOMER_ID,
--         DATE_TRUNC('MONTH', payment_month) AS transaction_month
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY CUSTOMER_ID, DATE_TRUNC('MONTH', payment_month)
-- ),
-- new_customers AS (
--     SELECT 
--         transaction_month,
--         COUNT(DISTINCT CUSTOMER_ID) AS new_customers_count
--     FROM customer_activity ca
--     WHERE transaction_month = (
--         SELECT MIN(transaction_month)
--         FROM customer_activity ca2
--         WHERE ca.CUSTOMER_ID = ca2.CUSTOMER_ID
--     )
--     GROUP BY transaction_month
-- ),
-- churned_customers AS (
--     SELECT 
--         ca.transaction_month,
--         COUNT(DISTINCT ca.CUSTOMER_ID) AS churned_customers_count
--     FROM customer_activity ca
--     LEFT JOIN customer_activity next_month_activity
--         ON ca.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
--         AND DATEADD(MONTH, 3, ca.transaction_month) = next_month_activity.transaction_month
--     WHERE next_month_activity.CUSTOMER_ID IS NULL
--     GROUP BY ca.transaction_month
-- )
-- SELECT 
--     COALESCE(nc.transaction_month, cc.transaction_month) AS transaction_month,
--     COALESCE(nc.new_customers_count, 0) AS new_customers,
--     COALESCE(cc.churned_customers_count, 0) AS churned_customers
-- FROM new_customers nc
-- FULL OUTER JOIN churned_customers cc
--     ON nc.transaction_month = cc.transaction_month
-- ORDER BY transaction_month


WITH customers_data AS (
    SELECT
        payment_date,
        customer_id,
        MIN(payment_date) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_date) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_date,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_date THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_date AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_date
    ORDER BY payment_date
)
SELECT * FROM new_and_churned_customers
        );
[0m17:01:30.374545 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:31.855090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.481 seconds
[0m17:01:31.876112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a767c1aa-1b5d-40d7-b13a-79ed182b056c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B17DFEB4A0>]}
[0m17:01:31.876112 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi1 .................................... [[32mSUCCESS 1[0m in 1.57s]
[0m17:01:31.876112 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m17:01:31.876112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:31.876112 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m17:01:31.876112 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m17:01:32.216022 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m17:01:32.216022 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m17:01:32.539846 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi1' was left open.
[0m17:01:32.539846 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi1: Close
[0m17:01:32.879456 [info ] [MainThread]: 
[0m17:01:32.879456 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m17:01:32.879456 [debug] [MainThread]: Command end result
[0m17:01:32.917609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:01:32.917609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:01:32.935155 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m17:01:32.935155 [info ] [MainThread]: 
[0m17:01:32.935155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:32.935155 [info ] [MainThread]: 
[0m17:01:32.935155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:01:32.935155 [debug] [MainThread]: Command `dbt run` succeeded at 17:01:32.935155 after 8.72 seconds
[0m17:01:32.935155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B17EA08140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10DC53CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1006F02F0>]}
[0m17:01:32.935155 [debug] [MainThread]: Flushing usage events
[0m17:01:33.922629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:04.151323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027418A23380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741AD3F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027418960C80>]}


============================== 17:04:04.164673 | 07528483-0718-4ee1-8aff-289f95839cfe ==============================
[0m17:04:04.164673 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:04:04.164673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi2', 'send_anonymous_usage_stats': 'True'}
[0m17:04:05.360898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274276E6DB0>]}
[0m17:04:05.440327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027425F036B0>]}
[0m17:04:05.440327 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m17:04:06.045385 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:04:06.267015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:06.267015 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi2.sql
[0m17:04:06.610921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274289D5EB0>]}
[0m17:04:06.707308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:04:06.707308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:04:06.754773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742899A870>]}
[0m17:04:06.754773 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m17:04:06.754773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274284CF3B0>]}
[0m17:04:06.754773 [info ] [MainThread]: 
[0m17:04:06.754773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:06.754773 [info ] [MainThread]: 
[0m17:04:06.754773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:04:06.769599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m17:04:06.895019 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m17:04:06.895019 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m17:04:06.899065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:08.245370 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.354 seconds
[0m17:04:08.261389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m17:04:08.277160 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m17:04:08.277160 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m17:04:08.277160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:09.311949 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.029 seconds
[0m17:04:09.311949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m17:04:09.311949 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m17:04:09.311949 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m17:04:09.520025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m17:04:09.520025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m17:04:09.520025 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m17:04:09.520025 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m17:04:09.730579 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.201 seconds
[0m17:04:09.733196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027429E67770>]}
[0m17:04:09.733196 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m17:04:09.733196 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m17:04:09.733196 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m17:04:09.733196 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m17:04:09.748663 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m17:04:09.748663 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m17:04:09.783912 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m17:04:09.783912 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m17:04:09.783912 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        p.PRODUCT_FAMILY,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month,
        COUNT(DISTINCT t.product_id) AS products_purchased
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p
        ON t.product_id = p.product_id
    GROUP BY t.CUSTOMER_ID, p.PRODUCT_FAMILY, DATE_TRUNC('MONTH', t.payment_date)
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_FAMILY) AS product_families_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_FAMILY) > 1 -- Customers who purchased from multiple product families
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_FAMILY,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_FAMILY = next_month_activity.PRODUCT_FAMILY
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_FAMILY
)
SELECT 
    csc.CUSTOMER_ID,
    csc.product_families_purchased,
    pcc.PRODUCT_FAMILY AS churned_product_family,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
ORDER BY csc.product_families_purchased DESC, pcc.last_purchase_month DESC
        );
[0m17:04:09.783912 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:04:11.318005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.529 seconds
[0m17:04:11.349468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07528483-0718-4ee1-8aff-289f95839cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027418B473B0>]}
[0m17:04:11.349468 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.60s]
[0m17:04:11.349468 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m17:04:11.349468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:11.349468 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m17:04:11.349468 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m17:04:11.691453 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_mart' was left open.
[0m17:04:11.691453 [debug] [MainThread]: On list_DE_MINI_PROJECT_mart: Close
[0m17:04:12.017798 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m17:04:12.017798 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m17:04:12.346830 [info ] [MainThread]: 
[0m17:04:12.346830 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m17:04:12.346830 [debug] [MainThread]: Command end result
[0m17:04:12.389760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:04:12.392762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:04:12.393760 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m17:04:12.393760 [info ] [MainThread]: 
[0m17:04:12.393760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:12.402493 [info ] [MainThread]: 
[0m17:04:12.403511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:04:12.405353 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:12.405353 after 8.56 seconds
[0m17:04:12.405353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741B77E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741B172660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274283679B0>]}
[0m17:04:12.405353 [debug] [MainThread]: Flushing usage events
[0m17:04:13.308159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:40.032411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DC0F5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DC0F5EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DC0F7830>]}


============================== 17:23:40.048498 | cf86414c-1be7-4e6c-8bbd-f34f1a00697d ==============================
[0m17:23:40.048498 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:23:40.048498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi3', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:23:44.534382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E831AD80>]}
[0m17:23:44.613640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E84234A0>]}
[0m17:23:44.613640 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m17:23:45.372562 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:23:47.110808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:47.110808 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m17:23:47.440281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E9355850>]}
[0m17:23:47.550058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:23:47.567609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:23:47.633441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E931A750>]}
[0m17:23:47.633441 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m17:23:47.633441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E90D19D0>]}
[0m17:23:47.633441 [info ] [MainThread]: 
[0m17:23:47.633441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:47.633441 [info ] [MainThread]: 
[0m17:23:47.633441 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:23:47.633441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m17:23:50.891590 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m17:23:50.891590 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m17:23:50.891590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:52.581099 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.681 seconds
[0m17:23:52.583106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m17:23:52.589478 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m17:23:52.589478 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m17:23:52.589478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:53.560132 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.961 seconds
[0m17:23:53.560132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m17:23:53.560132 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m17:23:53.560132 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m17:23:53.786533 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.220 seconds
[0m17:23:53.791095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m17:23:53.795111 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m17:23:53.795111 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m17:23:53.993912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m17:23:54.009643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E9219580>]}
[0m17:23:54.030249 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m17:23:54.032248 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m17:23:54.035238 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m17:23:54.037254 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m17:23:54.050193 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m17:23:54.050193 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m17:23:54.093834 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m17:23:54.098929 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m17:23:54.099934 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue -- Revenue excluding upsells
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m17:23:54.099934 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:23:56.445915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.346 seconds
[0m17:23:56.469587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf86414c-1be7-4e6c-8bbd-f34f1a00697d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227D94971A0>]}
[0m17:23:56.469587 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi3 .................................... [[32mSUCCESS 1[0m in 2.44s]
[0m17:23:56.469587 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m17:23:56.469587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:56.469587 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m17:23:56.469587 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m17:23:56.810937 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m17:23:56.810937 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m17:23:57.162747 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m17:23:57.162747 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m17:23:57.503033 [info ] [MainThread]: 
[0m17:23:57.503033 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.87 seconds (9.87s).
[0m17:23:57.503033 [debug] [MainThread]: Command end result
[0m17:23:57.535050 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:23:57.538087 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:23:57.540085 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m17:23:57.540085 [info ] [MainThread]: 
[0m17:23:57.540085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:57.540085 [info ] [MainThread]: 
[0m17:23:57.548913 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:23:57.550921 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:57.550921 after 17.81 seconds
[0m17:23:57.551774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DBAA2DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E8C8CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB561220>]}
[0m17:23:57.551774 [debug] [MainThread]: Flushing usage events
[0m17:23:58.779007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:15.048744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEAFC85970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEAFA45490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEAFC874A0>]}


============================== 17:39:15.065296 | 55edb130-7f06-498c-89bf-2afc7cf7d321 ==============================
[0m17:39:15.065296 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:39:15.066297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:39:19.628212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBA477770>]}
[0m17:39:19.711379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBC4E66F0>]}
[0m17:39:19.713387 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m17:39:20.418440 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:39:22.114253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:39:22.114253 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi6.sql
[0m17:39:22.114253 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi1.sql
[0m17:39:22.116260 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi4.sql
[0m17:39:22.460182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBCDEF4D0>]}
[0m17:39:22.549516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:39:22.563510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:39:22.637035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBCE90E60>]}
[0m17:39:22.637035 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m17:39:22.637035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBC90E570>]}
[0m17:39:22.637035 [info ] [MainThread]: 
[0m17:39:22.642418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:22.642418 [info ] [MainThread]: 
[0m17:39:22.642418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:39:22.642418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m17:39:26.429067 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m17:39:26.429067 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m17:39:26.429067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:28.598241 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.169 seconds
[0m17:39:28.598241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m17:39:28.613988 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m17:39:28.613988 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m17:39:28.613988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:29.750751 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.127 seconds
[0m17:39:29.759483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m17:39:29.770226 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m17:39:29.770226 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m17:39:29.987649 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m17:39:29.994462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m17:39:30.002983 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m17:39:30.003986 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m17:39:30.212789 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m17:39:30.216252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEBE2E2420>]}
[0m17:39:30.221560 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m17:39:30.221560 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi6 ......................................... [RUN]
[0m17:39:30.223707 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m17:39:30.223707 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m17:39:30.235043 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m17:39:30.236150 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m17:39:30.274871 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m17:39:30.277836 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m17:39:30.277836 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        t.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m17:39:30.278836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:31.495267 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0079-3201-7e57-000c-3d5a0002516a
[0m17:39:31.497273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 5 at position 8
'T.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
[0m17:39:31.524435 [debug] [Thread-1 (]: Database Error in model kpi6 (models\mart\kpi6.sql)
  001104 (42601): SQL compilation error: error line 5 at position 8
  'T.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi6.sql
[0m17:39:31.524435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55edb130-7f06-498c-89bf-2afc7cf7d321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEAF12D850>]}
[0m17:39:31.524435 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi6 ................................ [[31mERROR[0m in 1.30s]
[0m17:39:31.524435 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m17:39:31.524435 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi6' to be skipped because of status 'error'.  Reason: Database Error in model kpi6 (models\mart\kpi6.sql)
  001104 (42601): SQL compilation error: error line 5 at position 8
  'T.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi6.sql.
[0m17:39:31.524435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:31.524435 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m17:39:31.524435 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m17:39:31.869207 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m17:39:31.871225 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m17:39:32.215600 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m17:39:32.219734 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m17:39:32.555842 [info ] [MainThread]: 
[0m17:39:32.557918 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.91 seconds (9.91s).
[0m17:39:32.558943 [debug] [MainThread]: Command end result
[0m17:39:32.595764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:39:32.599552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:39:32.609649 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m17:39:32.610689 [info ] [MainThread]: 
[0m17:39:32.610689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:39:32.611712 [info ] [MainThread]: 
[0m17:39:32.613133 [error] [MainThread]:   Database Error in model kpi6 (models\mart\kpi6.sql)
  001104 (42601): SQL compilation error: error line 5 at position 8
  'T.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi6.sql
[0m17:39:32.615007 [info ] [MainThread]: 
[0m17:39:32.616583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:39:32.618724 [debug] [MainThread]: Command `dbt run` failed at 17:39:32.618181 after 17.92 seconds
[0m17:39:32.618724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEADA0FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEADA0FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEADA0E150>]}
[0m17:39:32.619769 [debug] [MainThread]: Flushing usage events
[0m17:39:33.986455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:03.432074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299BBA440E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299BBA467B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299BBA472F0>]}


============================== 17:40:03.442313 | deca2276-118c-4625-b2e4-430336dcfee5 ==============================
[0m17:40:03.442313 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:40:03.442313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi6', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:40:04.635343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299BBA8C1A0>]}
[0m17:40:04.710248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C7E3FE00>]}
[0m17:40:04.710248 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m17:40:05.274700 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:40:05.495867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:05.495867 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi6.sql
[0m17:40:05.825536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C8CE5C40>]}
[0m17:40:05.919949 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:40:05.935511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:40:05.966857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C8CAA6F0>]}
[0m17:40:05.966857 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m17:40:05.966857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C8CDF830>]}
[0m17:40:05.966857 [info ] [MainThread]: 
[0m17:40:05.966857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:05.966857 [info ] [MainThread]: 
[0m17:40:05.966857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:40:05.966857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m17:40:06.096099 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m17:40:06.096099 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m17:40:06.096099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:07.521843 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.422 seconds
[0m17:40:07.546103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m17:40:07.564985 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m17:40:07.564985 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m17:40:07.566993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:08.493839 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.927 seconds
[0m17:40:08.493839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m17:40:08.493839 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m17:40:08.493839 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m17:40:08.704794 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m17:40:08.720805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m17:40:08.720805 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m17:40:08.736768 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m17:40:08.941925 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m17:40:08.948300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299C8677D70>]}
[0m17:40:08.948300 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m17:40:08.948300 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi6 ......................................... [RUN]
[0m17:40:08.948300 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi6'
[0m17:40:08.948300 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m17:40:08.966103 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m17:40:08.967659 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m17:40:09.008411 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m17:40:09.010413 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m17:40:09.010413 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m17:40:09.011411 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:11.619166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.619 seconds
[0m17:40:11.650947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deca2276-118c-4625-b2e4-430336dcfee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B8DE72F0>]}
[0m17:40:11.650947 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi6 .................................... [[32mSUCCESS 1[0m in 2.70s]
[0m17:40:11.650947 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m17:40:11.650947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:11.650947 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m17:40:11.650947 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m17:40:11.993810 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m17:40:11.993810 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m17:40:12.328371 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m17:40:12.328371 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m17:40:12.668644 [info ] [MainThread]: 
[0m17:40:12.668644 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m17:40:12.684546 [debug] [MainThread]: Command end result
[0m17:40:12.721303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m17:40:12.721303 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m17:40:12.737665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m17:40:12.737665 [info ] [MainThread]: 
[0m17:40:12.737665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:12.737665 [info ] [MainThread]: 
[0m17:40:12.737665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:40:12.737665 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:12.737665 after 9.51 seconds
[0m17:40:12.737665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B90CEDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B97CFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B97CEE10>]}
[0m17:40:12.737665 [debug] [MainThread]: Flushing usage events
[0m17:40:13.654529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:27.012171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D5683EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D5682B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D5681F10>]}


============================== 18:04:27.018598 | 406ec99d-066f-4ec1-97d6-0f6d8214579b ==============================
[0m18:04:27.018598 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:04:27.018598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi3', 'send_anonymous_usage_stats': 'True'}
[0m18:04:31.441460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D56A7B30>]}
[0m18:04:31.505268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E20183B0>]}
[0m18:04:31.521094 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:04:32.267126 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:04:32.405649 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:04:32.405649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E26C3590>]}
[0m18:04:35.616240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E29A2750>]}
[0m18:04:35.713196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:04:35.727211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:04:35.806581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E27F4440>]}
[0m18:04:35.806581 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:04:35.806581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E29A2510>]}
[0m18:04:35.806581 [info ] [MainThread]: 
[0m18:04:35.806581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:35.806581 [info ] [MainThread]: 
[0m18:04:35.806581 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:35.813863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:04:39.563962 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:04:39.563962 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:04:39.563962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:41.280448 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.709 seconds
[0m18:04:41.282493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m18:04:41.296374 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:04:41.296374 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:04:41.296374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:42.284148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.992 seconds
[0m18:04:42.284148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m18:04:42.299956 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:04:42.299956 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:04:42.503251 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.213 seconds
[0m18:04:42.519455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m18:04:42.519455 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:04:42.519455 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:04:42.751181 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.222 seconds
[0m18:04:42.755681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m18:04:42.757689 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:04:42.757689 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:04:42.951994 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.197 seconds
[0m18:04:42.951994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E26B4980>]}
[0m18:04:42.951994 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m18:04:42.951994 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m18:04:42.966706 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m18:04:42.967306 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m18:04:42.967306 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m18:04:42.967306 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m18:04:43.019164 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m18:04:43.019164 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m18:04:43.019164 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, -1, cr.transaction_month) -- Corrected logic
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period;
[0m18:04:43.019164 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:44.169752 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0092-3201-7e57-000c-3d5a0002529e
[0m18:04:44.169752 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 80 at position 28 unexpected ';'.
[0m18:04:44.201888 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 28 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m18:04:44.201888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '406ec99d-066f-4ec1-97d6-0f6d8214579b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E29A2540>]}
[0m18:04:44.201888 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 1.24s]
[0m18:04:44.201888 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m18:04:44.201888 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 28 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m18:04:44.201888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:44.201888 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:04:44.201888 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:04:44.561344 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m18:04:44.561344 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m18:04:44.900196 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m18:04:44.901206 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m18:04:45.215048 [info ] [MainThread]: 
[0m18:04:45.230792 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m18:04:45.230792 [debug] [MainThread]: Command end result
[0m18:04:45.259997 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:04:45.259997 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:04:45.270974 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:04:45.272011 [info ] [MainThread]: 
[0m18:04:45.272388 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:04:45.272388 [info ] [MainThread]: 
[0m18:04:45.272388 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 80 at position 28 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m18:04:45.272388 [info ] [MainThread]: 
[0m18:04:45.272388 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:04:45.272388 [debug] [MainThread]: Command `dbt run` failed at 18:04:45.272388 after 18.52 seconds
[0m18:04:45.272388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D4BCBF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D5680470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4D5683A10>]}
[0m18:04:45.279190 [debug] [MainThread]: Flushing usage events
[0m18:04:46.579620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:52.058895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51BACFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51B831370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51BACF680>]}


============================== 18:04:52.065086 | caf9a60b-7534-477e-8e56-7005c6787f47 ==============================
[0m18:04:52.065086 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:04:52.066089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi3', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:53.360423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51BAED730>]}
[0m18:04:53.449365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51B348E60>]}
[0m18:04:53.451332 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:04:54.040055 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:04:54.261649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:54.261649 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m18:04:54.619291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F528D19B50>]}
[0m18:04:54.711757 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:04:54.711757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:04:54.762978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F528CDA6C0>]}
[0m18:04:54.763978 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:04:54.764977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52880F290>]}
[0m18:04:54.767013 [info ] [MainThread]: 
[0m18:04:54.767824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:54.768833 [info ] [MainThread]: 
[0m18:04:54.769866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:54.770909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:04:54.897299 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:04:54.897299 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:04:54.898299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.316356 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.418 seconds
[0m18:04:56.323175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m18:04:56.330526 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:04:56.330526 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:04:56.330526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:57.264485 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.934 seconds
[0m18:04:57.273964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m18:04:57.273964 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:04:57.273964 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:04:57.470385 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m18:04:57.478987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m18:04:57.483004 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:04:57.483004 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:04:57.683557 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.199 seconds
[0m18:04:57.685558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m18:04:57.688447 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:04:57.688447 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:04:57.886235 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.198 seconds
[0m18:04:57.890272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F518F213D0>]}
[0m18:04:57.894103 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m18:04:57.894103 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m18:04:57.896563 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m18:04:57.896945 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m18:04:57.907073 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m18:04:57.908074 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m18:04:57.934333 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m18:04:57.951377 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m18:04:57.952347 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, -1, cr.transaction_month) -- Corrected logic
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m18:04:57.952347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:59.584773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.632 seconds
[0m18:04:59.618614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caf9a60b-7534-477e-8e56-7005c6787f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51AF89850>]}
[0m18:04:59.619616 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi3 .................................... [[32mSUCCESS 1[0m in 1.71s]
[0m18:04:59.621582 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m18:04:59.622585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:59.622585 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:04:59.622585 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:04:59.940097 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m18:04:59.940097 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m18:05:00.256795 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m18:05:00.256795 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m18:05:00.594290 [info ] [MainThread]: 
[0m18:05:00.595289 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m18:05:00.596293 [debug] [MainThread]: Command end result
[0m18:05:00.619374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:05:00.626019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:05:00.635340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:05:00.635943 [info ] [MainThread]: 
[0m18:05:00.638026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:00.639022 [info ] [MainThread]: 
[0m18:05:00.640021 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:00.641471 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:00.641471 after 8.80 seconds
[0m18:05:00.641471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52A096D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F529D27140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F51989C200>]}
[0m18:05:00.642471 [debug] [MainThread]: Flushing usage events
[0m18:05:01.536131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:53.632506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128040A300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FE17DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FE0A1100>]}


============================== 18:06:53.640912 | 33e32466-2109-4a91-96d7-7eb416750bf6 ==============================
[0m18:06:53.640912 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:06:53.640912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi3', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:54.874287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128CDE1430>]}
[0m18:06:54.952202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128CE39400>]}
[0m18:06:54.954210 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:06:55.544112 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:06:55.786582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:55.786582 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m18:06:56.124561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D66AB40>]}
[0m18:06:56.226481 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:06:56.230241 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:06:56.270695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D746540>]}
[0m18:06:56.272965 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:06:56.272965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D4FA840>]}
[0m18:06:56.272965 [info ] [MainThread]: 
[0m18:06:56.272965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:56.272965 [info ] [MainThread]: 
[0m18:06:56.277572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:56.277572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:06:56.400188 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:06:56.400188 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:06:56.400188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:57.880008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.479 seconds
[0m18:06:57.895861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m18:06:57.895861 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:06:57.895861 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:06:57.911530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:58.885812 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.986 seconds
[0m18:06:58.904722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m18:06:58.906728 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:06:58.908732 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:06:59.155394 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.247 seconds
[0m18:06:59.155394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m18:06:59.155394 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:06:59.155394 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:06:59.348747 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m18:06:59.365579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m18:06:59.371435 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:06:59.372433 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:06:59.562209 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.189 seconds
[0m18:06:59.566228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D697170>]}
[0m18:06:59.568234 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m18:06:59.568234 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m18:06:59.568234 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m18:06:59.568234 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m18:06:59.580601 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m18:06:59.582664 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m18:06:59.622720 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m18:06:59.626752 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m18:06:59.627749 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, -1, cr.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        'Last 12 Months' AS fiscal_year, -- Use a fixed label for the period
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Aggregate over the last 12 months
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period;
[0m18:06:59.627749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:00.596908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0094-3201-7e57-000c-3d5a000252b6
[0m18:07:00.596908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 79 at position 28 unexpected ';'.
[0m18:07:00.600806 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 79 at position 28 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m18:07:00.600806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e32466-2109-4a91-96d7-7eb416750bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128EDBB7D0>]}
[0m18:07:00.600806 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 1.03s]
[0m18:07:00.600806 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m18:07:00.600806 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 79 at position 28 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m18:07:00.600806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:00.600806 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:07:00.600806 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:07:00.931089 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m18:07:00.931089 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m18:07:01.274305 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m18:07:01.274305 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m18:07:01.601488 [info ] [MainThread]: 
[0m18:07:01.601488 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m18:07:01.601488 [debug] [MainThread]: Command end result
[0m18:07:01.654777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:07:01.655613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:07:01.655613 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:07:01.655613 [info ] [MainThread]: 
[0m18:07:01.655613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:07:01.655613 [info ] [MainThread]: 
[0m18:07:01.655613 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 79 at position 28 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m18:07:01.655613 [info ] [MainThread]: 
[0m18:07:01.671435 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:07:01.671977 [debug] [MainThread]: Command `dbt run` failed at 18:07:01.671977 after 8.24 seconds
[0m18:07:01.671977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D631CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D263B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002128D204DA0>]}
[0m18:07:01.671977 [debug] [MainThread]: Flushing usage events
[0m18:07:02.553718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:21.245546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD643F4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD643F7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD643F5A90>]}


============================== 18:07:21.245546 | 644adc91-4214-4537-97b0-6f4a3db910f7 ==============================
[0m18:07:21.245546 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:07:21.245546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi3', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:07:22.610821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD70F0CDD0>]}
[0m18:07:22.688970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD70D65100>]}
[0m18:07:22.690948 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:07:23.306301 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:07:23.559878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:23.559878 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m18:07:23.915563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD71639AC0>]}
[0m18:07:24.015339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:07:24.021386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:07:24.061286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD715FA420>]}
[0m18:07:24.061286 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:07:24.061286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD713DA870>]}
[0m18:07:24.061286 [info ] [MainThread]: 
[0m18:07:24.061286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:24.061286 [info ] [MainThread]: 
[0m18:07:24.061286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:07:24.061286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:07:24.194094 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:07:24.194094 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:07:24.194094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:25.536444 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.341 seconds
[0m18:07:25.554613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m18:07:25.570668 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:07:25.570668 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:07:25.571668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:26.489343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.922 seconds
[0m18:07:26.496156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m18:07:26.500198 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:07:26.500198 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:07:26.688359 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.188 seconds
[0m18:07:26.691460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m18:07:26.693494 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:07:26.694492 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:07:26.893458 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m18:07:26.895944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m18:07:26.899627 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:07:26.899627 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:07:27.110383 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.213 seconds
[0m18:07:27.114467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD72A7E6C0>]}
[0m18:07:27.114467 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m18:07:27.114467 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m18:07:27.114467 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m18:07:27.114467 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m18:07:27.130621 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m18:07:27.132087 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m18:07:27.171532 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m18:07:27.176530 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m18:07:27.176530 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, -1, cr.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        'Last 12 Months' AS fiscal_year, -- Use a fixed label for the period
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Aggregate over the last 12 months
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m18:07:27.177533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:28.427208 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0095-3201-7d7b-000c-3d5a00022ece
[0m18:07:28.427208 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100040 (22007): Date 'Last 12 Months' is not recognized
[0m18:07:28.427208 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  100040 (22007): Date 'Last 12 Months' is not recognized
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m18:07:28.427208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644adc91-4214-4537-97b0-6f4a3db910f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD72AAE750>]}
[0m18:07:28.427208 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 1.31s]
[0m18:07:28.427208 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m18:07:28.427208 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  100040 (22007): Date 'Last 12 Months' is not recognized
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m18:07:28.427208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:28.427208 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:07:28.427208 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:07:28.755562 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m18:07:28.755562 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m18:07:29.097255 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m18:07:29.097255 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m18:07:29.413507 [info ] [MainThread]: 
[0m18:07:29.413507 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m18:07:29.413507 [debug] [MainThread]: Command end result
[0m18:07:29.453843 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:07:29.453843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:07:29.453843 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:07:29.453843 [info ] [MainThread]: 
[0m18:07:29.465059 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:07:29.465770 [info ] [MainThread]: 
[0m18:07:29.466369 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  100040 (22007): Date 'Last 12 Months' is not recognized
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m18:07:29.466369 [info ] [MainThread]: 
[0m18:07:29.466369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:07:29.466369 [debug] [MainThread]: Command `dbt run` failed at 18:07:29.466369 after 8.43 seconds
[0m18:07:29.466369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD63C8DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD621B82C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD621B8350>]}
[0m18:07:29.466369 [debug] [MainThread]: Flushing usage events
[0m18:07:30.638132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:41.477766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB01EC1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB01BDCC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB02415250>]}


============================== 18:08:41.477766 | 8e2e9db7-0fe3-45f4-8e1a-61cae9c6583a ==============================
[0m18:08:41.477766 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:08:41.477766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi3', 'send_anonymous_usage_stats': 'True'}
[0m18:08:45.306631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e2e9db7-0fe3-45f4-8e1a-61cae9c6583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB02431370>]}
[0m18:08:45.386338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e2e9db7-0fe3-45f4-8e1a-61cae9c6583a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB0EFBF590>]}
[0m18:08:45.386338 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:08:45.665503 [error] [MainThread]: Encountered an error:

[0m18:08:45.771684 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\parser\manifest.py", line 2066, in parse_manifest
    register_adapter(runtime_config, get_mp_context())
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 203, in register_adapter
    FACTORY.register_adapter(config, mp_context, adapter_registered_log_level)
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 118, in register_adapter
    adapter: Adapter = adapter_type(config, mp_context)  # type: ignore
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\impl.py", line 297, in __init__
    self.behavior = DEFAULT_BASE_BEHAVIOR_FLAGS  # type: ignore
    ^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\base\impl.py", line 331, in behavior
    self._behavior = Behavior(flags, user_overrides)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\behavior_flags.py", line 136, in __init__
    self._flags = [BehaviorFlagRendered(flag, user_overrides) for flag in flags]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\behavior_flags.py", line 63, in __init__
    flag_source=flag.get("source", self._default_source()),
                                   ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\behavior_flags.py", line 96, in _default_source
    for frame in inspect.stack():
                 ^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\inspect.py", line 1781, in stack
    return getouterframes(sys._getframe(1), context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\inspect.py", line 1756, in getouterframes
    traceback_info = getframeinfo(frame, context)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\inspect.py", line 1718, in getframeinfo
    lines, lnum = findsource(frame)
                  ^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\inspect.py", line 1090, in findsource
    module = getmodule(object, file)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BurelaSuryaPrathap\AppData\Local\Programs\Python\Python312\Lib\inspect.py", line 1016, in getmodule
    os.path.realpath(f)] = module.__name__
    ^^^^^^^^^^^^^^^^^^^
  File "<frozen ntpath>", line 727, in realpath
KeyboardInterrupt

[0m18:08:45.774540 [debug] [MainThread]: Command `dbt run` failed at 18:08:45.774540 after 4.53 seconds
[0m18:08:45.774540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB01EC1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB0245C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DB0E61A7B0>]}
[0m18:08:45.774540 [debug] [MainThread]: Flushing usage events
[0m18:08:47.148303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:55.641371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D94165820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D94166900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D941673B0>]}


============================== 18:08:55.657254 | 11d19d7e-479e-4101-b47d-1b9f3f54c5ae ==============================
[0m18:08:55.657254 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:08:55.657254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi3', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:56.892014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9EAA6270>]}
[0m18:08:56.982768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA032FF80>]}
[0m18:08:56.984859 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:08:57.633523 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:08:59.266903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:59.266903 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m18:08:59.600632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA10D0440>]}
[0m18:08:59.704142 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:08:59.720113 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:08:59.767714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA140A870>]}
[0m18:08:59.767714 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:08:59.767714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA1442030>]}
[0m18:08:59.770883 [info ] [MainThread]: 
[0m18:08:59.770883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:59.770883 [info ] [MainThread]: 
[0m18:08:59.770883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:08:59.774563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:09:02.977776 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:09:02.977776 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:09:02.977776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:04.651051 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.672 seconds
[0m18:09:04.669309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m18:09:04.677322 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:09:04.677322 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:09:04.677322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:05.602595 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.916 seconds
[0m18:09:05.606626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m18:09:05.608633 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:09:05.610641 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:09:05.810753 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m18:09:05.816820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m18:09:05.828303 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:09:05.830322 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:09:06.047976 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.217 seconds
[0m18:09:06.052028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m18:09:06.055028 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:09:06.055028 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:09:06.265301 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.209 seconds
[0m18:09:06.273397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D915B11F0>]}
[0m18:09:06.273397 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m18:09:06.273397 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m18:09:06.287228 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m18:09:06.287228 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m18:09:06.287228 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m18:09:06.287228 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m18:09:06.338918 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m18:09:06.342923 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m18:09:06.343919 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, -1, cr.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', CURRENT_DATE) AS fiscal_year, -- Use the first day of the current year as a placeholder
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Aggregate over the last 12 months
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period, -- Use a valid date for the period
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m18:09:06.343919 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:07.824409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.484 seconds
[0m18:09:07.855934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d19d7e-479e-4101-b47d-1b9f3f54c5ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D93619070>]}
[0m18:09:07.855934 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi3 .................................... [[32mSUCCESS 1[0m in 1.57s]
[0m18:09:07.855934 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m18:09:07.855934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:07.855934 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:09:07.855934 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:09:08.182062 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m18:09:08.182062 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m18:09:08.515504 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m18:09:08.515504 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m18:09:08.845604 [info ] [MainThread]: 
[0m18:09:08.845604 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m18:09:08.845604 [debug] [MainThread]: Command end result
[0m18:09:08.872727 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:09:08.872727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:09:08.886429 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:09:08.886429 [info ] [MainThread]: 
[0m18:09:08.886429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:08.886429 [info ] [MainThread]: 
[0m18:09:08.886429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:09:08.886429 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:08.886429 after 13.44 seconds
[0m18:09:08.886429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D93899DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D938BF9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D91EEEE10>]}
[0m18:09:08.892830 [debug] [MainThread]: Flushing usage events
[0m18:09:09.832234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:00.425820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850B374EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850B135490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850B377800>]}


============================== 18:11:00.425820 | 774d1e37-a086-4d7e-b2b0-0763e51d7f50 ==============================
[0m18:11:00.425820 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:11:00.441401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi3', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:01.639434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285172F6270>]}
[0m18:11:01.716714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850A8D8290>]}
[0m18:11:01.716714 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:11:02.311731 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:11:02.546555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:11:02.547560 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m18:11:02.876726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285185E5BB0>]}
[0m18:11:02.981378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:11:02.987137 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:11:03.018650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285185A6630>]}
[0m18:11:03.018650 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:11:03.018650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028518313F80>]}
[0m18:11:03.028857 [info ] [MainThread]: 
[0m18:11:03.028857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:03.028857 [info ] [MainThread]: 
[0m18:11:03.028857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:11:03.032501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:11:03.160305 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:11:03.160305 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:11:03.160305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:04.712240 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.550 seconds
[0m18:11:04.714250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m18:11:04.727934 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:11:04.727934 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:11:04.727934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:05.643331 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.923 seconds
[0m18:11:05.643331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m18:11:05.660920 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:11:05.660920 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:11:05.861115 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.198 seconds
[0m18:11:05.861115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m18:11:05.861115 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:11:05.861115 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:11:06.049092 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.187 seconds
[0m18:11:06.061551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_mart)
[0m18:11:06.065160 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:11:06.065160 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:11:06.263791 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.201 seconds
[0m18:11:06.263791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285185E5FA0>]}
[0m18:11:06.279455 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m18:11:06.279455 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m18:11:06.279455 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m18:11:06.279455 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m18:11:06.279455 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m18:11:06.279455 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m18:11:06.333648 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m18:11:06.337648 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m18:11:06.338646 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m18:11:06.339648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:11:08.007481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.672 seconds
[0m18:11:08.039264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774d1e37-a086-4d7e-b2b0-0763e51d7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850A8219D0>]}
[0m18:11:08.039264 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi3 .................................... [[32mSUCCESS 1[0m in 1.76s]
[0m18:11:08.039264 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m18:11:08.039264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:08.039264 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:11:08.039264 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:11:08.382439 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_mart' was left open.
[0m18:11:08.382439 [debug] [MainThread]: On list_DE_MINI_PROJECT_mart: Close
[0m18:11:08.703629 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m18:11:08.703629 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m18:11:09.028018 [info ] [MainThread]: 
[0m18:11:09.043740 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m18:11:09.043740 [debug] [MainThread]: Command end result
[0m18:11:09.085424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:11:09.086284 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:11:09.086284 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:11:09.086284 [info ] [MainThread]: 
[0m18:11:09.086284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:09.086284 [info ] [MainThread]: 
[0m18:11:09.086284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:11:09.101102 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:09.101102 after 8.88 seconds
[0m18:11:09.102145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028508F1C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850A7EFAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850A88D760>]}
[0m18:11:09.102145 [debug] [MainThread]: Flushing usage events
[0m18:11:10.416731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:36.893675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8CF251C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8CF27EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8CF258E0>]}


============================== 18:29:36.913340 | 78b2edc7-3fb0-4606-b647-6bdd2e06423c ==============================
[0m18:29:36.913340 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:29:36.913340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi4', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:40.789894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8CF6C6B0>]}
[0m18:29:40.876994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C97707C20>]}
[0m18:29:40.876994 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:29:41.578849 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:29:43.235742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:43.235742 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi4.sql
[0m18:29:43.570303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9A155AC0>]}
[0m18:29:43.656119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:29:43.687979 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:29:43.722970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C9A11A660>]}
[0m18:29:43.730534 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:29:43.730534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C988131A0>]}
[0m18:29:43.730534 [info ] [MainThread]: 
[0m18:29:43.730534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:43.730534 [info ] [MainThread]: 
[0m18:29:43.735902 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:29:43.736870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:29:47.001894 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:29:47.001894 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:29:47.001894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:48.618553 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.607 seconds
[0m18:29:48.633231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m18:29:48.646871 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:29:48.648888 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:29:48.648888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:49.615438 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.966 seconds
[0m18:29:49.618808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m18:29:49.622435 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:29:49.622435 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:29:49.802716 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.181 seconds
[0m18:29:49.802716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m18:29:49.802716 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:29:49.802716 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:29:50.001737 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.200 seconds
[0m18:29:50.001737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m18:29:50.001737 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:29:50.018504 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:29:50.251016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.235 seconds
[0m18:29:50.251016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C99AD7980>]}
[0m18:29:50.251016 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m18:29:50.251016 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi4 ......................................... [RUN]
[0m18:29:50.251016 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m18:29:50.251016 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m18:29:50.267699 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m18:29:50.267699 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m18:29:50.302642 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m18:29:50.317761 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m18:29:50.317761 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (-- WITH monthly_revenue AS (
--     SELECT
--         DATE_TRUNC('MONTH', payment_date) AS month,
--         SUM(revenue) AS total_revenue
--     FROM
--         DE_MINI_PROJECT.staging.stg_transactions
--     WHERE
--         REVENUE_TYPE = 1
--     GROUP BY
--         month
-- )
-- SELECT
--     month,
--     total_revenue,
--     LAG(total_revenue) OVER (ORDER BY month) AS previous,
--     CASE 
--         WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
--             LAG(total_revenue) OVER (ORDER BY month) - total_revenue
--         ELSE 
--             0
--     END AS revenue_lost
-- FROM
--     monthly_revenue
-- ORDER BY
--     month
 

 WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM stg_transaction
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH  
ORDER BY Revenue_Loss DESC
        );
[0m18:29:50.317761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:51.420243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ab-3201-7d7b-000c-3d5a0002704a
[0m18:29:51.420243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_TRANSACTION' does not exist or not authorized.
[0m18:29:51.435432 [debug] [Thread-1 (]: Database Error in model kpi4 (models\mart\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTION' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi4.sql
[0m18:29:51.435432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78b2edc7-3fb0-4606-b647-6bdd2e06423c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8C3D19A0>]}
[0m18:29:51.435432 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi4 ................................ [[31mERROR[0m in 1.18s]
[0m18:29:51.435432 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m18:29:51.435432 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi4' to be skipped because of status 'error'.  Reason: Database Error in model kpi4 (models\mart\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTION' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi4.sql.
[0m18:29:51.451147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:51.451147 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:29:51.451147 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:29:51.775581 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m18:29:51.775581 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m18:29:52.100790 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m18:29:52.100790 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m18:29:52.420182 [info ] [MainThread]: 
[0m18:29:52.420182 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.68 seconds (8.68s).
[0m18:29:52.439847 [debug] [MainThread]: Command end result
[0m18:29:52.472794 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:29:52.472794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:29:52.488469 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:29:52.488469 [info ] [MainThread]: 
[0m18:29:52.488469 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:29:52.488469 [info ] [MainThread]: 
[0m18:29:52.488469 [error] [MainThread]:   Database Error in model kpi4 (models\mart\kpi4.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTION' does not exist or not authorized.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi4.sql
[0m18:29:52.488469 [info ] [MainThread]: 
[0m18:29:52.488469 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:29:52.499670 [debug] [MainThread]: Command `dbt run` failed at 18:29:52.488469 after 15.87 seconds
[0m18:29:52.499670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8AC4E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C99E9C9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8C408AD0>]}
[0m18:29:52.500709 [debug] [MainThread]: Flushing usage events
[0m18:29:53.739584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:12.017210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293D4351C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293AFA3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293D435CD0>]}


============================== 18:31:12.025026 | 5e310606-a1c1-47ad-a8f9-226811201af2 ==============================
[0m18:31:12.025026 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:31:12.025026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi4', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:31:13.236478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293D47C4D0>]}
[0m18:31:13.335399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293CACFA40>]}
[0m18:31:13.351217 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:31:13.927647 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:31:14.181166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:14.181166 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi4.sql
[0m18:31:14.522816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002294A669D00>]}
[0m18:31:14.615032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:31:14.615032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:31:14.662573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002294A62A720>]}
[0m18:31:14.662573 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:31:14.662573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293D456600>]}
[0m18:31:14.673395 [info ] [MainThread]: 
[0m18:31:14.673395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:14.673395 [info ] [MainThread]: 
[0m18:31:14.673395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:14.673395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:31:14.800478 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:31:14.800478 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:31:14.800478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:16.209347 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.409 seconds
[0m18:31:16.217738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m18:31:16.249925 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:31:16.249925 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:31:16.249925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:17.204834 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.955 seconds
[0m18:31:17.212455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_mart)
[0m18:31:17.212455 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:31:17.212455 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:31:17.413269 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.197 seconds
[0m18:31:17.415059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m18:31:17.415059 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:31:17.415059 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:31:17.622161 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.216 seconds
[0m18:31:17.638220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m18:31:17.654251 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:31:17.654251 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:31:17.866949 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.219 seconds
[0m18:31:17.884874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002294A511CD0>]}
[0m18:31:17.884874 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m18:31:17.884874 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi4 ......................................... [RUN]
[0m18:31:17.884874 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m18:31:17.898872 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m18:31:17.898872 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m18:31:17.898872 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m18:31:17.938634 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m18:31:17.938634 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m18:31:17.938634 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (-- WITH monthly_revenue AS (
--     SELECT
--         DATE_TRUNC('MONTH', payment_date) AS month,
--         SUM(revenue) AS total_revenue
--     FROM
--         DE_MINI_PROJECT.staging.stg_transactions
--     WHERE
--         REVENUE_TYPE = 1
--     GROUP BY
--         month
-- )
-- SELECT
--     month,
--     total_revenue,
--     LAG(total_revenue) OVER (ORDER BY month) AS previous,
--     CASE 
--         WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
--             LAG(total_revenue) OVER (ORDER BY month) - total_revenue
--         ELSE 
--             0
--     END AS revenue_lost
-- FROM
--     monthly_revenue
-- ORDER BY
--     month
 

 WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_DATE) AS PREV_REVENUE
FROM DE_MINI_PROJECT.staging.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_DATE,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_DATE 
ORDER BY Revenue_Loss DESC
        );
[0m18:31:17.938634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:19.335854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.383 seconds
[0m18:31:19.366965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e310606-a1c1-47ad-a8f9-226811201af2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A7D7230>]}
[0m18:31:19.368969 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi4 .................................... [[32mSUCCESS 1[0m in 1.48s]
[0m18:31:19.368969 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m18:31:19.370719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:19.370719 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:31:19.370719 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:31:19.698053 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m18:31:19.698053 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m18:31:20.020940 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m18:31:20.020940 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m18:31:20.341223 [info ] [MainThread]: 
[0m18:31:20.341223 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m18:31:20.357422 [debug] [MainThread]: Command end result
[0m18:31:20.397216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:31:20.397216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:31:20.409302 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:31:20.409302 [info ] [MainThread]: 
[0m18:31:20.409302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:20.409302 [info ] [MainThread]: 
[0m18:31:20.409302 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:31:20.409302 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:20.409302 after 8.62 seconds
[0m18:31:20.409302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293D2CFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022949E766C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293CB2EE10>]}
[0m18:31:20.420859 [debug] [MainThread]: Flushing usage events
[0m18:31:21.324820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:10.345107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A903CF6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A903CF6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A903CF6660>]}


============================== 18:33:10.361227 | 7783b1ce-42ec-4c35-a770-513470e3b492 ==============================
[0m18:33:10.361227 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:33:10.361227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi4', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:11.554298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A90FF5AD80>]}
[0m18:33:11.633738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9036C35C0>]}
[0m18:33:11.633738 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:33:12.233266 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:33:12.478151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:12.479898 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi4.sql
[0m18:33:12.816331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A910F99A30>]}
[0m18:33:12.915796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:33:12.918829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:33:12.959145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A910F5A630>]}
[0m18:33:12.962408 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:33:12.962408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A910F9A870>]}
[0m18:33:12.962408 [info ] [MainThread]: 
[0m18:33:12.962408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:12.966578 [info ] [MainThread]: 
[0m18:33:12.966578 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:33:12.968671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:33:13.091532 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:33:13.091532 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:33:13.091532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:14.535653 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.451 seconds
[0m18:33:14.551560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m18:33:14.564284 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:33:14.566292 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:33:14.566292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:15.551706 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.985 seconds
[0m18:33:15.554673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m18:33:15.557353 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:33:15.559359 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:33:15.747581 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.193 seconds
[0m18:33:15.747581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m18:33:15.747581 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:33:15.747581 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:33:15.957733 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m18:33:15.957733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m18:33:15.973829 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:33:15.973829 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:33:16.168003 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.189 seconds
[0m18:33:16.170011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A910927C20>]}
[0m18:33:16.170011 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m18:33:16.170011 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi4 ......................................... [RUN]
[0m18:33:16.170011 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi4'
[0m18:33:16.170011 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m18:33:16.186200 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m18:33:16.187209 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m18:33:16.226627 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m18:33:16.228637 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m18:33:16.229628 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (-- WITH monthly_revenue AS (
--     SELECT
--         DATE_TRUNC('MONTH', payment_date) AS month,
--         SUM(revenue) AS total_revenue
--     FROM
--         DE_MINI_PROJECT.staging.stg_transactions
--     WHERE
--         REVENUE_TYPE = 1
--     GROUP BY
--         month
-- )
-- SELECT
--     month,
--     total_revenue,
--     LAG(total_revenue) OVER (ORDER BY month) AS previous,
--     CASE 
--         WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
--             LAG(total_revenue) OVER (ORDER BY month) - total_revenue
--         ELSE 
--             0
--     END AS revenue_lost
-- FROM
--     monthly_revenue
-- ORDER BY
--     month
 

 WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    REVENUE,
    LAG(REVENUE) OVER (ORDER BY PAYMENT_DATE) AS PREV_REVENUE
FROM DE_MINI_PROJECT.staging.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_DATE,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_DATE 
ORDER BY Revenue_Loss DESC
        );
[0m18:33:16.230628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:17.674096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.455 seconds
[0m18:33:17.721637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7783b1ce-42ec-4c35-a770-513470e3b492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A91252FE30>]}
[0m18:33:17.721637 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi4 .................................... [[32mSUCCESS 1[0m in 1.55s]
[0m18:33:17.721637 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m18:33:17.721637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:17.721637 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:33:17.721637 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:33:18.050311 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m18:33:18.050311 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m18:33:18.383657 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi4' was left open.
[0m18:33:18.383657 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi4: Close
[0m18:33:18.734427 [info ] [MainThread]: 
[0m18:33:18.735427 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m18:33:18.737835 [debug] [MainThread]: Command end result
[0m18:33:18.760352 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:33:18.760352 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:33:18.782362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:33:18.782362 [info ] [MainThread]: 
[0m18:33:18.782362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:18.782362 [info ] [MainThread]: 
[0m18:33:18.782362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:33:18.782362 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:18.782362 after 8.72 seconds
[0m18:33:18.782362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A910ECEBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A901ABC0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A901ABE3C0>]}
[0m18:33:18.782362 [debug] [MainThread]: Flushing usage events
[0m18:33:19.689883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:21.881721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EC0C7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EC0C7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EC0C6CF0>]}


============================== 18:55:21.881721 | 8f84c5ef-4737-462d-9f8a-7c3a178491b2 ==============================
[0m18:55:21.881721 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:55:21.881721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi2', 'send_anonymous_usage_stats': 'True'}
[0m18:55:25.740125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F8D29040>]}
[0m18:55:25.819353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F8B83EF0>]}
[0m18:55:25.819353 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:55:26.571059 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:55:28.241780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:55:28.241780 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\source.yml
[0m18:55:28.258022 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi4.sql
[0m18:55:28.679757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F93352E0>]}
[0m18:55:28.788648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:55:28.798947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:55:28.846493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F9405CD0>]}
[0m18:55:28.846493 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:55:28.846493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F944F9E0>]}
[0m18:55:28.850537 [info ] [MainThread]: 
[0m18:55:28.850537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:28.850537 [info ] [MainThread]: 
[0m18:55:28.850537 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:55:28.850537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:55:32.159609 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:55:32.159609 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:55:32.159609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:33.601921 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.449 seconds
[0m18:55:33.633478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m18:55:33.649442 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:55:33.649442 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:55:33.649442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:34.641960 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.979 seconds
[0m18:55:34.644929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m18:55:34.649931 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:55:34.649931 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:55:34.849350 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m18:55:34.849350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m18:55:34.865077 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:55:34.865077 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:55:35.075087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.208 seconds
[0m18:55:35.075087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_mart)
[0m18:55:35.084919 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:55:35.084919 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:55:35.285563 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.212 seconds
[0m18:55:35.312144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FA783140>]}
[0m18:55:35.312144 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m18:55:35.312144 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m18:55:35.317623 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m18:55:35.317623 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m18:55:35.327862 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m18:55:35.329868 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m18:55:35.368358 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m18:55:35.372335 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m18:55:35.372335 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        p.PRODUCT_FAMILY,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month,
        COUNT(DISTINCT t.product_id) AS products_purchased
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p
        ON t.product_id = p.product_id
    GROUP BY t.CUSTOMER_ID, p.PRODUCT_FAMILY, DATE_TRUNC('MONTH', t.payment_date)
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_FAMILY) AS product_families_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_FAMILY) > 1 -- Customers who purchased from multiple product families
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_FAMILY,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_FAMILY = next_month_activity.PRODUCT_FAMILY
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_FAMILY
)
SELECT 
    csc.CUSTOMER_ID,
    csc.product_families_purchased,
    pcc.PRODUCT_FAMILY AS churned_product_family,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
ORDER BY csc.product_families_purchased DESC, pcc.last_purchase_month DESC
        );
[0m18:55:35.373435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:55:37.093286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.720 seconds
[0m18:55:37.123845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f84c5ef-4737-462d-9f8a-7c3a178491b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241E94670E0>]}
[0m18:55:37.123845 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.80s]
[0m18:55:37.127270 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m18:55:37.127270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:37.127270 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:55:37.127270 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:55:37.460886 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_mart' was left open.
[0m18:55:37.460886 [debug] [MainThread]: On list_DE_MINI_PROJECT_mart: Close
[0m18:55:37.785380 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m18:55:37.787407 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m18:55:38.125050 [info ] [MainThread]: 
[0m18:55:38.126650 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m18:55:38.127135 [debug] [MainThread]: Command end result
[0m18:55:38.153020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:55:38.161150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:55:38.167425 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:55:38.167425 [info ] [MainThread]: 
[0m18:55:38.167425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:38.167425 [info ] [MainThread]: 
[0m18:55:38.167425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:55:38.167425 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:38.167425 after 16.55 seconds
[0m18:55:38.167425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241E9E25400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EBAD04A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241EBFB0D40>]}
[0m18:55:38.175015 [debug] [MainThread]: Flushing usage events
[0m18:55:39.136309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:37.997108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCD98EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCD98F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCD98CF80>]}


============================== 18:58:38.008808 | 2174e019-e540-4256-b9f1-f334a9042036 ==============================
[0m18:58:38.008808 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:58:38.008808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi2', 'send_anonymous_usage_stats': 'True'}
[0m18:58:39.219907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCDE6C230>]}
[0m18:58:39.299378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CCDE417C0>]}
[0m18:58:39.299378 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:58:39.897206 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:58:40.142050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:58:40.142050 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\source.yml
[0m18:58:40.144620 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi2.sql
[0m18:58:40.486717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDC098500>]}
[0m18:58:40.582170 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:58:40.582170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:58:40.633906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDC038E60>]}
[0m18:58:40.633906 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:58:40.633906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDAEDAF00>]}
[0m18:58:40.640015 [info ] [MainThread]: 
[0m18:58:40.640015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:40.640015 [info ] [MainThread]: 
[0m18:58:40.642766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:40.643668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:58:40.772147 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:58:40.772147 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:58:40.774158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:42.153091 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.381 seconds
[0m18:58:42.153091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m18:58:42.169199 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:58:42.169199 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:58:42.169199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:43.159503 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.990 seconds
[0m18:58:43.159503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m18:58:43.159503 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:58:43.159503 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:58:43.359817 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.190 seconds
[0m18:58:43.366019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_mart)
[0m18:58:43.366019 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:58:43.381820 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:58:43.584816 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.202 seconds
[0m18:58:43.586826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m18:58:43.588834 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:58:43.592415 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:58:43.803003 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m18:58:43.810622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDAA70A10>]}
[0m18:58:43.814633 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m18:58:43.814633 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m18:58:43.816638 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m18:58:43.816638 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m18:58:43.820648 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m18:58:43.820648 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m18:58:43.867310 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m18:58:43.871310 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m18:58:43.872307 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC;
[0m18:58:43.872307 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:44.968516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c8-3201-7db6-000c-3d5a00026172
[0m18:58:44.968516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 50 at position 66 unexpected ';'.
[0m18:58:44.978488 [debug] [Thread-1 (]: Database Error in model kpi2 (models\mart\kpi2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 66 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi2.sql
[0m18:58:44.978488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2174e019-e540-4256-b9f1-f334a9042036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDC05FF20>]}
[0m18:58:44.994399 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi2 ................................ [[31mERROR[0m in 1.16s]
[0m18:58:44.994399 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m18:58:44.994399 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi2' to be skipped because of status 'error'.  Reason: Database Error in model kpi2 (models\mart\kpi2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 66 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi2.sql.
[0m18:58:44.994399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:44.994399 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:58:44.994399 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:58:45.324000 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m18:58:45.324000 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m18:58:45.647912 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m18:58:45.647912 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m18:58:45.984894 [info ] [MainThread]: 
[0m18:58:45.986913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m18:58:45.991495 [debug] [MainThread]: Command end result
[0m18:58:46.029359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:58:46.029359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:58:46.029359 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:58:46.029359 [info ] [MainThread]: 
[0m18:58:46.029359 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:58:46.044560 [info ] [MainThread]: 
[0m18:58:46.045745 [error] [MainThread]:   Database Error in model kpi2 (models\mart\kpi2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 66 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi2.sql
[0m18:58:46.045745 [info ] [MainThread]: 
[0m18:58:46.045745 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:58:46.050009 [debug] [MainThread]: Command `dbt run` failed at 18:58:46.050009 after 8.34 seconds
[0m18:58:46.051052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDAD3E960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDAB33A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDAAD0650>]}
[0m18:58:46.051052 [debug] [MainThread]: Flushing usage events
[0m18:58:46.959216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:55.776378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BC82F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BA5E3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BA5E3020>]}


============================== 18:58:55.776378 | 9f68c2aa-fef5-48a7-96e4-9d1919cd41cb ==============================
[0m18:58:55.776378 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:58:55.788092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi2', 'send_anonymous_usage_stats': 'True'}
[0m18:58:56.981464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C9530110>]}
[0m18:58:57.057287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C8B78C20>]}
[0m18:58:57.059290 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:58:57.638481 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:58:57.873810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:57.873810 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi2.sql
[0m18:58:58.211472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C96D58E0>]}
[0m18:58:58.300777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:58:58.314526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:58:58.352424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C9BC6E40>]}
[0m18:58:58.355655 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m18:58:58.355655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6C9AB8EC0>]}
[0m18:58:58.355655 [info ] [MainThread]: 
[0m18:58:58.355655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:58.355655 [info ] [MainThread]: 
[0m18:58:58.355655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:58.361704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m18:58:58.474140 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m18:58:58.474140 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m18:58:58.474140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:59.816015 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.327 seconds
[0m18:58:59.823113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m18:58:59.823113 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m18:58:59.823113 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m18:58:59.823113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:00.761433 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.938 seconds
[0m18:59:00.779216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m18:59:00.784125 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m18:59:00.784125 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m18:59:00.985276 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.212 seconds
[0m18:59:00.985276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m18:59:01.001235 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m18:59:01.004743 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m18:59:01.211317 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.215 seconds
[0m18:59:01.211317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m18:59:01.211317 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m18:59:01.211317 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m18:59:01.409351 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.184 seconds
[0m18:59:01.409351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6CB1A3320>]}
[0m18:59:01.409351 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m18:59:01.409351 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m18:59:01.409351 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m18:59:01.409351 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m18:59:01.423185 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m18:59:01.423185 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m18:59:01.468560 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m18:59:01.471563 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m18:59:01.472565 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m18:59:01.473560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:59:03.057618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.596 seconds
[0m18:59:03.089663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f68c2aa-fef5-48a7-96e4-9d1919cd41cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BBE48EC0>]}
[0m18:59:03.089663 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.68s]
[0m18:59:03.089663 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m18:59:03.089663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:03.089663 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m18:59:03.089663 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m18:59:03.429851 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m18:59:03.429851 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m18:59:03.752543 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m18:59:03.752543 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m18:59:04.093461 [info ] [MainThread]: 
[0m18:59:04.093461 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m18:59:04.093461 [debug] [MainThread]: Command end result
[0m18:59:04.132059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m18:59:04.133115 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m18:59:04.133115 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m18:59:04.133115 [info ] [MainThread]: 
[0m18:59:04.133115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:04.133115 [info ] [MainThread]: 
[0m18:59:04.133115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:59:04.147626 [debug] [MainThread]: Command `dbt run` succeeded at 18:59:04.133115 after 8.57 seconds
[0m18:59:04.147626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BA147DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BA6C6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6BC534C50>]}
[0m18:59:04.147626 [debug] [MainThread]: Flushing usage events
[0m18:59:05.062242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:22.490778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC08215B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC08215DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC08217560>]}


============================== 19:00:22.498805 | 1b13e7d2-3b41-4412-8107-3ffbe81b945c ==============================
[0m19:00:22.498805 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:00:22.498805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi2', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:00:23.709131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC14D9E360>]}
[0m19:00:23.787037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC13F48440>]}
[0m19:00:23.788786 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:00:24.373683 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:00:24.615926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:24.615926 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi2.sql
[0m19:00:24.945244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC154464B0>]}
[0m19:00:25.055069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:00:25.055069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:00:25.086970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC15412F60>]}
[0m19:00:25.086970 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:00:25.102948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC154466F0>]}
[0m19:00:25.105110 [info ] [MainThread]: 
[0m19:00:25.105110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:25.105110 [info ] [MainThread]: 
[0m19:00:25.105110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:25.108666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:00:25.226895 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:00:25.226895 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:00:25.226895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:26.729111 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.491 seconds
[0m19:00:26.748825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m19:00:26.762785 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:00:26.764051 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:00:26.764051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:27.762774 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.000 seconds
[0m19:00:27.762774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m19:00:27.762774 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:00:27.762774 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:00:27.952332 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.190 seconds
[0m19:00:27.963568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m19:00:27.963568 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:00:27.963568 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:00:28.169014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.201 seconds
[0m19:00:28.171151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m19:00:28.173968 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:00:28.173968 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:00:28.364600 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m19:00:28.376636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC14DC7E00>]}
[0m19:00:28.376636 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:00:28.376636 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m19:00:28.376636 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m19:00:28.376636 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:00:28.394846 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:00:28.396353 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:00:28.435871 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:00:28.438869 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:00:28.439870 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:00:28.439870 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:30.212793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.772 seconds
[0m19:00:30.259993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b13e7d2-3b41-4412-8107-3ffbe81b945c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC16A6FC20>]}
[0m19:00:30.260883 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.88s]
[0m19:00:30.262008 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:00:30.264009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:30.264009 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:00:30.265009 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:00:30.576045 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m19:00:30.576045 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m19:00:30.895016 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m19:00:30.895016 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m19:00:31.231953 [info ] [MainThread]: 
[0m19:00:31.231953 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.13 seconds (6.13s).
[0m19:00:31.231953 [debug] [MainThread]: Command end result
[0m19:00:31.274248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:00:31.274248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:00:31.286258 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:00:31.286258 [info ] [MainThread]: 
[0m19:00:31.286258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:31.286258 [info ] [MainThread]: 
[0m19:00:31.286258 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:31.286258 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:31.286258 after 9.00 seconds
[0m19:00:31.286258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC081EF980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC14EA3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC14F20A10>]}
[0m19:00:31.286258 [debug] [MainThread]: Flushing usage events
[0m19:00:32.193210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:41.742443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241F3D6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241EA59370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241F3D56D0>]}


============================== 19:02:41.742443 | 784f7f19-ad81-434b-b0a6-6ca325e21550 ==============================
[0m19:02:41.742443 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:02:41.742443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi2', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:02:42.937431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242BEFAFC0>]}
[0m19:02:43.030494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241E91BC80>]}
[0m19:02:43.032240 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:02:43.611588 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:02:43.845793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:43.845793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:43.893247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242C0D29C0>]}
[0m19:02:44.003586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:02:44.003586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:02:44.034999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242C491CD0>]}
[0m19:02:44.034999 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:02:44.034999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022429B58BC0>]}
[0m19:02:44.050880 [info ] [MainThread]: 
[0m19:02:44.052896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:02:44.052896 [info ] [MainThread]: 
[0m19:02:44.052896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:02:44.056129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:02:44.186295 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:02:44.188303 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:02:44.188303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:45.659889 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.472 seconds
[0m19:02:45.667909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m19:02:45.680874 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:02:45.680874 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:02:45.680874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:46.659624 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.977 seconds
[0m19:02:46.659624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m19:02:46.659624 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:02:46.659624 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:02:46.870565 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.213 seconds
[0m19:02:46.883964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m19:02:46.883964 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:02:46.883964 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:02:47.097183 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m19:02:47.097183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m19:02:47.097183 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:02:47.097183 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:02:47.291534 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.198 seconds
[0m19:02:47.307518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242C49F230>]}
[0m19:02:47.307518 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:02:47.307518 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m19:02:47.323664 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m19:02:47.323664 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:02:47.326369 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:02:47.326369 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:02:47.377325 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:02:47.381328 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:02:47.381328 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:02:47.382360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:48.877753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.504 seconds
[0m19:02:48.906466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '784f7f19-ad81-434b-b0a6-6ca325e21550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241C7D7170>]}
[0m19:02:48.906466 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.60s]
[0m19:02:48.906466 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:02:48.906466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:48.906466 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:02:48.922229 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:02:49.244039 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:02:49.244039 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:02:49.569175 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m19:02:49.570173 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m19:02:49.888449 [info ] [MainThread]: 
[0m19:02:49.888449 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m19:02:49.888449 [debug] [MainThread]: Command end result
[0m19:02:49.928318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:02:49.929316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:02:49.938671 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:02:49.940173 [info ] [MainThread]: 
[0m19:02:49.941768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:49.942135 [info ] [MainThread]: 
[0m19:02:49.942135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:02:49.942135 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:49.942135 after 8.50 seconds
[0m19:02:49.942135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241F3D70B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241F3D6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002241F3D73B0>]}
[0m19:02:49.942135 [debug] [MainThread]: Flushing usage events
[0m19:02:51.225900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:54.536819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E270572C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E24D7FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E25E619A0>]}


============================== 19:04:54.543028 | c8d12671-01e5-4650-8f64-fb73f76669e2 ==============================
[0m19:04:54.543028 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:04:54.543620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi2', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:04:55.754240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E33D02FF0>]}
[0m19:04:55.830693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E33C73EF0>]}
[0m19:04:55.830693 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:04:56.413844 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:04:56.643346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:56.645352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:56.688733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E33FC7E60>]}
[0m19:04:56.798776 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:04:56.798776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:04:56.846181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E34121C70>]}
[0m19:04:56.848680 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:04:56.848680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E313D0BC0>]}
[0m19:04:56.848680 [info ] [MainThread]: 
[0m19:04:56.848680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:56.848680 [info ] [MainThread]: 
[0m19:04:56.848680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:56.848680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:04:56.985936 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:04:56.985936 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:04:56.985936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:58.389324 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.407 seconds
[0m19:04:58.404514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m19:04:58.419337 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:04:58.419337 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:04:58.420345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:59.377474 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.960 seconds
[0m19:04:59.382744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m19:04:59.387858 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:04:59.387858 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:04:59.585716 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.197 seconds
[0m19:04:59.591782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m19:04:59.601207 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:04:59.601207 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:04:59.798622 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m19:04:59.798622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m19:04:59.798622 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:04:59.798622 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:05:00.019426 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.208 seconds
[0m19:05:00.023181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E244A10D0>]}
[0m19:05:00.023181 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:05:00.023181 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m19:05:00.023181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m19:05:00.023181 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:05:00.041958 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:05:00.043353 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:05:00.082543 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:05:00.089174 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:05:00.090177 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:05:00.090177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:01.494522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.405 seconds
[0m19:05:01.527944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d12671-01e5-4650-8f64-fb73f76669e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E265093D0>]}
[0m19:05:01.527944 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.50s]
[0m19:05:01.527944 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:05:01.527944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:01.527944 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:05:01.527944 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:05:01.868533 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m19:05:01.868533 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m19:05:02.207907 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m19:05:02.209918 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m19:05:02.518465 [info ] [MainThread]: 
[0m19:05:02.534156 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m19:05:02.534156 [debug] [MainThread]: Command end result
[0m19:05:02.554662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:05:02.554662 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:05:02.575421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:05:02.576382 [info ] [MainThread]: 
[0m19:05:02.576382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:02.576382 [info ] [MainThread]: 
[0m19:05:02.576382 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:05:02.576382 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:02.576382 after 8.33 seconds
[0m19:05:02.576382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E26F1B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E265BC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E265BC1A0>]}
[0m19:05:02.581718 [debug] [MainThread]: Flushing usage events
[0m19:05:03.776970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:17.983344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357FD833B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235047256A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023504725190>]}


============================== 19:10:17.986908 | 62f6c225-366f-47a1-b430-60ece94a8164 ==============================
[0m19:10:17.986908 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:10:17.986908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m19:10:21.861636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023510208FB0>]}
[0m19:10:21.933097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023503703950>]}
[0m19:10:21.933097 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:10:22.657877 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:10:24.308140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:10:24.310147 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_products.sql
[0m19:10:24.649224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235119665A0>]}
[0m19:10:24.744234 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:10:24.762473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:10:24.807455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023511957020>]}
[0m19:10:24.807455 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:10:24.807455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235117E4BC0>]}
[0m19:10:24.807455 [info ] [MainThread]: 
[0m19:10:24.807455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:24.807455 [info ] [MainThread]: 
[0m19:10:24.807455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:10:24.807455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:10:28.024808 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:10:28.024808 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:10:28.024808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:29.486770 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.463 seconds
[0m19:10:29.486770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_intermediate'
[0m19:10:29.502903 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:10:29.502903 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:10:29.502903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:30.474304 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.963 seconds
[0m19:10:30.474304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m19:10:30.474304 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:10:30.474304 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:10:30.672266 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m19:10:30.672266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m19:10:30.682956 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:10:30.682956 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:10:30.873314 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.191 seconds
[0m19:10:30.879693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m19:10:30.879693 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:10:30.879693 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:10:31.100761 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.222 seconds
[0m19:10:31.100761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023511852CF0>]}
[0m19:10:31.116723 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m19:10:31.118731 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_products .............................. [RUN]
[0m19:10:31.118731 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_products'
[0m19:10:31.118731 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m19:10:31.118731 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m19:10:31.118731 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m19:10:31.169859 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m19:10:31.172538 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m19:10:31.173534 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT 
        LOWER(REPLACE(product_id, ' ', '')) AS product_id, 
        LOWER(REPLACE(PRODUCT_Family, ' ', '')) AS product_family, 
        LOWER(REPLACE(product_sub_family, ' ', '')) AS product_sub_family -
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m19:10:31.174041 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:10:32.297226 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d4-3201-7e56-000c-3d5a00023ea2
[0m19:10:32.297226 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 74 unexpected '-'.
syntax error line 13 at position 0 unexpected 'SELECT'.
[0m19:10:32.315252 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 74 unexpected '-'.
  syntax error line 13 at position 0 unexpected 'SELECT'.
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_products.sql
[0m19:10:32.315252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62f6c225-366f-47a1-b430-60ece94a8164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023503BD9670>]}
[0m19:10:32.315252 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_products ..................... [[31mERROR[0m in 1.20s]
[0m19:10:32.315252 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m19:10:32.315252 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 74 unexpected '-'.
  syntax error line 13 at position 0 unexpected 'SELECT'.
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_products.sql.
[0m19:10:32.315252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:32.315252 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:10:32.315252 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:10:32.641903 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_mart' was left open.
[0m19:10:32.641903 [debug] [MainThread]: On list_DE_MINI_PROJECT_mart: Close
[0m19:10:32.967060 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_products' was left open.
[0m19:10:32.967060 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_products: Close
[0m19:10:33.289978 [info ] [MainThread]: 
[0m19:10:33.306055 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m19:10:33.306055 [debug] [MainThread]: Command end result
[0m19:10:33.337414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:10:33.339416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:10:33.340459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:10:33.340459 [info ] [MainThread]: 
[0m19:10:33.340459 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:10:33.349244 [info ] [MainThread]: 
[0m19:10:33.350329 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 74 unexpected '-'.
  syntax error line 13 at position 0 unexpected 'SELECT'.
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_products.sql
[0m19:10:33.351325 [info ] [MainThread]: 
[0m19:10:33.352328 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:10:33.354526 [debug] [MainThread]: Command `dbt run` failed at 19:10:33.352328 after 15.70 seconds
[0m19:10:33.354526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023504747C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357FD833B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235044E4140>]}
[0m19:10:33.355534 [debug] [MainThread]: Flushing usage events
[0m19:10:34.745674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:59.968937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D16005100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D160051C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D16005C10>]}


============================== 19:11:59.970982 | bbe417e4-1469-4d8e-917f-dc5bdb350595 ==============================
[0m19:11:59.970982 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:11:59.970982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_products', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:12:01.321279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D22990890>]}
[0m19:12:01.425028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D154B3590>]}
[0m19:12:01.427033 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:12:02.054858 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:12:02.296875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:12:02.297873 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_products.sql
[0m19:12:02.634742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D22958C80>]}
[0m19:12:02.732781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:12:02.738807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:12:02.775694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D23206E70>]}
[0m19:12:02.775694 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:12:02.780224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D22FB90D0>]}
[0m19:12:02.780224 [info ] [MainThread]: 
[0m19:12:02.780224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:02.780224 [info ] [MainThread]: 
[0m19:12:02.780224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:12:02.780224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:12:02.911113 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:12:02.911113 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:12:02.911113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:04.401172 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.493 seconds
[0m19:12:04.428187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m19:12:04.441010 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:12:04.441010 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:12:04.441010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:05.345062 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.907 seconds
[0m19:12:05.345062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m19:12:05.359614 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:12:05.359614 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:12:05.539009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.189 seconds
[0m19:12:05.539009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m19:12:05.554874 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:12:05.554874 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:12:05.764104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.209 seconds
[0m19:12:05.764104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_mart)
[0m19:12:05.764104 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:12:05.764104 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:12:05.969863 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.205 seconds
[0m19:12:05.987137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D23228170>]}
[0m19:12:05.987137 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m19:12:05.987137 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_products .............................. [RUN]
[0m19:12:05.987137 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_products'
[0m19:12:05.987137 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m19:12:06.002067 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m19:12:06.002067 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m19:12:06.051605 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m19:12:06.053605 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m19:12:06.053605 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT 
        LOWER(REPLACE(product_id, ' ', '-')) AS product_id, -- Replace spaces with dashes
        LOWER(REPLACE(PRODUCT_Family, ' ', '-')) AS product_family, -- Replace spaces with dashes
        LOWER(REPLACE(product_sub_family, ' ', '-')) AS product_sub_family -- Replace spaces with dashes
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m19:12:06.054605 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:07.668188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.625 seconds
[0m19:12:07.699704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe417e4-1469-4d8e-917f-dc5bdb350595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D154B1220>]}
[0m19:12:07.699704 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 1.71s]
[0m19:12:07.699704 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m19:12:07.715670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:07.716580 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:12:07.716580 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:12:08.040823 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_mart' was left open.
[0m19:12:08.040823 [debug] [MainThread]: On list_DE_MINI_PROJECT_mart: Close
[0m19:12:08.363042 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_products' was left open.
[0m19:12:08.365051 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_products: Close
[0m19:12:08.677422 [info ] [MainThread]: 
[0m19:12:08.683099 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m19:12:08.683099 [debug] [MainThread]: Command end result
[0m19:12:08.714939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:12:08.717939 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:12:08.718939 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:12:08.718939 [info ] [MainThread]: 
[0m19:12:08.718939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:12:08.718939 [info ] [MainThread]: 
[0m19:12:08.728557 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:12:08.731846 [debug] [MainThread]: Command `dbt run` succeeded at 19:12:08.731846 after 9.05 seconds
[0m19:12:08.732860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D13C1E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D246CF6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D22BF0230>]}
[0m19:12:08.732860 [debug] [MainThread]: Flushing usage events
[0m19:12:09.960050 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:24.108555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DBAF0C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DBADBA600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DBA304920>]}


============================== 19:12:24.114706 | 29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3 ==============================
[0m19:12:24.114706 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:12:24.115353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi2', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:12:25.335808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC9D632C0>]}
[0m19:12:25.421041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC8CB3F80>]}
[0m19:12:25.421041 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:12:26.028124 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:12:26.260491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:26.260491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:26.308125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA0B7FE0>]}
[0m19:12:26.419211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:12:26.422198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:12:26.465128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCA230980>]}
[0m19:12:26.466129 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:12:26.467128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC9E86570>]}
[0m19:12:26.469162 [info ] [MainThread]: 
[0m19:12:26.470129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:26.470129 [info ] [MainThread]: 
[0m19:12:26.472129 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:12:26.473130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:12:26.602052 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:12:26.602052 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:12:26.610096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:27.910345 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.301 seconds
[0m19:12:27.917148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m19:12:27.932058 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:12:27.932058 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:12:27.932058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:28.849448 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.919 seconds
[0m19:12:28.849448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m19:12:28.849448 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:12:28.849448 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:12:29.076814 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.222 seconds
[0m19:12:29.080935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m19:12:29.086479 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:12:29.086479 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:12:29.289905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m19:12:29.289905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m19:12:29.289905 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:12:29.289905 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:12:29.479589 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.184 seconds
[0m19:12:29.483600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC9CF7CE0>]}
[0m19:12:29.485604 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:12:29.487609 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m19:12:29.487609 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m19:12:29.487609 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:12:29.500215 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:12:29.501283 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:12:29.540646 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:12:29.544646 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:12:29.544646 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:12:29.545647 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:31.017022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.472 seconds
[0m19:12:31.048427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29261b4e-4e56-4ebd-97b9-ddfa19c0e1b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DCB73F470>]}
[0m19:12:31.048427 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.55s]
[0m19:12:31.048427 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:12:31.053159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:31.053159 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:12:31.053159 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:12:31.377131 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:12:31.377131 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:12:31.691711 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m19:12:31.691711 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m19:12:32.020679 [info ] [MainThread]: 
[0m19:12:32.020679 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m19:12:32.020679 [debug] [MainThread]: Command end result
[0m19:12:32.057682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:12:32.058681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:12:32.068527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:12:32.068527 [info ] [MainThread]: 
[0m19:12:32.069523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:12:32.070520 [info ] [MainThread]: 
[0m19:12:32.070520 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:12:32.072720 [debug] [MainThread]: Command `dbt run` succeeded at 19:12:32.072720 after 8.17 seconds
[0m19:12:32.072720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DBC2138C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DBC90C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DBCC70B00>]}
[0m19:12:32.074726 [debug] [MainThread]: Flushing usage events
[0m19:12:32.955358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:55.455212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CA86C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C93A2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CA86C350>]}


============================== 19:14:55.455212 | cf8e8bd7-b1ae-4c94-94fe-de310777a7ad ==============================
[0m19:14:55.455212 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:14:55.455212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:56.659846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D8396270>]}
[0m19:14:56.739487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D93C9040>]}
[0m19:14:56.739487 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:14:57.325350 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:14:57.558760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:57.558760 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_products.sql
[0m19:14:57.901514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D9CD64B0>]}
[0m19:14:57.995574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:14:58.009827 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:14:58.043306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D9CA6D20>]}
[0m19:14:58.043306 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:14:58.043306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D9CB8650>]}
[0m19:14:58.049096 [info ] [MainThread]: 
[0m19:14:58.049096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:58.049096 [info ] [MainThread]: 
[0m19:14:58.049096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:58.049096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:14:58.179527 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:14:58.179527 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:14:58.179527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:59.544448 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.362 seconds
[0m19:14:59.552517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m19:14:59.552517 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:14:59.552517 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:14:59.552517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:00.518196 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.955 seconds
[0m19:15:00.518196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m19:15:00.526013 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:15:00.526013 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:15:00.720664 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m19:15:00.736645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_mart)
[0m19:15:00.736645 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:15:00.736645 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:15:00.928974 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.193 seconds
[0m19:15:00.944805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m19:15:00.944805 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:15:00.944805 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:15:01.138615 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.198 seconds
[0m19:15:01.138615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8D9B9DD00>]}
[0m19:15:01.154285 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m19:15:01.154285 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_products .............................. [RUN]
[0m19:15:01.154285 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_products'
[0m19:15:01.154285 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m19:15:01.154285 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m19:15:01.154285 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m19:15:01.205322 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m19:15:01.207329 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m19:15:01.208364 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT 
        LOWER(REPLACE(REPLACE(product_id, ' - ', '-'), ' ', '-')) AS product_id, -- Replace spaces with dashes and remove spaces around dashes
        LOWER(REPLACE(REPLACE(PRODUCT_Family, ' - ', '-'), ' ', '-')) AS product_family, -- Clean product_family
        LOWER(REPLACE(REPLACE(product_sub_family, ' - ', '-'), ' ', '-')) AS product_sub_family -- Clean product_sub_family
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m19:15:01.208364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:02.579764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.377 seconds
[0m19:15:02.611283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8e8bd7-b1ae-4c94-94fe-de310777a7ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C9E47380>]}
[0m19:15:02.611283 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 1.46s]
[0m19:15:02.611283 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m19:15:02.611283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:02.611283 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:15:02.611283 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:15:02.941994 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m19:15:02.941994 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m19:15:03.256742 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_products' was left open.
[0m19:15:03.256742 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_products: Close
[0m19:15:03.597027 [info ] [MainThread]: 
[0m19:15:03.597027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m19:15:03.598036 [debug] [MainThread]: Command end result
[0m19:15:03.626437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:15:03.626437 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:15:03.638165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:15:03.638165 [info ] [MainThread]: 
[0m19:15:03.638165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:03.638165 [info ] [MainThread]: 
[0m19:15:03.638165 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:15:03.638165 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:03.638165 after 8.40 seconds
[0m19:15:03.638165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CC9058E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CC5D84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CC5DB230>]}
[0m19:15:03.646727 [debug] [MainThread]: Flushing usage events
[0m19:15:04.855454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:16.223061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E820DD79E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E820208D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E820DD5CD0>]}


============================== 19:15:16.223061 | ade21f88-22c4-4da1-8dcc-c4ea0c7359bc ==============================
[0m19:15:16.223061 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:15:16.223061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m kpi2', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:17.426151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E82B1BF530>]}
[0m19:15:17.489953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E82DA161B0>]}
[0m19:15:17.489953 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:15:18.070845 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:15:18.309009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:15:18.309009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:15:18.366473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E82DD0C290>]}
[0m19:15:18.461485 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:15:18.461485 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:15:18.508638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E82DF40AA0>]}
[0m19:15:18.508638 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:15:18.508638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E82DDAC7D0>]}
[0m19:15:18.512021 [info ] [MainThread]: 
[0m19:15:18.512021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:18.512021 [info ] [MainThread]: 
[0m19:15:18.512021 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:18.516606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:15:18.633970 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:15:18.633970 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:15:18.633970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:19.936806 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.293 seconds
[0m19:15:19.952429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m19:15:19.968820 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:15:19.968820 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:15:19.968820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:20.942475 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.960 seconds
[0m19:15:20.947731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m19:15:20.953027 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:15:20.953027 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:15:21.153219 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.203 seconds
[0m19:15:21.153219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_staging)
[0m19:15:21.163862 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:15:21.165827 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:15:21.365416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m19:15:21.370606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m19:15:21.373795 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:15:21.373795 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:15:21.574239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.194 seconds
[0m19:15:21.578267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E82CEB9070>]}
[0m19:15:21.578267 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:15:21.578267 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi2 ......................................... [RUN]
[0m19:15:21.586657 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi2'
[0m19:15:21.587682 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:15:21.598812 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:15:21.600781 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:15:21.639669 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:15:21.639669 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:15:21.639669 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:15:21.639669 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:23.137506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.486 seconds
[0m19:15:23.175225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade21f88-22c4-4da1-8dcc-c4ea0c7359bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E81E177440>]}
[0m19:15:23.176224 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi2 .................................... [[32mSUCCESS 1[0m in 1.59s]
[0m19:15:23.177227 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:15:23.179260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:23.179260 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:15:23.179260 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:15:23.502878 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:15:23.504205 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:15:23.825692 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi2' was left open.
[0m19:15:23.826721 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi2: Close
[0m19:15:24.149807 [info ] [MainThread]: 
[0m19:15:24.149807 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.64 seconds (5.64s).
[0m19:15:24.149807 [debug] [MainThread]: Command end result
[0m19:15:24.184910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:15:24.191338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:15:24.193308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:15:24.193308 [info ] [MainThread]: 
[0m19:15:24.193308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:24.193308 [info ] [MainThread]: 
[0m19:15:24.193308 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:15:24.205492 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:24.193308 after 8.18 seconds
[0m19:15:24.205492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E820BFAFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E820208D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E820DD4620>]}
[0m19:15:24.206506 [debug] [MainThread]: Flushing usage events
[0m19:15:25.156503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:10.647652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF527D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF5A1DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF348E9F0>]}


============================== 19:16:10.653669 | 4afa0911-f417-404e-8b0c-71681a763c61 ==============================
[0m19:16:10.653669 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:16:10.655675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:16:11.862869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8204AAB0>]}
[0m19:16:11.942535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF3DD15B0>]}
[0m19:16:11.944545 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:16:12.524655 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:16:12.758072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:12.758072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:12.818984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE82DBC2C0>]}
[0m19:16:12.915030 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:16:12.915030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:16:12.962204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE82EDC2C0>]}
[0m19:16:12.962204 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:16:12.962204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE82C1B290>]}
[0m19:16:12.962204 [info ] [MainThread]: 
[0m19:16:12.962204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:12.962204 [info ] [MainThread]: 
[0m19:16:12.962204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:12.976524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:16:13.103656 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:16:13.103656 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:16:13.103656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:14.583316 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.485 seconds
[0m19:16:14.583316 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:16:14.583316 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:16:14.770347 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.175 seconds
[0m19:16:14.773973 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:16:14.773973 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:16:14.955109 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.191 seconds
[0m19:16:14.971537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m19:16:14.986666 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:16:14.986666 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:16:14.986666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:15.991967 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.995 seconds
[0m19:16:15.996952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m19:16:16.000951 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:16:16.000951 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:16:16.183980 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.189 seconds
[0m19:16:16.183980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m19:16:16.183980 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:16:16.183980 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:16:16.404641 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.222 seconds
[0m19:16:16.420371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m19:16:16.420371 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:16:16.436125 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:16:16.634033 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m19:16:16.637888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8341DF70>]}
[0m19:16:16.640558 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_country
[0m19:16:16.641125 [info ] [Thread-1 (]: 1 of 12 START sql table model staging.stg_country .............................. [RUN]
[0m19:16:16.642975 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_country'
[0m19:16:16.642975 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_country
[0m19:16:16.652360 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_country"
[0m19:16:16.653361 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_country
[0m19:16:16.693081 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_country"
[0m19:16:16.695080 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_country"
[0m19:16:16.695080 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_country: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_country"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_country
         as
        (SELECT 
   customer_id,
   company,
   customername AS customer_name 
FROM 
DE_MINI_PROJECT.RAW.country_region
        );
[0m19:16:16.696078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:17.604455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00da-3201-7db6-000c-3d5a0002631a
[0m19:16:17.604455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 3
invalid identifier 'COMPANY'
[0m19:16:17.609769 [debug] [Thread-1 (]: Database Error in model stg_country (models\staging\stg_country.sql)
  000904 (42000): SQL compilation error: error line 5 at position 3
  invalid identifier 'COMPANY'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_country.sql
[0m19:16:17.612661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF52B1760>]}
[0m19:16:17.613670 [error] [Thread-1 (]: 1 of 12 ERROR creating sql table model staging.stg_country ..................... [[31mERROR[0m in 0.97s]
[0m19:16:17.614278 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_country
[0m19:16:17.615285 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m19:16:17.616322 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.stg_country' to be skipped because of status 'error'.  Reason: Database Error in model stg_country (models\staging\stg_country.sql)
  000904 (42000): SQL compilation error: error line 5 at position 3
  invalid identifier 'COMPANY'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_country.sql.
[0m19:16:17.615285 [info ] [Thread-1 (]: 2 of 12 START sql table model staging.stg_customers ............................ [RUN]
[0m19:16:17.618171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_country, now model.DE_MINI_PROJECT.stg_customers)
[0m19:16:17.618171 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m19:16:17.622321 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:16:17.624288 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m19:16:17.627398 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:16:17.629363 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m19:16:17.630398 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (-- WITH customers_cleaning AS (
    
-- SELECT 
--     DISTINCT
--     *
-- FROM de_mini_project.raw.customers
-- WHERE 
--     CUSTOMER_ID IS NOT NULL
--     AND COMPANY IS NOT NULL
--     AND CUSTOMERNAME IS NOT NULL
-- )
-- SELECT * FROM customers_cleaning


WITH customers_cleaning AS (
    
SELECT 
    DISTINCT
    CUSTOMER_ID,
    COMPANY,
    CUSTOMERNAME AS CUSTOMER_NAME
FROM de_mini_project.raw.customers
WHERE 
    CUSTOMER_ID IS NOT NULL
    AND COMPANY IS NOT NULL
    AND CUSTOMERNAME IS NOT NULL
)
SELECT 
    * 
FROM customers_cleaning cc
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON cc.CUSTOMER_ID = cr.customer_id
        );
[0m19:16:17.839570 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00da-3201-7e57-000c-3d5a0002570e
[0m19:16:17.839570 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'
[0m19:16:17.843361 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql
[0m19:16:17.844361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE84658D10>]}
[0m19:16:17.845326 [error] [Thread-1 (]: 2 of 12 ERROR creating sql table model staging.stg_customers ................... [[31mERROR[0m in 0.23s]
[0m19:16:17.846327 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m19:16:17.846327 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m19:16:17.847325 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql.
[0m19:16:17.848361 [info ] [Thread-1 (]: 3 of 12 START sql table model staging.stg_products ............................. [RUN]
[0m19:16:17.849327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m19:16:17.849327 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m19:16:17.853329 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m19:16:17.854327 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m19:16:17.858984 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m19:16:17.861068 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m19:16:17.862099 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT 
        LOWER(REPLACE(REPLACE(product_id, ' - ', '-'), ' ', '-')) AS product_id, -- Replace spaces with dashes and remove spaces around dashes
        LOWER(REPLACE(REPLACE(PRODUCT_Family, ' - ', '-'), ' ', '-')) AS product_family, -- Clean product_family
        LOWER(REPLACE(REPLACE(product_sub_family, ' - ', '-'), ' ', '-')) AS product_sub_family -- Clean product_sub_family
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m19:16:18.507002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m19:16:18.526080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE84670200>]}
[0m19:16:18.526080 [info ] [Thread-1 (]: 3 of 12 OK created sql table model staging.stg_products ........................ [[32mSUCCESS 1[0m in 0.68s]
[0m19:16:18.526080 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m19:16:18.526080 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m19:16:18.526080 [info ] [Thread-1 (]: 4 of 12 START sql table model staging.stg_transactions ......................... [RUN]
[0m19:16:18.526080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m19:16:18.526080 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m19:16:18.544797 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m19:16:18.547007 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m19:16:18.548005 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m19:16:18.548005 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m19:16:18.548005 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month AS payment_date,
    revenue_type,
    revenue,
    quantity
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_date IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m19:16:19.442326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m19:16:19.453766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE84664F80>]}
[0m19:16:19.455775 [info ] [Thread-1 (]: 4 of 12 OK created sql table model staging.stg_transactions .................... [[32mSUCCESS 1[0m in 0.93s]
[0m19:16:19.455775 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m19:16:19.455775 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m19:16:19.458249 [info ] [Thread-1 (]: 5 of 12 SKIP relation intermediate.intermediate_customers ...................... [[33mSKIP[0m]
[0m19:16:19.458249 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m19:16:19.458249 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m19:16:19.458249 [info ] [Thread-1 (]: 6 of 12 SKIP relation mart.kpi1 ................................................ [[33mSKIP[0m]
[0m19:16:19.458249 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m19:16:19.458249 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:16:19.462566 [info ] [Thread-1 (]: 7 of 12 START sql table model mart.kpi2 ........................................ [RUN]
[0m19:16:19.463576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now model.DE_MINI_PROJECT.kpi2)
[0m19:16:19.464575 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:16:19.467577 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:16:19.469236 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:16:19.473547 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:16:19.477231 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:16:19.478241 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:16:20.275527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m19:16:20.275527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE84586870>]}
[0m19:16:20.275527 [info ] [Thread-1 (]: 7 of 12 OK created sql table model mart.kpi2 ................................... [[32mSUCCESS 1[0m in 0.81s]
[0m19:16:20.275527 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:16:20.275527 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:16:20.275527 [info ] [Thread-1 (]: 8 of 12 START sql table model mart.kpi3 ........................................ [RUN]
[0m19:16:20.275527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi2, now model.DE_MINI_PROJECT.kpi3)
[0m19:16:20.275527 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:16:20.292340 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:16:20.293676 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:16:20.295163 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:16:20.301634 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:16:20.303645 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m19:16:20.940527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m19:16:20.956712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE84534290>]}
[0m19:16:20.956712 [info ] [Thread-1 (]: 8 of 12 OK created sql table model mart.kpi3 ................................... [[32mSUCCESS 1[0m in 0.68s]
[0m19:16:20.956712 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:16:20.956712 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m19:16:20.956712 [info ] [Thread-1 (]: 9 of 12 START sql table model mart.kpi4 ........................................ [RUN]
[0m19:16:20.956712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi3, now model.DE_MINI_PROJECT.kpi4)
[0m19:16:20.956712 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m19:16:20.956712 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m19:16:20.956712 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m19:16:20.956712 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m19:16:20.972772 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m19:16:20.973763 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (-- WITH monthly_revenue AS (
--     SELECT
--         DATE_TRUNC('MONTH', payment_date) AS month,
--         SUM(revenue) AS total_revenue
--     FROM
--         DE_MINI_PROJECT.staging.stg_transactions
--     WHERE
--         REVENUE_TYPE = 1
--     GROUP BY
--         month
-- )
-- SELECT
--     month,
--     total_revenue,
--     LAG(total_revenue) OVER (ORDER BY month) AS previous,
--     CASE 
--         WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
--             LAG(total_revenue) OVER (ORDER BY month) - total_revenue
--         ELSE 
--             0
--     END AS revenue_lost
-- FROM
--     monthly_revenue
-- ORDER BY
--     month
 

 WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_DATE) AS PREV_REVENUE
FROM DE_MINI_PROJECT.staging.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_DATE,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_DATE 
ORDER BY Revenue_Loss DESC
        );
[0m19:16:21.803005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m19:16:21.805010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE847744A0>]}
[0m19:16:21.805010 [info ] [Thread-1 (]: 9 of 12 OK created sql table model mart.kpi4 ................................... [[32mSUCCESS 1[0m in 0.85s]
[0m19:16:21.805010 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m19:16:21.810902 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m19:16:21.810902 [info ] [Thread-1 (]: 10 of 12 START sql table model mart.kpi5 ....................................... [RUN]
[0m19:16:21.810902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi4, now model.DE_MINI_PROJECT.kpi5)
[0m19:16:21.813013 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m19:16:21.816055 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m19:16:21.817056 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m19:16:21.820055 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m19:16:21.822021 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m19:16:21.822021 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:16:22.443510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m19:16:22.443510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE84774A70>]}
[0m19:16:22.443510 [info ] [Thread-1 (]: 10 of 12 OK created sql table model mart.kpi5 .................................. [[32mSUCCESS 1[0m in 0.63s]
[0m19:16:22.443510 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m19:16:22.443510 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m19:16:22.443510 [info ] [Thread-1 (]: 11 of 12 START sql table model mart.kpi6 ....................................... [RUN]
[0m19:16:22.443510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi5, now model.DE_MINI_PROJECT.kpi6)
[0m19:16:22.443510 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m19:16:22.443510 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m19:16:22.459567 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m19:16:22.463578 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m19:16:22.465613 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m19:16:22.465613 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m19:16:22.880607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m19:16:22.890290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afa0911-f417-404e-8b0c-71681a763c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8474B440>]}
[0m19:16:22.892301 [info ] [Thread-1 (]: 11 of 12 OK created sql table model mart.kpi6 .................................. [[32mSUCCESS 1[0m in 0.45s]
[0m19:16:22.892301 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m19:16:22.892301 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m19:16:22.892301 [info ] [Thread-1 (]: 12 of 12 SKIP relation mart.kpi7 ............................................... [[33mSKIP[0m]
[0m19:16:22.895776 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m19:16:22.897317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:22.898162 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:16:22.898162 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:16:23.226851 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_staging' was left open.
[0m19:16:23.226851 [debug] [MainThread]: On list_DE_MINI_PROJECT_staging: Close
[0m19:16:23.532441 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi6' was left open.
[0m19:16:23.532441 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi6: Close
[0m19:16:23.885827 [info ] [MainThread]: 
[0m19:16:23.887828 [info ] [MainThread]: Finished running 12 table models in 0 hours 0 minutes and 10.92 seconds (10.92s).
[0m19:16:23.890912 [debug] [MainThread]: Command end result
[0m19:16:23.937688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:16:23.940688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:16:23.952292 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:16:23.952292 [info ] [MainThread]: 
[0m19:16:23.955108 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:16:23.957120 [info ] [MainThread]: 
[0m19:16:23.957120 [error] [MainThread]:   Database Error in model stg_country (models\staging\stg_country.sql)
  000904 (42000): SQL compilation error: error line 5 at position 3
  invalid identifier 'COMPANY'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_country.sql
[0m19:16:23.957120 [info ] [MainThread]: 
[0m19:16:23.957120 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\DE_MINI_PROJECT\models\staging\stg_customers.sql
[0m19:16:23.957120 [info ] [MainThread]: 
[0m19:16:23.957120 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=3 TOTAL=12
[0m19:16:23.965244 [debug] [MainThread]: Command `dbt run` failed at 19:16:23.964233 after 13.55 seconds
[0m19:16:23.965717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF55A8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE82B51A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE82E58AD0>]}
[0m19:16:23.965717 [debug] [MainThread]: Flushing usage events
[0m19:16:25.124302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:08.241418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1528F32F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1533FE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A155560C20>]}


============================== 19:18:08.241418 | 4b79bf8a-bd12-44df-b321-496e0d735b55 ==============================
[0m19:18:08.241418 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:18:08.241418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:18:09.452108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1623AA930>]}
[0m19:18:09.529005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A154EAF7A0>]}
[0m19:18:09.529005 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:18:10.120564 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:18:10.343008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:10.343008 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_customers.sql
[0m19:18:10.695059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16280B200>]}
[0m19:18:10.792503 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:18:10.798517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:18:10.835851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16291F0B0>]}
[0m19:18:10.835851 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 473 macros
[0m19:18:10.837861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1626F9B50>]}
[0m19:18:10.839870 [info ] [MainThread]: 
[0m19:18:10.839870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:10.839870 [info ] [MainThread]: 
[0m19:18:10.839870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:10.839870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:18:10.971332 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:18:10.971332 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:18:10.971332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:12.278390 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.316 seconds
[0m19:18:12.294209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m19:18:12.310049 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:18:12.310049 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:18:12.310049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:13.216790 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.915 seconds
[0m19:18:13.216790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m19:18:13.232472 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:18:13.232472 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:18:13.431005 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.196 seconds
[0m19:18:13.433025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m19:18:13.433025 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:18:13.433025 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:18:13.654212 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.216 seconds
[0m19:18:13.654212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m19:18:13.654212 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:18:13.654212 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:18:13.853030 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.191 seconds
[0m19:18:13.857038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A163CDF740>]}
[0m19:18:13.863028 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m19:18:13.864035 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m19:18:13.865992 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m19:18:13.867320 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m19:18:13.880763 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:18:13.881739 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m19:18:13.910732 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:18:13.910732 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m19:18:13.910732 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    SELECT 
        DISTINCT
        CUSTOMER_ID,
        COMPANY,
        CUSTOMERNAME AS CUSTOMER_NAME
    FROM de_mini_project.raw.customers
    WHERE 
        CUSTOMER_ID IS NOT NULL
        AND COMPANY IS NOT NULL
        AND CUSTOMERNAME IS NOT NULL
)
SELECT 
    cc.CUSTOMER_ID, 
    cc.COMPANY,
    cc.CUSTOMER_NAME,
    cr.REGION, 
    cr.COUNTRY 
FROM customers_cleaning cc
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON cc.CUSTOMER_ID = cr.customer_id
        );
[0m19:18:13.910732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:18:15.626727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m19:18:15.658628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b79bf8a-bd12-44df-b321-496e0d735b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A154B212B0>]}
[0m19:18:15.658628 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.79s]
[0m19:18:15.658628 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m19:18:15.658628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:15.658628 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:18:15.658628 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:18:15.979001 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:18:15.979001 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:18:16.341449 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.stg_customers' was left open.
[0m19:18:16.341449 [debug] [MainThread]: On model.DE_MINI_PROJECT.stg_customers: Close
[0m19:18:16.662907 [info ] [MainThread]: 
[0m19:18:16.662907 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m19:18:16.662907 [debug] [MainThread]: Command end result
[0m19:18:16.701561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:18:16.701561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:18:16.712638 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:18:16.713593 [info ] [MainThread]: 
[0m19:18:16.713593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:16.713593 [info ] [MainThread]: 
[0m19:18:16.713593 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:16.713593 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:16.713593 after 8.76 seconds
[0m19:18:16.713593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1528F32F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1551DFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1551DDD60>]}
[0m19:18:16.713593 [debug] [MainThread]: Flushing usage events
[0m19:18:17.629733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:34.951570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE3FAE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE3FAE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBDF026F0>]}


============================== 19:19:34.951570 | d04d8f81-62bb-4ef3-8af4-0d0c588dfdaf ==============================
[0m19:19:34.951570 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:19:34.951570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:19:36.176111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC9DC2F60>]}
[0m19:19:36.254820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBDEE2600>]}
[0m19:19:36.257171 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:19:36.827510 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:19:37.062574 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m19:19:37.064581 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\source.yml
[0m19:19:37.064581 [debug] [MainThread]: Partial parsing: deleted file: DE_MINI_PROJECT://models\staging\stg_country.sql
[0m19:19:37.623313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC8C4AB40>]}
[0m19:19:37.715200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:19:37.731015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:19:37.771757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCC8F6420>]}
[0m19:19:37.771757 [info ] [MainThread]: Found 1 seed, 11 models, 3 sources, 473 macros
[0m19:19:37.772757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB65E210>]}
[0m19:19:37.774688 [info ] [MainThread]: 
[0m19:19:37.774688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:37.774688 [info ] [MainThread]: 
[0m19:19:37.778457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:37.783493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:19:37.913406 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:19:37.915417 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:19:37.915417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:39.255174 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.339 seconds
[0m19:19:39.256216 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:19:39.256216 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:19:39.440403 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.191 seconds
[0m19:19:39.456331 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:19:39.456331 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:19:39.663933 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.206 seconds
[0m19:19:39.663933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m19:19:39.681942 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:19:39.683950 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:19:39.683950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:40.637113 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.966 seconds
[0m19:19:40.652865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m19:19:40.652865 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:19:40.652865 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:19:40.862152 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.203 seconds
[0m19:19:40.862152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m19:19:40.862152 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:19:40.862152 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:19:41.061836 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.187 seconds
[0m19:19:41.061836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m19:19:41.061836 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:19:41.061836 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:19:41.268630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.205 seconds
[0m19:19:41.268630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB70BB60>]}
[0m19:19:41.268630 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m19:19:41.284387 [info ] [Thread-1 (]: 1 of 11 START sql table model staging.stg_customers ............................ [RUN]
[0m19:19:41.284387 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m19:19:41.284387 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m19:19:41.302826 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:19:41.304443 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m19:19:41.343172 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:19:41.345137 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m19:19:41.346297 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    SELECT 
        DISTINCT
        CUSTOMER_ID,
        COMPANY,
        CUSTOMERNAME AS CUSTOMER_NAME
    FROM de_mini_project.raw.customers
    WHERE 
        CUSTOMER_ID IS NOT NULL
        AND COMPANY IS NOT NULL
        AND CUSTOMERNAME IS NOT NULL
)
SELECT 
    cc.CUSTOMER_ID, 
    cc.COMPANY,
    cc.CUSTOMER_NAME,
    cr.REGION, 
    cr.COUNTRY 
FROM customers_cleaning cc
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON cc.CUSTOMER_ID = cr.customer_id
        );
[0m19:19:41.347262 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:42.768292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.423 seconds
[0m19:19:42.820548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBD9E1A30>]}
[0m19:19:42.820548 [info ] [Thread-1 (]: 1 of 11 OK created sql table model staging.stg_customers ....................... [[32mSUCCESS 1[0m in 1.53s]
[0m19:19:42.820548 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m19:19:42.820548 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m19:19:42.820548 [info ] [Thread-1 (]: 2 of 11 START sql table model staging.stg_products ............................. [RUN]
[0m19:19:42.820548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m19:19:42.820548 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m19:19:42.820548 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m19:19:42.820548 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m19:19:42.820548 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m19:19:42.820548 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m19:19:42.820548 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT 
        LOWER(REPLACE(REPLACE(product_id, ' - ', '-'), ' ', '-')) AS product_id, -- Replace spaces with dashes and remove spaces around dashes
        LOWER(REPLACE(REPLACE(PRODUCT_Family, ' - ', '-'), ' ', '-')) AS product_family, -- Clean product_family
        LOWER(REPLACE(REPLACE(product_sub_family, ' - ', '-'), ' ', '-')) AS product_sub_family -- Clean product_sub_family
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m19:19:43.419163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m19:19:43.419163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCCFC79B0>]}
[0m19:19:43.432836 [info ] [Thread-1 (]: 2 of 11 OK created sql table model staging.stg_products ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m19:19:43.432836 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m19:19:43.432836 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m19:19:43.432836 [info ] [Thread-1 (]: 3 of 11 START sql table model staging.stg_transactions ......................... [RUN]
[0m19:19:43.432836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m19:19:43.432836 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m19:19:43.432836 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m19:19:43.432836 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m19:19:43.432836 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m19:19:43.432836 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m19:19:43.432836 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month AS payment_date,
    revenue_type,
    revenue,
    quantity
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_date IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m19:19:44.033665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m19:19:44.033665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCCFD6150>]}
[0m19:19:44.033665 [info ] [Thread-1 (]: 3 of 11 OK created sql table model staging.stg_transactions .................... [[32mSUCCESS 1[0m in 0.60s]
[0m19:19:44.033665 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m19:19:44.033665 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m19:19:44.033665 [info ] [Thread-1 (]: 4 of 11 START sql table model intermediate.intermediate_customers .............. [RUN]
[0m19:19:44.033665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now model.DE_MINI_PROJECT.intermediate_customers)
[0m19:19:44.033665 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m19:19:44.033665 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m19:19:44.048476 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m19:19:44.051361 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m19:19:44.054151 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m19:19:44.054151 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m19:19:44.712618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m19:19:44.712618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCCEBCFB0>]}
[0m19:19:44.712618 [info ] [Thread-1 (]: 4 of 11 OK created sql table model intermediate.intermediate_customers ......... [[32mSUCCESS 1[0m in 0.68s]
[0m19:19:44.712618 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m19:19:44.712618 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m19:19:44.712618 [info ] [Thread-1 (]: 5 of 11 START sql table model mart.kpi1 ........................................ [RUN]
[0m19:19:44.712618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.intermediate_customers, now model.DE_MINI_PROJECT.kpi1)
[0m19:19:44.712618 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m19:19:44.712618 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m19:19:44.712618 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m19:19:44.730827 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m19:19:44.733670 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m19:19:44.734668 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi1
         as
        (WITH customers_data AS (
    SELECT
        payment_date,
        customer_id,
        MIN(payment_date) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_date) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_date,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_date THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_date AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_date
    ORDER BY payment_date
)
SELECT * FROM new_and_churned_customers
        );
[0m19:19:45.409056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m19:19:45.409056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCCF00260>]}
[0m19:19:45.409056 [info ] [Thread-1 (]: 5 of 11 OK created sql table model mart.kpi1 ................................... [[32mSUCCESS 1[0m in 0.70s]
[0m19:19:45.425213 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m19:19:45.425213 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:19:45.425213 [info ] [Thread-1 (]: 6 of 11 START sql table model mart.kpi2 ........................................ [RUN]
[0m19:19:45.425213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi1, now model.DE_MINI_PROJECT.kpi2)
[0m19:19:45.425213 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:19:45.425213 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:19:45.425213 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:19:45.425213 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:19:45.425213 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:19:45.425213 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:19:46.169651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m19:19:46.169651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCCFDEDE0>]}
[0m19:19:46.169651 [info ] [Thread-1 (]: 6 of 11 OK created sql table model mart.kpi2 ................................... [[32mSUCCESS 1[0m in 0.74s]
[0m19:19:46.169651 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:19:46.169651 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:19:46.169651 [info ] [Thread-1 (]: 7 of 11 START sql table model mart.kpi3 ........................................ [RUN]
[0m19:19:46.169651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi2, now model.DE_MINI_PROJECT.kpi3)
[0m19:19:46.169651 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:19:46.169651 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:19:46.184401 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:19:46.188516 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:19:46.191579 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:19:46.191579 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m19:19:46.864432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m19:19:46.864432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCD016A20>]}
[0m19:19:46.864432 [info ] [Thread-1 (]: 7 of 11 OK created sql table model mart.kpi3 ................................... [[32mSUCCESS 1[0m in 0.69s]
[0m19:19:46.864432 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:19:46.864432 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m19:19:46.864432 [info ] [Thread-1 (]: 8 of 11 START sql table model mart.kpi4 ........................................ [RUN]
[0m19:19:46.864432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi3, now model.DE_MINI_PROJECT.kpi4)
[0m19:19:46.864432 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m19:19:46.951463 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m19:19:46.952498 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m19:19:46.955493 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m19:19:46.957464 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m19:19:46.958497 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (-- WITH monthly_revenue AS (
--     SELECT
--         DATE_TRUNC('MONTH', payment_date) AS month,
--         SUM(revenue) AS total_revenue
--     FROM
--         DE_MINI_PROJECT.staging.stg_transactions
--     WHERE
--         REVENUE_TYPE = 1
--     GROUP BY
--         month
-- )
-- SELECT
--     month,
--     total_revenue,
--     LAG(total_revenue) OVER (ORDER BY month) AS previous,
--     CASE 
--         WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
--             LAG(total_revenue) OVER (ORDER BY month) - total_revenue
--         ELSE 
--             0
--     END AS revenue_lost
-- FROM
--     monthly_revenue
-- ORDER BY
--     month
 

 WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_DATE) AS PREV_REVENUE
FROM DE_MINI_PROJECT.staging.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_DATE,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_DATE 
ORDER BY Revenue_Loss DESC
        );
[0m19:19:47.508892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m19:19:47.508892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCC8D4710>]}
[0m19:19:47.508892 [info ] [Thread-1 (]: 8 of 11 OK created sql table model mart.kpi4 ................................... [[32mSUCCESS 1[0m in 0.64s]
[0m19:19:47.524527 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m19:19:47.524527 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m19:19:47.524527 [info ] [Thread-1 (]: 9 of 11 START sql table model mart.kpi5 ........................................ [RUN]
[0m19:19:47.524527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi4, now model.DE_MINI_PROJECT.kpi5)
[0m19:19:47.524527 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m19:19:47.524527 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m19:19:47.524527 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m19:19:47.524527 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m19:19:47.524527 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m19:19:47.524527 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:19:48.101076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m19:19:48.101076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB7BFE90>]}
[0m19:19:48.101076 [info ] [Thread-1 (]: 9 of 11 OK created sql table model mart.kpi5 ................................... [[32mSUCCESS 1[0m in 0.58s]
[0m19:19:48.101076 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m19:19:48.101076 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m19:19:48.101076 [info ] [Thread-1 (]: 10 of 11 START sql table model mart.kpi6 ....................................... [RUN]
[0m19:19:48.101076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi5, now model.DE_MINI_PROJECT.kpi6)
[0m19:19:48.109474 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m19:19:48.109474 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m19:19:48.109474 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m19:19:48.109474 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m19:19:48.109474 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m19:19:48.109474 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m19:19:48.610749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m19:19:48.626656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB5C2240>]}
[0m19:19:48.626656 [info ] [Thread-1 (]: 10 of 11 OK created sql table model mart.kpi6 .................................. [[32mSUCCESS 1[0m in 0.53s]
[0m19:19:48.626656 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m19:19:48.626656 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m19:19:48.626656 [info ] [Thread-1 (]: 11 of 11 START sql table model mart.kpi7 ....................................... [RUN]
[0m19:19:48.626656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi6, now model.DE_MINI_PROJECT.kpi7)
[0m19:19:48.626656 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m19:19:48.626656 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m19:19:48.626656 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m19:19:48.626656 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m19:19:48.642303 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m19:19:48.642303 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.CUSTOMER_ID,
    rc.total_revenue,
    rc.revenue_rank,
    cc.CUSTOMER_NAME
FROM ranked_customers rc
JOIN DE_MINI_PROJECT.staging.stg_customers cc
    ON rc.customer_id = cc.customer_id
ORDER BY revenue_rank
        );
[0m19:19:49.144605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m19:19:49.160501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04d8f81-62bb-4ef3-8af4-0d0c588dfdaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE534320>]}
[0m19:19:49.160501 [info ] [Thread-1 (]: 11 of 11 OK created sql table model mart.kpi7 .................................. [[32mSUCCESS 1[0m in 0.53s]
[0m19:19:49.160501 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m19:19:49.160501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:49.160501 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:19:49.160501 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:19:49.483751 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:19:49.483751 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:19:49.806577 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m19:19:49.806577 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m19:19:50.147281 [info ] [MainThread]: 
[0m19:19:50.147281 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 12.37 seconds (12.37s).
[0m19:19:50.147281 [debug] [MainThread]: Command end result
[0m19:19:50.177858 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:19:50.190026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:19:50.190026 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:19:50.190026 [info ] [MainThread]: 
[0m19:19:50.190026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:50.190026 [info ] [MainThread]: 
[0m19:19:50.190026 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:19:50.203647 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:50.203647 after 15.48 seconds
[0m19:19:50.203647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBDBD6AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBD5CB530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBD99FCB0>]}
[0m19:19:50.205175 [debug] [MainThread]: Flushing usage events
[0m19:19:51.796410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:09.436078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165293F7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165293F6BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165293F45C0>]}


============================== 19:21:09.436078 | 82dcbefa-17af-49e9-a24d-d82a5f0aaede ==============================
[0m19:21:09.436078 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:21:09.436078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:21:10.762572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001653576F0B0>]}
[0m19:21:10.842706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652943C410>]}
[0m19:21:10.844307 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:21:11.459168 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:21:11.702014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:21:11.716818 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\staging\stg_products.sql
[0m19:21:12.068469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016536517860>]}
[0m19:21:12.172170 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:21:12.178027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:21:12.222644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165365EAA50>]}
[0m19:21:12.223643 [info ] [MainThread]: Found 1 seed, 11 models, 3 sources, 473 macros
[0m19:21:12.224643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001653635A210>]}
[0m19:21:12.226676 [info ] [MainThread]: 
[0m19:21:12.227644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:12.228644 [info ] [MainThread]: 
[0m19:21:12.229643 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:12.236199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:21:12.365114 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:21:12.366113 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:21:12.367116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:13.696933 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.330 seconds
[0m19:21:13.700933 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:21:13.701967 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:21:13.919716 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.218 seconds
[0m19:21:13.923994 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:21:13.924995 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:21:14.127463 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.207 seconds
[0m19:21:14.138200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m19:21:14.153157 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:21:14.159017 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:21:14.159017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:15.124138 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.973 seconds
[0m19:21:15.124138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m19:21:15.124138 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:21:15.138729 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:21:15.359454 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.220 seconds
[0m19:21:15.362421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m19:21:15.364454 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:21:15.365418 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:21:15.558649 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.193 seconds
[0m19:21:15.560479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m19:21:15.563656 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:21:15.563656 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:21:15.802662 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.239 seconds
[0m19:21:15.802662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016526891160>]}
[0m19:21:15.802662 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_customers
[0m19:21:15.802662 [info ] [Thread-1 (]: 1 of 11 START sql table model staging.stg_customers ............................ [RUN]
[0m19:21:15.802662 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.stg_customers'
[0m19:21:15.802662 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_customers
[0m19:21:15.818697 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:21:15.818697 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_customers
[0m19:21:15.850574 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_customers"
[0m19:21:15.866351 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_customers"
[0m19:21:15.866351 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_customers"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_customers
         as
        (WITH customers_cleaning AS (
    SELECT 
        DISTINCT
        CUSTOMER_ID,
        COMPANY,
        CUSTOMERNAME AS CUSTOMER_NAME
    FROM de_mini_project.raw.customers
    WHERE 
        CUSTOMER_ID IS NOT NULL
        AND COMPANY IS NOT NULL
        AND CUSTOMERNAME IS NOT NULL
)
SELECT 
    cc.CUSTOMER_ID, 
    cc.COMPANY,
    cc.CUSTOMER_NAME,
    cr.REGION, 
    cr.COUNTRY 
FROM customers_cleaning cc
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON cc.CUSTOMER_ID = cr.customer_id
        );
[0m19:21:15.866351 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:17.211532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.343 seconds
[0m19:21:17.243590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165288A96A0>]}
[0m19:21:17.244590 [info ] [Thread-1 (]: 1 of 11 OK created sql table model staging.stg_customers ....................... [[32mSUCCESS 1[0m in 1.44s]
[0m19:21:17.245596 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_customers
[0m19:21:17.246556 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_products
[0m19:21:17.246556 [info ] [Thread-1 (]: 2 of 11 START sql table model staging.stg_products ............................. [RUN]
[0m19:21:17.247556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_customers, now model.DE_MINI_PROJECT.stg_products)
[0m19:21:17.248556 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_products
[0m19:21:17.252830 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_products"
[0m19:21:17.253794 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_products
[0m19:21:17.258107 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_products"
[0m19:21:17.260110 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_products"
[0m19:21:17.261108 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_products"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_products
         as
        (WITH products_cleaning AS (
    SELECT DISTINCT 
         product_id,
         product_family, 
         product_sub_family 
    FROM de_mini_project.raw.products
    WHERE product_id IS NOT NULL
      AND PRODUCT_Family IS NOT NULL
      AND product_sub_family IS NOT NULL
)
SELECT * FROM products_cleaning
        );
[0m19:21:18.044495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m19:21:18.046504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165362AEB40>]}
[0m19:21:18.046504 [info ] [Thread-1 (]: 2 of 11 OK created sql table model staging.stg_products ........................ [[32mSUCCESS 1[0m in 0.80s]
[0m19:21:18.048510 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_products
[0m19:21:18.048510 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.stg_transactions
[0m19:21:18.048510 [info ] [Thread-1 (]: 3 of 11 START sql table model staging.stg_transactions ......................... [RUN]
[0m19:21:18.048510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_products, now model.DE_MINI_PROJECT.stg_transactions)
[0m19:21:18.048510 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.stg_transactions
[0m19:21:18.048510 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.stg_transactions"
[0m19:21:18.048510 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.stg_transactions
[0m19:21:18.061809 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.stg_transactions"
[0m19:21:18.064883 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.stg_transactions"
[0m19:21:18.064883 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT.staging.stg_transactions
         as
        (WITH transaction_cleaning AS (
    SELECT DISTINCT 
    CUSTOMER_ID,
    product_id,
    payment_month AS payment_date,
    revenue_type,
    revenue,
    quantity
    FROM de_mini_project.raw.transactions
    WHERE CUSTOMER_ID IS NOT NULL
      AND product_id IS NOT NULL
      AND payment_date IS NOT NULL
      AND revenue_type IS NOT NULL
      AND revenue IS NOT NULL
      AND quantity IS NOT NULL
      AND dimension_1 IS NOT NULL
      AND dimension_2 IS NOT NULL
      AND dimension_3 IS NOT NULL
      AND dimension_4 IS NOT NULL
      AND dimension_5 IS NOT NULL
      AND dimension_6 IS NOT NULL
      AND dimension_7 IS NOT NULL
      AND dimension_8 IS NOT NULL
      AND dimension_9 IS NOT NULL
      AND dimension_10 IS NOT NULL
      AND companies IS NOT NULL
)
SELECT * FROM transaction_cleaning
        );
[0m19:21:18.708403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m19:21:18.723875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537C22150>]}
[0m19:21:18.723875 [info ] [Thread-1 (]: 3 of 11 OK created sql table model staging.stg_transactions .................... [[32mSUCCESS 1[0m in 0.68s]
[0m19:21:18.723875 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.stg_transactions
[0m19:21:18.723875 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.intermediate_customers
[0m19:21:18.723875 [info ] [Thread-1 (]: 4 of 11 START sql table model intermediate.intermediate_customers .............. [RUN]
[0m19:21:18.723875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.stg_transactions, now model.DE_MINI_PROJECT.intermediate_customers)
[0m19:21:18.723875 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.intermediate_customers
[0m19:21:18.723875 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m19:21:18.723875 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.intermediate_customers
[0m19:21:18.735752 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.intermediate_customers"
[0m19:21:18.737762 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.intermediate_customers"
[0m19:21:18.739549 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.intermediate_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.intermediate_customers"} */
create or replace transient table DE_MINI_PROJECT.intermediate.intermediate_customers
         as
        (WITH intermediate_customers AS (
    SELECT 
        CUSTOMER_ID,
        COMPANY,
        CUSTOMER_NAME
    FROM DE_MINI_PROJECT.staging.stg_customers
)
SELECT 
    c.CUSTOMER_ID,
    c.COMPANY,
    c.CUSTOMER_NAME,
    cr.COUNTRY,
    cr.REGION
FROM intermediate_customers c
JOIN DE_MINI_PROJECT.RAW.country_region cr
    ON c.CUSTOMER_ID = cr.customer_id
        );
[0m19:21:19.266048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m19:21:19.269056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537D20A70>]}
[0m19:21:19.270050 [info ] [Thread-1 (]: 4 of 11 OK created sql table model intermediate.intermediate_customers ......... [[32mSUCCESS 1[0m in 0.55s]
[0m19:21:19.272050 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.intermediate_customers
[0m19:21:19.272050 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi1
[0m19:21:19.273050 [info ] [Thread-1 (]: 5 of 11 START sql table model mart.kpi1 ........................................ [RUN]
[0m19:21:19.274049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.intermediate_customers, now model.DE_MINI_PROJECT.kpi1)
[0m19:21:19.274049 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi1
[0m19:21:19.278039 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi1"
[0m19:21:19.278039 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi1
[0m19:21:19.278039 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi1"
[0m19:21:19.287594 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi1"
[0m19:21:19.287594 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi1"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi1
         as
        (WITH customers_data AS (
    SELECT
        payment_date,
        customer_id,
        MIN(payment_date) OVER (PARTITION BY customer_id) AS first_purchase_date,
        MAX(payment_date) OVER (PARTITION BY customer_id) AS last_purchase_date
    FROM DE_MINI_PROJECT.staging.stg_transactions  
    JOIN DE_MINI_PROJECT.staging.stg_customers USING (customer_id)
),
new_and_churned_customers AS (
    SELECT
        payment_date,
        COUNT(DISTINCT CASE WHEN first_purchase_date = payment_date THEN customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_date = payment_date AND first_purchase_date != last_purchase_date THEN customer_id END) AS churned_customers
    FROM customers_data
    GROUP BY payment_date
    ORDER BY payment_date
)
SELECT * FROM new_and_churned_customers
        );
[0m19:21:20.030210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m19:21:20.036229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537D47890>]}
[0m19:21:20.037229 [info ] [Thread-1 (]: 5 of 11 OK created sql table model mart.kpi1 ................................... [[32mSUCCESS 1[0m in 0.76s]
[0m19:21:20.040163 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi1
[0m19:21:20.042159 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi2
[0m19:21:20.043162 [info ] [Thread-1 (]: 6 of 11 START sql table model mart.kpi2 ........................................ [RUN]
[0m19:21:20.046691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi1, now model.DE_MINI_PROJECT.kpi2)
[0m19:21:20.046691 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi2
[0m19:21:20.061406 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi2"
[0m19:21:20.063420 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi2
[0m19:21:20.069462 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi2"
[0m19:21:20.074996 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi2"
[0m19:21:20.074996 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi2"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi2
         as
        (WITH customer_product_activity AS (
    SELECT 
        t.CUSTOMER_ID,
        t.PRODUCT_ID,
        DATE_TRUNC('MONTH', t.payment_date) AS transaction_month
    FROM DE_MINI_PROJECT.staging.stg_transactions t
),
cross_sell_customers AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS products_purchased
    FROM customer_product_activity
    GROUP BY CUSTOMER_ID
    HAVING COUNT(DISTINCT PRODUCT_ID) > 1 -- Customers who purchased multiple products
),
product_churn_customers AS (
    SELECT 
        cpa.CUSTOMER_ID,
        cpa.PRODUCT_ID,
        MAX(cpa.transaction_month) AS last_purchase_month,
        COUNT(*) AS total_purchases
    FROM customer_product_activity cpa
    LEFT JOIN customer_product_activity next_month_activity
        ON cpa.CUSTOMER_ID = next_month_activity.CUSTOMER_ID
        AND cpa.PRODUCT_ID = next_month_activity.PRODUCT_ID
        AND DATEADD(MONTH, 1, cpa.transaction_month) = next_month_activity.transaction_month
    WHERE next_month_activity.CUSTOMER_ID IS NULL -- No purchases in the next month
    GROUP BY cpa.CUSTOMER_ID, cpa.PRODUCT_ID
),
churned_products_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS churned_products
    FROM product_churn_customers
    GROUP BY CUSTOMER_ID
)
SELECT 
    DISTINCT
    csc.CUSTOMER_ID,
    csc.products_purchased,
    COALESCE(cpc.churned_products, 0) AS churned_products,
    pcc.PRODUCT_ID AS churned_product_id,
    pcc.last_purchase_month
FROM cross_sell_customers csc
LEFT JOIN product_churn_customers pcc
    ON csc.CUSTOMER_ID = pcc.CUSTOMER_ID
LEFT JOIN churned_products_count cpc
    ON csc.CUSTOMER_ID = cpc.CUSTOMER_ID
ORDER BY csc.products_purchased DESC, pcc.last_purchase_month DESC
        );
[0m19:21:20.835703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m19:21:20.851407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537D15190>]}
[0m19:21:20.851407 [info ] [Thread-1 (]: 6 of 11 OK created sql table model mart.kpi2 ................................... [[32mSUCCESS 1[0m in 0.80s]
[0m19:21:20.859010 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi2
[0m19:21:20.859010 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:21:20.861034 [info ] [Thread-1 (]: 7 of 11 START sql table model mart.kpi3 ........................................ [RUN]
[0m19:21:20.861034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi2, now model.DE_MINI_PROJECT.kpi3)
[0m19:21:20.866866 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:21:20.876963 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:21:20.878977 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:21:20.882750 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:21:20.882750 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:21:20.882750 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        DATE_TRUNC('MONTH', payment_date) AS transaction_month,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID, transaction_month
),
existing_customers_revenue AS (
    SELECT 
        cr.transaction_month,
        cr.CUSTOMER_ID,
        cr.total_revenue AS current_revenue,
        COALESCE(lm.total_revenue, 0) AS last_month_revenue
    FROM customer_revenue cr
    LEFT JOIN customer_revenue lm
        ON cr.CUSTOMER_ID = lm.CUSTOMER_ID
        AND cr.transaction_month = DATEADD(MONTH, 1, lm.transaction_month)
),
nrr_grr_last_month AS (
    SELECT 
        transaction_month,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue 
    FROM existing_customers_revenue
    GROUP BY transaction_month
),
nrr_grr_ltm AS (
    SELECT 
        DATE_TRUNC('YEAR', transaction_month) AS fiscal_year,
        SUM(last_month_revenue) AS total_last_month_revenue,
        SUM(current_revenue) AS total_current_revenue,
        SUM(CASE 
            WHEN current_revenue < last_month_revenue THEN current_revenue
            ELSE last_month_revenue
        END) AS total_grr_revenue
    FROM existing_customers_revenue
    WHERE transaction_month >= DATEADD(MONTH, -12, CURRENT_DATE) -- Last 12 months
    GROUP BY DATE_TRUNC('YEAR', transaction_month)
),
final_nrr_grr AS (
    SELECT 
        'Last Month' AS period_type,
        transaction_month AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_last_month
    UNION ALL
    SELECT 
        'Last 12 Months (LTM)' AS period_type,
        fiscal_year AS period,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_current_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS NRR,
        CASE 
            WHEN total_last_month_revenue > 0 THEN ROUND((total_grr_revenue / total_last_month_revenue) * 100, 2)
            ELSE 0
        END AS GRR
    FROM nrr_grr_ltm
)
SELECT 
    period_type,
    period,
    NRR,
    GRR
FROM final_nrr_grr
ORDER BY period_type, period
        );
[0m19:21:21.525410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m19:21:21.528448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537BF3D40>]}
[0m19:21:21.528448 [info ] [Thread-1 (]: 7 of 11 OK created sql table model mart.kpi3 ................................... [[32mSUCCESS 1[0m in 0.67s]
[0m19:21:21.528448 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:21:21.528448 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi4
[0m19:21:21.528448 [info ] [Thread-1 (]: 8 of 11 START sql table model mart.kpi4 ........................................ [RUN]
[0m19:21:21.528448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi3, now model.DE_MINI_PROJECT.kpi4)
[0m19:21:21.544300 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi4
[0m19:21:21.553412 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi4"
[0m19:21:21.557447 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi4
[0m19:21:21.560047 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi4"
[0m19:21:21.560047 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi4"
[0m19:21:21.560047 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi4"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi4
         as
        (-- WITH monthly_revenue AS (
--     SELECT
--         DATE_TRUNC('MONTH', payment_date) AS month,
--         SUM(revenue) AS total_revenue
--     FROM
--         DE_MINI_PROJECT.staging.stg_transactions
--     WHERE
--         REVENUE_TYPE = 1
--     GROUP BY
--         month
-- )
-- SELECT
--     month,
--     total_revenue,
--     LAG(total_revenue) OVER (ORDER BY month) AS previous,
--     CASE 
--         WHEN LAG(total_revenue) OVER (ORDER BY month) > total_revenue THEN 
--             LAG(total_revenue) OVER (ORDER BY month) - total_revenue
--         ELSE 
--             0
--     END AS revenue_lost
-- FROM
--     monthly_revenue
-- ORDER BY
--     month
 

 WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_DATE) AS PREV_REVENUE
FROM DE_MINI_PROJECT.staging.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_DATE,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_DATE,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_DATE 
ORDER BY Revenue_Loss DESC
        );
[0m19:21:22.162853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m19:21:22.164188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537D47050>]}
[0m19:21:22.166338 [info ] [Thread-1 (]: 8 of 11 OK created sql table model mart.kpi4 ................................... [[32mSUCCESS 1[0m in 0.64s]
[0m19:21:22.166338 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi4
[0m19:21:22.166338 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi5
[0m19:21:22.166338 [info ] [Thread-1 (]: 9 of 11 START sql table model mart.kpi5 ........................................ [RUN]
[0m19:21:22.166338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi4, now model.DE_MINI_PROJECT.kpi5)
[0m19:21:22.166338 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi5
[0m19:21:22.166338 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi5"
[0m19:21:22.166338 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi5
[0m19:21:22.166338 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi5"
[0m19:21:22.182047 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi5"
[0m19:21:22.182047 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi5"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi5
         as
        (WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM
    new_customers_by_fy
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:21:22.702090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m19:21:22.705121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537CF59A0>]}
[0m19:21:22.706088 [info ] [Thread-1 (]: 9 of 11 OK created sql table model mart.kpi5 ................................... [[32mSUCCESS 1[0m in 0.54s]
[0m19:21:22.707087 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi5
[0m19:21:22.707087 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi6
[0m19:21:22.708088 [info ] [Thread-1 (]: 10 of 11 START sql table model mart.kpi6 ....................................... [RUN]
[0m19:21:22.709088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi5, now model.DE_MINI_PROJECT.kpi6)
[0m19:21:22.710087 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi6
[0m19:21:22.715673 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi6"
[0m19:21:22.717638 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi6
[0m19:21:22.731572 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi6"
[0m19:21:22.734572 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi6"
[0m19:21:22.735576 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi6"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi6
         as
        (WITH product_revenue AS (
    SELECT 
        p.PRODUCT_ID,
        SUM(t.revenue) AS total_products_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_products p 
        ON t.product_id = p.product_id
    GROUP BY p.PRODUCT_ID
),
ranked_products AS (
    SELECT 
        PRODUCT_ID,
        total_products_revenue,
        DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
    FROM product_revenue
)
SELECT * 
FROM ranked_products
ORDER BY revenue_rank

















-- WITH product_revenue AS (
--     SELECT 
--         PRODUCT_ID, 
--         SUM(revenue) AS total_products_revenue
--     FROM DE_MINI_PROJECT.staging.stg_transactions
--     GROUP BY PRODUCT_ID
-- ),
-- ranked_products AS (
--     SELECT 
--         PRODUCT_ID,
--         total_products_revenue,
--         DENSE_RANK() OVER (ORDER BY total_products_revenue DESC) AS revenue_rank
--     FROM product_revenue
-- )
-- SELECT 
--     rc.PRODUCT_ID,
--     rp.PRODUCT_FAMILY,
--     rc.total_products_revenue,
--     rc.revenue_rank
-- FROM ranked_products rc
-- JOIN PRODUCT_REVENUE rp
--     ON rc.product_id = rp.product_id
-- ORDER BY revenue_rank


-- WITH int_rank_products AS(
-- SELECT
--     p.product_id,
--     SUM(t.revenue) AS total_revenue,
--     RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS rank
-- FROM
--     DE_MINI_PROJECT.staging.stg_transactions t
-- JOIN
--     DE_MINI_PROJECT.staging.stg_products p ON t.product_id = p.product_id
-- GROUP BY
--     p.product_id
-- ORDER BY
--     total_revenue DESC
-- )
-- SELECT * FROM int_rank_products
        );
[0m19:21:23.365256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m19:21:23.365256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537D8BEC0>]}
[0m19:21:23.365256 [info ] [Thread-1 (]: 10 of 11 OK created sql table model mart.kpi6 .................................. [[32mSUCCESS 1[0m in 0.66s]
[0m19:21:23.365256 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi6
[0m19:21:23.365256 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi7
[0m19:21:23.365256 [info ] [Thread-1 (]: 11 of 11 START sql table model mart.kpi7 ....................................... [RUN]
[0m19:21:23.365256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.DE_MINI_PROJECT.kpi6, now model.DE_MINI_PROJECT.kpi7)
[0m19:21:23.365256 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi7
[0m19:21:23.365256 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi7"
[0m19:21:23.365256 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi7
[0m19:21:23.381684 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi7"
[0m19:21:23.381684 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi7"
[0m19:21:23.381684 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi7"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi7
         as
        (WITH customer_revenue AS (
    SELECT 
        CUSTOMER_ID,
        SUM(revenue) AS total_revenue
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY CUSTOMER_ID
),
ranked_customers AS (
    SELECT 
        CUSTOMER_ID,
        total_revenue,
        RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
SELECT 
    rc.CUSTOMER_ID,
    rc.total_revenue,
    rc.revenue_rank,
    cc.CUSTOMER_NAME
FROM ranked_customers rc
JOIN DE_MINI_PROJECT.staging.stg_customers cc
    ON rc.customer_id = cc.customer_id
ORDER BY revenue_rank
        );
[0m19:21:24.041550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m19:21:24.041550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82dcbefa-17af-49e9-a24d-d82a5f0aaede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016537C31760>]}
[0m19:21:24.041550 [info ] [Thread-1 (]: 11 of 11 OK created sql table model mart.kpi7 .................................. [[32mSUCCESS 1[0m in 0.68s]
[0m19:21:24.041550 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi7
[0m19:21:24.041550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:24.041550 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:21:24.041550 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:21:24.364468 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m19:21:24.364468 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m19:21:24.691284 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi7' was left open.
[0m19:21:24.692284 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi7: Close
[0m19:21:25.010634 [info ] [MainThread]: 
[0m19:21:25.011593 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 12.78 seconds (12.78s).
[0m19:21:25.014594 [debug] [MainThread]: Command end result
[0m19:21:25.045739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:21:25.050765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:21:25.059809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:21:25.059809 [info ] [MainThread]: 
[0m19:21:25.060807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:21:25.061772 [info ] [MainThread]: 
[0m19:21:25.062772 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:21:25.065230 [debug] [MainThread]: Command `dbt run` succeeded at 19:21:25.064774 after 15.96 seconds
[0m19:21:25.065655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016528F5F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165292E8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165271C8140>]}
[0m19:21:25.065655 [debug] [MainThread]: Flushing usage events
[0m19:21:26.518005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:32.441106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154C0167110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154BFF25490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154C0167D40>]}


============================== 19:35:32.446767 | 5be56d97-c440-42f1-8328-e89a808d8aa8 ==============================
[0m19:35:32.446767 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:35:32.447776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m kpi3', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:36.790144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154BF800C20>]}
[0m19:35:36.869052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154CB956720>]}
[0m19:35:36.869052 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:35:37.621725 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:35:39.348638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:39.348638 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m19:35:39.692233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154CD39A1E0>]}
[0m19:35:39.786458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:35:39.809062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:35:39.851344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154CD33E870>]}
[0m19:35:39.853353 [info ] [MainThread]: Found 1 seed, 11 models, 3 sources, 473 macros
[0m19:35:39.853353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154CD391C10>]}
[0m19:35:39.853353 [info ] [MainThread]: 
[0m19:35:39.853353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:39.853353 [info ] [MainThread]: 
[0m19:35:39.859621 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:35:39.860559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:35:43.167135 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:35:43.167135 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:35:43.167135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:44.588159 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.429 seconds
[0m19:35:44.605738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_mart'
[0m19:35:44.617775 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:35:44.617775 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:35:44.618779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:45.554134 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.943 seconds
[0m19:35:45.554134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m19:35:45.554134 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:35:45.554134 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:35:45.751726 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.187 seconds
[0m19:35:45.751726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_staging)
[0m19:35:45.751726 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:35:45.751726 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:35:45.945259 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.193 seconds
[0m19:35:45.960891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_RAW)
[0m19:35:45.964966 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:35:45.966979 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:35:46.174885 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.207 seconds
[0m19:35:46.178946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154CE73AEA0>]}
[0m19:35:46.181954 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:35:46.181954 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m19:35:46.182955 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m19:35:46.183983 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:35:46.194069 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:35:46.196040 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:35:46.223767 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:35:46.239782 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:35:46.239782 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH BASE AS (
    SELECT
        CUSTOMER_ID,
        PAYMENT_DATE,
        CUSTOMER_NAME,
        DATEADD(month,-3,PAYMENT_DATE) AS PREVIOUS_MONTH,
        COUNT(DISTINCT PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        CUSTOMER_ID,
        PAYMENT_DATE,
        CUSTOMER_NAME
    ORDER BY CUSTOMER_ID,PAYMENT_DATE,CUSTOMER_NAME
),BASE2 AS (
    SELECT
        CUSTOMER_ID,
        PAYMENT_DATE,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        CUSTOMER_ID,
        PAYMENT_DATE
),max_payment_month as (
    select
    max(payment_month) as max_payment_month
    from DE_MINI_PROJECT.staging.stg_transactions
),
product_churn AS (
    SELECT
        LM.CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN PAYMENT_DATE < DATEADD(MONTH,-3,max_payment_month) THEN PRODUCT_ID END) AS Product_Churn
    FROM
        DE_MINI_PROJECT.staging.stg_transactions AS LM join max_payment_month ON 1=1
    GROUP BY
        LM.CUSTOMER_NAME
),
 FINAL AS (
    SELECT
        BASE.CUSTOMER_NAME,
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_MONTH,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
        Product_Churn
    FROM BASE LEFT JOIN BASE2 ON BASE.CUSTOMER_ID=BASE2.CUSTOMER_ID AND BASE.PREVIOUS_MONTH=BASE2.PAYMENT_MONTH LEFT JOIN PRODUCT_CHURN ON BASE.CUSTOMER_NAME=PRODUCT_CHURN.CUSTOMER_NAME
    ORDER BY CUSTOMER_ID,PAYMENT_DATE
),FINAL2 AS (
SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    PAYMENT_DATE,
    NO_OF_PRODUCTS,
    TOTAL_REVENUE,
    PREVIOUS_MONTH,
    PREVIOUS_MONTH_REVENUE,
    NO_OF_PRODUCTS_PAST_MONTH,
    CASE
        WHEN (NO_OF_PRODUCTS-(NO_OF_PRODUCTS_PAST_MONTH-Product_Churn))>0 THEN (NO_OF_PRODUCTS-(NO_OF_PRODUCTS_PAST_MONTH-Product_Churn))
        ELSE 0
    END AS CROSS_SELL_IN_PRODUCTS,
    CASE
        WHEN (NO_OF_PRODUCTS-(NO_OF_PRODUCTS_PAST_MONTH-Product_Churn))>0 THEN (TOTAL_REVENUE-PREVIOUS_MONTH_REVENUE)
        ELSE 0
    END AS CROSS_SELL_IN_REVENUE,
    Product_Churn AS PRODUCT_CHURN
FROM
FINAL
),FINAL3 AS (
    SELECT
    *,
    RANK() OVER(ORDER BY CROSS_SELL_IN_REVENUE DESC) AS CROSS_SELL_RANK,
    RANK() OVER(ORDER BY PRODUCT_CHURN DESC) AS PRODUCT_CHURN_RANK
    FROM FINAL2
)
SELECT
*
FROM
FINAL3
ORDER BY CROSS_SELL_RANK,PRODUCT_CHURN_RANK
        );
[0m19:35:46.241323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:47.344795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ed-3201-7e57-000c-3d5a000257ca
[0m19:35:47.349168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'CUSTOMER_NAME'
[0m19:35:47.366309 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m19:35:47.368318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be56d97-c440-42f1-8328-e89a808d8aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154BF611940>]}
[0m19:35:47.368318 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 1.18s]
[0m19:35:47.368318 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:35:47.368318 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m19:35:47.368318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:47.368318 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:35:47.368318 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:35:47.701913 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_RAW' was left open.
[0m19:35:47.701913 [debug] [MainThread]: On list_DE_MINI_PROJECT_RAW: Close
[0m19:35:48.022778 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m19:35:48.022778 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m19:35:48.356498 [info ] [MainThread]: 
[0m19:35:48.372316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.50 seconds (8.50s).
[0m19:35:48.372316 [debug] [MainThread]: Command end result
[0m19:35:48.408720 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:35:48.408720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:35:48.424994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:35:48.424994 [info ] [MainThread]: 
[0m19:35:48.424994 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:35:48.424994 [info ] [MainThread]: 
[0m19:35:48.424994 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m19:35:48.424994 [info ] [MainThread]: 
[0m19:35:48.424994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:35:48.424994 [debug] [MainThread]: Command `dbt run` failed at 19:35:48.424994 after 16.27 seconds
[0m19:35:48.424994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154BFB11FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154BFB12960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154BDEEFFB0>]}
[0m19:35:48.424994 [debug] [MainThread]: Flushing usage events
[0m19:35:49.343797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:51.177378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F061174D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F06116BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F06115760>]}


============================== 19:36:51.177979 | 87c86dad-fb33-4c27-8ced-4a9c5a945a82 ==============================
[0m19:36:51.177979 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:36:51.184873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi3', 'send_anonymous_usage_stats': 'True'}
[0m19:36:52.472069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F12C7CB00>]}
[0m19:36:52.551401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F12D71E80>]}
[0m19:36:52.551401 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:36:53.154852 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:36:53.396950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:53.396950 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m19:36:53.734617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F1335A270>]}
[0m19:36:53.834939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:36:53.834939 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:36:53.884851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F133068D0>]}
[0m19:36:53.884851 [info ] [MainThread]: Found 1 seed, 11 models, 3 sources, 473 macros
[0m19:36:53.884851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F13338B90>]}
[0m19:36:53.884851 [info ] [MainThread]: 
[0m19:36:53.884851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:53.884851 [info ] [MainThread]: 
[0m19:36:53.891498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:53.891498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:36:54.014846 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:36:54.014846 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:36:54.014846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:55.388143 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.372 seconds
[0m19:36:55.404228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m19:36:55.420051 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:36:55.420051 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:36:55.420051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:56.447418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.020 seconds
[0m19:36:56.457397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_intermediate)
[0m19:36:56.459419 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:36:56.459419 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:36:56.678098 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.216 seconds
[0m19:36:56.678098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_intermediate, now list_DE_MINI_PROJECT_RAW)
[0m19:36:56.678098 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:36:56.678098 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:36:56.868318 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.187 seconds
[0m19:36:56.868318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_mart)
[0m19:36:56.883970 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:36:56.883970 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:36:57.108677 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.224 seconds
[0m19:36:57.120774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F147A0FB0>]}
[0m19:36:57.122995 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:36:57.122995 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m19:36:57.122995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m19:36:57.122995 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:36:57.143595 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:36:57.144077 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:36:57.183243 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:36:57.188239 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:36:57.189244 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH BASE AS (
    SELECT
        t.CUSTOMER_ID,
        c.CUSTOMER_NAME, -- Join with stg_customers to get CUSTOMER_NAME
        t.PAYMENT_DATE,
        DATEADD(month, -3, t.PAYMENT_DATE) AS PREVIOUS_MONTH,
        COUNT(DISTINCT t.PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(t.TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_customers c -- Join with stg_customers
        ON t.CUSTOMER_ID = c.CUSTOMER_ID
    GROUP BY
        t.CUSTOMER_ID,
        c.CUSTOMER_NAME,
        t.PAYMENT_DATE
), BASE2 AS (
    SELECT
        CUSTOMER_ID,
        PAYMENT_DATE,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        CUSTOMER_ID,
        PAYMENT_DATE
), max_payment_month AS (
    SELECT
        MAX(PAYMENT_DATE) AS max_payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
), product_churn AS (
    SELECT
        c.CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN t.PAYMENT_DATE < DATEADD(MONTH, -3, max_payment_month) THEN t.PRODUCT_ID END) AS Product_Churn
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_customers c -- Join with stg_customers
        ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN max_payment_month ON 1=1
    GROUP BY
        c.CUSTOMER_NAME
), FINAL AS (
    SELECT
        BASE.CUSTOMER_NAME,
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_DATE,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
        Product_Churn
    FROM BASE
    LEFT JOIN BASE2
        ON BASE.CUSTOMER_ID = BASE2.CUSTOMER_ID
        AND BASE.PREVIOUS_MONTH = BASE2.PAYMENT_DATE
    LEFT JOIN product_churn
        ON BASE.CUSTOMER_NAME = product_churn.CUSTOMER_NAME
), FINAL2 AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        PAYMENT_DATE,
        NO_OF_PRODUCTS,
        TOTAL_REVENUE,
        PREVIOUS_MONTH,
        PREVIOUS_MONTH_REVENUE,
        NO_OF_PRODUCTS_PAST_MONTH,
        CASE
            WHEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn)) > 0 THEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn))
            ELSE 0
        END AS CROSS_SELL_IN_PRODUCTS,
        CASE
            WHEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn)) > 0 THEN (TOTAL_REVENUE - PREVIOUS_MONTH_REVENUE)
            ELSE 0
        END AS CROSS_SELL_IN_REVENUE,
        Product_Churn AS PRODUCT_CHURN
    FROM FINAL
), FINAL3 AS (
    SELECT
        *,
        RANK() OVER (ORDER BY CROSS_SELL_IN_REVENUE DESC) AS CROSS_SELL_RANK,
        RANK() OVER (ORDER BY PRODUCT_CHURN DESC) AS PRODUCT_CHURN_RANK
    FROM FINAL2
)
SELECT
    *
FROM
    FINAL3
ORDER BY CROSS_SELL_RANK, PRODUCT_CHURN_RANK;
[0m19:36:57.189244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:58.088973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ee-3201-7e57-000c-3d5a000257da
[0m19:36:58.088973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 90 at position 44 unexpected ';'.
[0m19:36:58.088973 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 44 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m19:36:58.088973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87c86dad-fb33-4c27-8ced-4a9c5a945a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F055C19D0>]}
[0m19:36:58.088973 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 0.97s]
[0m19:36:58.088973 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:36:58.104931 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 44 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m19:36:58.104931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:58.104931 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:36:58.104931 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:36:58.419646 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_mart' was left open.
[0m19:36:58.419646 [debug] [MainThread]: On list_DE_MINI_PROJECT_mart: Close
[0m19:36:58.768618 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m19:36:58.768618 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m19:36:59.474055 [info ] [MainThread]: 
[0m19:36:59.489898 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m19:36:59.489898 [debug] [MainThread]: Command end result
[0m19:36:59.520599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:36:59.520599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:36:59.531180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:36:59.531180 [info ] [MainThread]: 
[0m19:36:59.531180 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:36:59.531180 [info ] [MainThread]: 
[0m19:36:59.531180 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 44 unexpected ';'.
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m19:36:59.531180 [info ] [MainThread]: 
[0m19:36:59.531180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:36:59.531180 [debug] [MainThread]: Command `dbt run` failed at 19:36:59.531180 after 8.68 seconds
[0m19:36:59.531180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F0580C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F03E9FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F03E9FE00>]}
[0m19:36:59.540553 [debug] [MainThread]: Flushing usage events
[0m19:37:00.804785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:08.262086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219365A10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219365A35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219365A12E0>]}


============================== 19:37:08.262086 | 529da675-826c-48bd-9238-de8cf25aec0b ==============================
[0m19:37:08.262086 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:37:08.262086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m kpi3', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:09.454306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219431AECF0>]}
[0m19:37:09.533967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194326BEC0>]}
[0m19:37:09.533967 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:37:10.102973 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:37:10.348952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:10.348952 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m19:37:10.681795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194376D760>]}
[0m19:37:10.788387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:37:10.790396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:37:10.818466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194386A8D0>]}
[0m19:37:10.834555 [info ] [MainThread]: Found 1 seed, 11 models, 3 sources, 473 macros
[0m19:37:10.834555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219427F0FB0>]}
[0m19:37:10.837562 [info ] [MainThread]: 
[0m19:37:10.837562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:10.837562 [info ] [MainThread]: 
[0m19:37:10.837562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:37:10.837562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:37:10.956116 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:37:10.956116 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:37:10.956116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:12.324464 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.368 seconds
[0m19:37:12.339635 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_RAW'
[0m19:37:12.355645 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:37:12.355645 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:37:12.355645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:13.309337 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.962 seconds
[0m19:37:13.309337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_staging)
[0m19:37:13.325085 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:37:13.325085 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:37:13.518666 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.192 seconds
[0m19:37:13.518666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m19:37:13.534506 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:37:13.534506 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:37:13.726276 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.194 seconds
[0m19:37:13.742089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_intermediate)
[0m19:37:13.742089 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:37:13.742089 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:37:13.941623 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.200 seconds
[0m19:37:13.941623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021944E33350>]}
[0m19:37:13.957561 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:37:13.957561 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m19:37:13.957561 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m19:37:13.957561 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:37:13.972432 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:37:13.973440 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:37:14.013407 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:37:14.018416 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:37:14.019382 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH BASE AS (
    SELECT
        t.CUSTOMER_ID,
        c.CUSTOMER_NAME, -- Join with stg_customers to get CUSTOMER_NAME
        t.PAYMENT_DATE,
        DATEADD(month, -3, t.PAYMENT_DATE) AS PREVIOUS_MONTH,
        COUNT(DISTINCT t.PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(t.TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_customers c -- Join with stg_customers
        ON t.CUSTOMER_ID = c.CUSTOMER_ID
    GROUP BY
        t.CUSTOMER_ID,
        c.CUSTOMER_NAME,
        t.PAYMENT_DATE
), BASE2 AS (
    SELECT
        CUSTOMER_ID,
        PAYMENT_DATE,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        CUSTOMER_ID,
        PAYMENT_DATE
), max_payment_month AS (
    SELECT
        MAX(PAYMENT_DATE) AS max_payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
), product_churn AS (
    SELECT
        c.CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN t.PAYMENT_DATE < DATEADD(MONTH, -3, max_payment_month) THEN t.PRODUCT_ID END) AS Product_Churn
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_customers c -- Join with stg_customers
        ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN max_payment_month ON 1=1
    GROUP BY
        c.CUSTOMER_NAME
), FINAL AS (
    SELECT
        BASE.CUSTOMER_NAME,
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_DATE,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
        Product_Churn
    FROM BASE
    LEFT JOIN BASE2
        ON BASE.CUSTOMER_ID = BASE2.CUSTOMER_ID
        AND BASE.PREVIOUS_MONTH = BASE2.PAYMENT_DATE
    LEFT JOIN product_churn
        ON BASE.CUSTOMER_NAME = product_churn.CUSTOMER_NAME
), FINAL2 AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        PAYMENT_DATE,
        NO_OF_PRODUCTS,
        TOTAL_REVENUE,
        PREVIOUS_MONTH,
        PREVIOUS_MONTH_REVENUE,
        NO_OF_PRODUCTS_PAST_MONTH,
        CASE
            WHEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn)) > 0 THEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn))
            ELSE 0
        END AS CROSS_SELL_IN_PRODUCTS,
        CASE
            WHEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn)) > 0 THEN (TOTAL_REVENUE - PREVIOUS_MONTH_REVENUE)
            ELSE 0
        END AS CROSS_SELL_IN_REVENUE,
        Product_Churn AS PRODUCT_CHURN
    FROM FINAL
), FINAL3 AS (
    SELECT
        *,
        RANK() OVER (ORDER BY CROSS_SELL_IN_REVENUE DESC) AS CROSS_SELL_RANK,
        RANK() OVER (ORDER BY PRODUCT_CHURN DESC) AS PRODUCT_CHURN_RANK
    FROM FINAL2
)
SELECT
    *
FROM
    FINAL3
ORDER BY CROSS_SELL_RANK, PRODUCT_CHURN_RANK
        );
[0m19:37:14.019382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:14.959928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ef-3201-7db6-000c-3d5a0002640e
[0m19:37:14.959928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 12
invalid identifier 'T.TOTAL_REVENUE'
[0m19:37:14.978247 [debug] [Thread-1 (]: Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 10 at position 12
  invalid identifier 'T.TOTAL_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m19:37:14.980248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '529da675-826c-48bd-9238-de8cf25aec0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021944F16D20>]}
[0m19:37:14.981212 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.kpi3 ................................ [[31mERROR[0m in 1.02s]
[0m19:37:14.982455 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:37:14.983497 [debug] [Thread-4 (]: Marking all children of 'model.DE_MINI_PROJECT.kpi3' to be skipped because of status 'error'.  Reason: Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 10 at position 12
  invalid identifier 'T.TOTAL_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql.
[0m19:37:14.985511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:14.985511 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:37:14.986498 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:37:15.304807 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:37:15.304807 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:37:15.640609 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m19:37:15.640609 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m19:37:15.964087 [info ] [MainThread]: 
[0m19:37:15.964087 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m19:37:15.964087 [debug] [MainThread]: Command end result
[0m19:37:16.001637 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:37:16.002602 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:37:16.012410 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:37:16.013409 [info ] [MainThread]: 
[0m19:37:16.014413 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:37:16.014413 [info ] [MainThread]: 
[0m19:37:16.014413 [error] [MainThread]:   Database Error in model kpi3 (models\mart\kpi3.sql)
  000904 (42000): SQL compilation error: error line 10 at position 12
  invalid identifier 'T.TOTAL_REVENUE'
  compiled code at target\run\DE_MINI_PROJECT\models\mart\kpi3.sql
[0m19:37:16.014413 [info ] [MainThread]: 
[0m19:37:16.014413 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:37:16.020151 [debug] [MainThread]: Command `dbt run` failed at 19:37:16.014413 after 7.96 seconds
[0m19:37:16.020151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021935F8D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021934112D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021934112E10>]}
[0m19:37:16.021194 [debug] [MainThread]: Flushing usage events
[0m19:37:16.931466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:06.245389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20A0A7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20A0A6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20A0A7C80>]}


============================== 19:38:06.245389 | d9349a0c-1320-4ce2-b780-ad71f905a757 ==============================
[0m19:38:06.245389 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:38:06.245389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\BurelaSuryaPrathap\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\BurelaSuryaPrathap\\MINI_PROJECT_2\\DE_MINI_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m kpi3', 'send_anonymous_usage_stats': 'True'}
[0m19:38:07.612304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20A0EC0B0>]}
[0m19:38:07.677077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2094A6900>]}
[0m19:38:07.677077 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:38:08.301581 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:38:08.547320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:38:08.548993 [debug] [MainThread]: Partial parsing: updated file: DE_MINI_PROJECT://models\mart\kpi3.sql
[0m19:38:08.903458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A215AB78C0>]}
[0m19:38:08.998527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:38:08.998527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:38:09.053668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2172E2C30>]}
[0m19:38:09.053668 [info ] [MainThread]: Found 1 seed, 11 models, 3 sources, 473 macros
[0m19:38:09.055132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A216D309B0>]}
[0m19:38:09.057176 [info ] [MainThread]: 
[0m19:38:09.058176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:09.058176 [info ] [MainThread]: 
[0m19:38:09.059175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:38:09.061218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT'
[0m19:38:09.193035 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT"
[0m19:38:09.194029 [debug] [ThreadPool]: On list_DE_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT"} */
show terse schemas in database DE_MINI_PROJECT
    limit 10000
[0m19:38:09.194029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:10.551810 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.357 seconds
[0m19:38:10.559803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_staging'
[0m19:38:10.565845 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_staging"
[0m19:38:10.565845 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_staging"} */
show objects in DE_MINI_PROJECT.staging limit 10000;
[0m19:38:10.565845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:11.574157 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.003 seconds
[0m19:38:11.579234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_staging, now list_DE_MINI_PROJECT_mart)
[0m19:38:11.584415 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_mart"
[0m19:38:11.585452 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_mart"} */
show objects in DE_MINI_PROJECT.mart limit 10000;
[0m19:38:11.784641 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.200 seconds
[0m19:38:11.784641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_mart, now list_DE_MINI_PROJECT_RAW)
[0m19:38:11.784641 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_RAW"
[0m19:38:11.784641 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_RAW"} */
show objects in DE_MINI_PROJECT.RAW limit 10000;
[0m19:38:11.978693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.187 seconds
[0m19:38:11.982114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_RAW, now list_DE_MINI_PROJECT_intermediate)
[0m19:38:11.984123 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_intermediate"
[0m19:38:11.986131 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_intermediate"} */
show objects in DE_MINI_PROJECT.intermediate limit 10000;
[0m19:38:12.193239 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.207 seconds
[0m19:38:12.199310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2185F9100>]}
[0m19:38:12.199310 [debug] [Thread-1 (]: Began running node model.DE_MINI_PROJECT.kpi3
[0m19:38:12.199310 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi3 ......................................... [RUN]
[0m19:38:12.199310 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.DE_MINI_PROJECT.kpi3'
[0m19:38:12.199310 [debug] [Thread-1 (]: Began compiling node model.DE_MINI_PROJECT.kpi3
[0m19:38:12.211013 [debug] [Thread-1 (]: Writing injected SQL for node "model.DE_MINI_PROJECT.kpi3"
[0m19:38:12.211013 [debug] [Thread-1 (]: Began executing node model.DE_MINI_PROJECT.kpi3
[0m19:38:12.261050 [debug] [Thread-1 (]: Writing runtime sql for node "model.DE_MINI_PROJECT.kpi3"
[0m19:38:12.266046 [debug] [Thread-1 (]: Using snowflake connection "model.DE_MINI_PROJECT.kpi3"
[0m19:38:12.266046 [debug] [Thread-1 (]: On model.DE_MINI_PROJECT.kpi3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "DE_MINI_PROJECT", "target_name": "dev", "node_id": "model.DE_MINI_PROJECT.kpi3"} */
create or replace transient table DE_MINI_PROJECT.mart.kpi3
         as
        (WITH BASE AS (
    SELECT
        t.CUSTOMER_ID,
        c.CUSTOMER_NAME, -- Join with stg_customers to get CUSTOMER_NAME
        t.PAYMENT_DATE,
        DATEADD(month, -3, t.PAYMENT_DATE) AS PREVIOUS_MONTH,
        COUNT(DISTINCT t.PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(t.revenue) AS TOTAL_REVENUE -- Replace TOTAL_REVENUE with revenue or appropriate calculation
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_customers c -- Join with stg_customers
        ON t.CUSTOMER_ID = c.CUSTOMER_ID
    GROUP BY
        t.CUSTOMER_ID,
        c.CUSTOMER_NAME,
        t.PAYMENT_DATE
), BASE2 AS (
    SELECT
        CUSTOMER_ID,
        PAYMENT_DATE,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(revenue) AS TOTAL_REVENUE -- Replace TOTAL_REVENUE with revenue or appropriate calculation
    FROM DE_MINI_PROJECT.staging.stg_transactions
    GROUP BY
        CUSTOMER_ID,
        PAYMENT_DATE
), max_payment_month AS (
    SELECT
        MAX(PAYMENT_DATE) AS max_payment_month
    FROM DE_MINI_PROJECT.staging.stg_transactions
), product_churn AS (
    SELECT
        c.CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN t.PAYMENT_DATE < DATEADD(MONTH, -3, max_payment_month) THEN t.PRODUCT_ID END) AS Product_Churn
    FROM DE_MINI_PROJECT.staging.stg_transactions t
    JOIN DE_MINI_PROJECT.staging.stg_customers c -- Join with stg_customers
        ON t.CUSTOMER_ID = c.CUSTOMER_ID
    JOIN max_payment_month ON 1=1
    GROUP BY
        c.CUSTOMER_NAME
), FINAL AS (
    SELECT
        BASE.CUSTOMER_NAME,
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_DATE,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
        Product_Churn
    FROM BASE
    LEFT JOIN BASE2
        ON BASE.CUSTOMER_ID = BASE2.CUSTOMER_ID
        AND BASE.PREVIOUS_MONTH = BASE2.PAYMENT_DATE
    LEFT JOIN product_churn
        ON BASE.CUSTOMER_NAME = product_churn.CUSTOMER_NAME
), FINAL2 AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        PAYMENT_DATE,
        NO_OF_PRODUCTS,
        TOTAL_REVENUE,
        PREVIOUS_MONTH,
        PREVIOUS_MONTH_REVENUE,
        NO_OF_PRODUCTS_PAST_MONTH,
        CASE
            WHEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn)) > 0 THEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn))
            ELSE 0
        END AS CROSS_SELL_IN_PRODUCTS,
        CASE
            WHEN (NO_OF_PRODUCTS - (NO_OF_PRODUCTS_PAST_MONTH - Product_Churn)) > 0 THEN (TOTAL_REVENUE - PREVIOUS_MONTH_REVENUE)
            ELSE 0
        END AS CROSS_SELL_IN_REVENUE,
        Product_Churn AS PRODUCT_CHURN
    FROM FINAL
), FINAL3 AS (
    SELECT
        *,
        RANK() OVER (ORDER BY CROSS_SELL_IN_REVENUE DESC) AS CROSS_SELL_RANK,
        RANK() OVER (ORDER BY PRODUCT_CHURN DESC) AS PRODUCT_CHURN_RANK
    FROM FINAL2
)
SELECT
    *
FROM
    FINAL3
ORDER BY CROSS_SELL_RANK, PRODUCT_CHURN_RANK
        );
[0m19:38:12.267045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:38:14.174225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.907 seconds
[0m19:38:14.206150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9349a0c-1320-4ce2-b780-ad71f905a757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2095595B0>]}
[0m19:38:14.207178 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi3 .................................... [[32mSUCCESS 1[0m in 2.00s]
[0m19:38:14.208145 [debug] [Thread-1 (]: Finished running node model.DE_MINI_PROJECT.kpi3
[0m19:38:14.210147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:14.210147 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT' was left open.
[0m19:38:14.211146 [debug] [MainThread]: On list_DE_MINI_PROJECT: Close
[0m19:38:14.525706 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_intermediate' was left open.
[0m19:38:14.525706 [debug] [MainThread]: On list_DE_MINI_PROJECT_intermediate: Close
[0m19:38:14.851809 [debug] [MainThread]: Connection 'model.DE_MINI_PROJECT.kpi3' was left open.
[0m19:38:14.852809 [debug] [MainThread]: On model.DE_MINI_PROJECT.kpi3: Close
[0m19:38:15.172388 [info ] [MainThread]: 
[0m19:38:15.172388 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m19:38:15.172388 [debug] [MainThread]: Command end result
[0m19:38:15.209893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\manifest.json
[0m19:38:15.209893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\semantic_manifest.json
[0m19:38:15.223338 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\BurelaSuryaPrathap\MINI_PROJECT_2\DE_MINI_PROJECT\target\run_results.json
[0m19:38:15.223338 [info ] [MainThread]: 
[0m19:38:15.224306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:15.225223 [info ] [MainThread]: 
[0m19:38:15.226232 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:38:15.227269 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:15.227269 after 9.29 seconds
[0m19:38:15.228105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A207E2EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A207E2FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A207E2EE40>]}
[0m19:38:15.228105 [debug] [MainThread]: Flushing usage events
[0m19:38:16.606650 [debug] [MainThread]: An error was encountered while trying to flush usage events
